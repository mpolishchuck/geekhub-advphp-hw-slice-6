<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE j2xml PUBLIC "-//eshiol.it//DTD J2XML data file 12.5.0//EN" "http://www.eshiol.it/j2xml/12500/j2xml-12.5.0.dtd">
<j2xml version="12.5.0">
<category>
<id>8</id>
<path><![CDATA[notes]]></path>
<extension><![CDATA[com_content]]></extension>
<title><![CDATA[Записки]]></title>
<alias><![CDATA[notes]]></alias>
<note></note>
<description></description>
<published>1</published>
<access>1</access>
<params><![CDATA[{"category_layout":"","image":""}]]></params>
<metadesc></metadesc>
<metakey></metakey>
<metadata><![CDATA[{"author":"","robots":""}]]></metadata>
<created_time><![CDATA[2012-02-25 17:20:00]]></created_time>
<modified_time><![CDATA[0000-00-00 00:00:00]]></modified_time>
<hits>0</hits>
<language><![CDATA[*]]></language>
<created_user_id><![CDATA[root]]></created_user_id>
</category><category>
<id>9</id>
<path><![CDATA[notes/linux]]></path>
<extension><![CDATA[com_content]]></extension>
<title><![CDATA[Linux]]></title>
<alias><![CDATA[linux]]></alias>
<note></note>
<description></description>
<published>1</published>
<access>1</access>
<params><![CDATA[{"category_layout":"","image":""}]]></params>
<metadesc></metadesc>
<metakey></metakey>
<metadata><![CDATA[{"author":"","robots":""}]]></metadata>
<created_time><![CDATA[2012-02-25 17:20:23]]></created_time>
<modified_time><![CDATA[2012-02-25 17:20:43]]></modified_time>
<hits>0</hits>
<language><![CDATA[*]]></language>
<created_user_id><![CDATA[root]]></created_user_id>
<modified_user_id><![CDATA[root]]></modified_user_id>
</category><content>
<id>4</id>
<title><![CDATA[Коварный тачпад]]></title>
<alias><![CDATA[ugly-touchpad]]></alias>
<introtext><![CDATA[&lt;p style="text-align: justify;"&gt;Всем известно, что ноутбуки чуть чаще чем всегда оснащаются тачпадом. Очень полезная штука знаете-ли. И мышь уже не нужна. Правда при интенсивной работе мышь всё равно приходится подключать, поскольку как ни крути - а мышь удобнее. Работая интенсивно перестаешь обращать внимание на тачпад, забываешь что он есть. Тут набираешь текст, случайно коснулся его поверхности и замечаешь что целый блок кода написано уже где-то не там или нету вообще...&lt;/p&gt;
&lt;p&gt;&lt;img src="images/comics/ffrustration.jpg" border="0" alt="" style="display: block; margin-left: auto; margin-right: auto;" /&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&nbsp;Конечно проблема решима простым отключением тачпада, но иногда это наталкивается на определённые трудности. Хорошо когда есть кнопка отключения тачпада, нажал - включил, нажал - выключил. Удобно. Но вот в моём Dell Inspiron 1525 такой кнопки нету. Это значит, что отключение тачпада нужно проводить в системных настройках, устройство выключить например. Когда там ещё была винда, то стандартные драйвера шли в комплекте с утилитой, которая при подключении внешней мишы автоматически отключала тачпад. Вроде как удобнее даже чем с кнопкой - не надо думать о том нажал или не нажал - всё автоматом. Но это же не предел совершенства, ибо всегда бывают случаи, когда тачпад мне не нужен даже при отсутсвии мишы, например сидишь и програмишь - нужна только клава, а команды редактора все равно вызываются горячими клавишами. Ходить в настройки не есть удобно.&lt;/p&gt;
]]></introtext>
<fulltext><![CDATA[
&lt;p style="text-align: justify;"&gt;Когда же перешёл на Linux, то там вообще не обнаружилось подобной утилиты - тачпад всегда включён. И это очень не удобно. Настройка на отключение тачпада хоть и находится не очень далеко, но всё равно ходить туда каждый раз рано или поздно заколебает кого угодно. А когда обновился до GNOME 3, то обнаружил, что эта настройка куда-то делась... ещё лучше...&lt;/p&gt;
&lt;p&gt;&lt;img src="images/comics/wtf.jpg" border="0" alt="" style="display: block; margin-left: auto; margin-right: auto;" /&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&nbsp;Но как оказалось решить проблему очень просто - всего лишь навсего полистать ман по иксах, а точнее по драйвера тачпада synaptics. Там в комплект входит небольшая утилита synclient, которая исполуется для диагностики и настройки параметров тачпада... Вот она очень просто может отключить и включить тачпад. Соответственно применение:&lt;/p&gt;
&lt;pre&gt;$ synclient TouchpadOff=1
$ synclient TouchpadOff=0&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;&nbsp;Есстессвенно каждый раз вводить такую команду равносильно, что ходить в настройки или там калацать. Поэтому лучше забиндить даные команды на какие-то кнопки и всё будет окей.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Но мы лёгких путей не ищем. Было бы неплохо, если бы за это отвечала одна комбинация, а не две... да и вообще было бы клёво видеть на экране сообщение о том, что тачпад включён или выключен... Линуксоид сказал - линуксоид сделал. Для решения это задачи нам нужно:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;руки&lt;/li&gt;
&lt;li&gt;голова&lt;/li&gt;
&lt;li&gt;gcc&lt;/li&gt;
&lt;li&gt;редактор кода (gedit, Geany подойдут)&lt;/li&gt;
&lt;li&gt;libnotify&lt;/li&gt;
&lt;li&gt;pkg-config&lt;/li&gt;
&lt;/ul&gt;
&lt;p style="text-align: justify;"&gt;С руками и головой всё ясно, с компилятором gcc и редактором всё ясно. Посредством libnotify мы будем сообщать пользователю, что тачпад включён/выключен. А pkg-config поможет нам в линковек программы в кучу.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Начнём. Програма состоит из одного файла, ибо больше не нада. Назовём его как то типа main.c (разница не принципиальна). Первый делом включим заголовочные файлы необходимых нам библиотек:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;#include &amp;lt;stdio.h&amp;gt;&lt;br /&gt;#include &amp;lt;stdlib.h&amp;gt;&lt;br /&gt;#include &amp;lt;libnotify/notify.h&amp;gt;&lt;br /&gt;#include &amp;lt;signal.h&amp;gt;&lt;br /&gt;#include &amp;lt;syslog.h&amp;gt;&lt;br /&gt;#include &amp;lt;string.h&amp;gt;&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Ого... много... но это ещё нечего... Но тут сразу нужно оговорить как программа будет работать. Она будет работать как демон, т.е. постоянно висеть запущеной в процессах. Посылая её сигнал мы будем включать или выключать тачпад. Теперь опеределяем переменные, которые нам нужно использовать:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;NotifyNotification *notification; // это указатель на обьект с экранным сообщением&lt;br /&gt;GError *error = NULL; // указатель на обьект с ошибками GLib&lt;br /&gt;gint statusTouchpad = 0; // текущий статус тачпада (0 - включён, 1 - выключен)&lt;br /&gt;gchar memTouchpad[2048]; // адрес к файлу, где запишем последнее состояние тачпада&lt;br /&gt;gchar pidCtrl[2048]; // адрес к файлу, где запишем PID запущеного приложения (нужно для управления им)&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Для удобства основные действия определим как отдельные функции. Первая передает synclient'у команду на изменение состояния тачпада:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;void sync_touchpad() {&lt;br /&gt;&nbsp;&nbsp;&nbsp; gint exitStatus;&lt;br /&gt;&nbsp;&nbsp;&nbsp; gchar cmd[256]; // буффер, в котором мы сложим команду для выполнения&lt;br /&gt;&nbsp;&nbsp;&nbsp; sprintf(cmd, "synclient TouchpadOff=%d", statusTouchpad); // собственно складываем команду&lt;br /&gt;&nbsp;&nbsp;&nbsp; g_spawn_command_line_sync(cmd, NULL, NULL, &amp;amp;exitStatus, &amp;amp;error); // выполянем&lt;br /&gt;}&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Следующая расширяет функционал предыдущей: она ещё и выводит сообщение на екран плюс записыват состояние тачпада в файл:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;void toggle_touchpad(int a) {&lt;br /&gt;&nbsp;&nbsp;&nbsp; if(statusTouchpad) {&lt;br /&gt;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; statusTouchpad = 0; // меняем состояние флага тачпада&lt;br /&gt;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; notify_notification_update(notification, "Touchpad", "Touchpad have been enabled", "touchpad"); // задаём выводимое сообщние&lt;br /&gt;&nbsp;&nbsp;&nbsp; } else {&lt;br /&gt;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; statusTouchpad = 1;&lt;br /&gt;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; notify_notification_update(notification, "Touchpad", "Touchpad have been disabled", "touchpad");&lt;br /&gt;&nbsp;&nbsp;&nbsp; }&lt;br /&gt;&nbsp;&nbsp;&nbsp; sync_touchpad(); // собственно управление тачпадом&lt;br /&gt;&nbsp;&nbsp;&nbsp; notify_notification_show(notification, &amp;amp;error); // вывод сообщения&lt;br /&gt;&nbsp;&nbsp;&nbsp; gchar cnt[4]; // буффер для записи в файл&lt;br /&gt;&nbsp;&nbsp;&nbsp; sprintf(cnt, "%d", statusTouchpad); // заполняем буффер&lt;br /&gt;&nbsp;&nbsp;&nbsp; g_file_set_contents(memTouchpad, cnt, strlen(cnt), &amp;amp;error); // записываем файл&lt;br /&gt;}&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Для выхода из программы будем использовать дополнительный обработчик:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;void exit_prog(int a) {&lt;br /&gt;&nbsp;&nbsp;&nbsp; g_remove(pidCtrl); // удляем файл с PID демона&lt;br /&gt;&nbsp;&nbsp;&nbsp; exit(EXIT_SUCCESS); // сообщаем ОС, что мы нормально завершили программу&lt;br /&gt;}&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;&nbsp;Тепер пишем наш main. Тут немного по шагам. Первым делом инициализируем libnotify:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;notify_init("Touchpad");&lt;br /&gt;notification = notify_notification_new(" "," ",NULL);&lt;br /&gt;notify_notification_set_timeout(notification, 1000);&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Теперь произведём загрузкусостояния тачпада с прошлого сеанса:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;sprintf(memTouchpad, "%s/%s", g_get_home_dir(), ".touchpadOff"); // складывем имя файла состояния&lt;br /&gt;if(g_file_test(memTouchpad, G_FILE_TEST_EXISTS)) { // если файл существует&lt;br /&gt;&nbsp;&nbsp;&nbsp; gchar **cnt = g_malloc0(1024); // выделяем память для прочтения&lt;br /&gt;&nbsp;&nbsp;&nbsp; g_file_get_contents(memTouchpad, cnt, NULL, &amp;amp;error); // читаем&lt;br /&gt;&nbsp;&nbsp;&nbsp; gint newst; // сюда запишем состояние из файла&lt;br /&gt;&nbsp;&nbsp;&nbsp; sscanf(*cnt, "%d", &amp;amp;newst); // парсим прочитанное из файла&lt;br /&gt;&nbsp;&nbsp;&nbsp; g_free(cnt); // высвобождаем буффер чтения файла&lt;br /&gt;&nbsp;&nbsp;&nbsp; if(newst != statusTouchpad) { // если мы считали состояние, отличное от текущего&lt;br /&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; statusTouchpad = newst; // меняем текущее сообщение&lt;br /&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sync_touchpad(); // сообщаем это тачпаду (на экран сообщение не выводим)&lt;br /&gt;&nbsp;&nbsp;&nbsp; }&lt;br /&gt;}&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;&nbsp;Запишем PID программы в файл:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;GPid pid = getpid(); // получаем PID&lt;br /&gt;sprintf(pidCtrl, "%s/%s", g_get_home_dir(), ".touchpad.pid"); // складывем имя файла&lt;br /&gt;gchar cnt[32]; // буффер для записи в файл&lt;br /&gt;sprintf(cnt, "%d", pid); // заполняем буффер&lt;br /&gt;g_file_set_contents(pidCtrl, cnt, strlen(cnt), &amp;amp;error); // записываем файл&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;&nbsp;Тепер самая важная часть - управление программой. Как уже было упомянуто, для этого используется механизм сигналов:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;signal(SIGUSR1, toggle_touchpad); // по SIGUSER1 переключаем тачпад&lt;br /&gt;signal(SIGTERM, exit_prog); // по SIGTERM выходим из программы&lt;br /&gt;signal(SIGHUP, SIG_IGN); // SIGHUP игнорим&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Ну и поледнее, зависаем и ждём указаний:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;while(1)&lt;br /&gt;&nbsp;&nbsp;&nbsp; sleep(10);&lt;br /&gt;return (EXIT_SUCCESS);&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Вот и всё программа написана. Компилируется программа просто:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;$ gcc `pkg-config --cflags libnotify` `pkg-config --cflags glib-2.0` -o tpad_ctrld main.c&lt;br /&gt;$ strip tpad_ctrld&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;&nbsp;Данный исполняемый файл забрасываем в автозапуск, и на запуске программа восстановит состояние тачпада с прошлого сеанса. Для управления тачпадом используется скрипт:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;#!/bin/bash&lt;br /&gt;&lt;br /&gt;FILE=".touchpad.pid"&lt;br /&gt;PID="`dirname ~/$FILE`/$FILE"&lt;br /&gt;&lt;br /&gt;if [ ! -f "$PID" ]; then&lt;br /&gt;&nbsp;&nbsp;&nbsp; /usr/local/bin/tpad_ctrld &amp;amp;&lt;br /&gt;elif ! ps -p `cat $PID`; then&lt;br /&gt;&nbsp;&nbsp;&nbsp; /usr/local/bin/tpad_ctrld &amp;amp;&lt;br /&gt;fi&lt;br /&gt;&lt;br /&gt;while [ ! -f "$PID" ]; do&lt;br /&gt;&nbsp;&nbsp;&nbsp; sleep 1&lt;br /&gt;done&lt;br /&gt;&lt;br /&gt;kill -USR1 `cat $PID`&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Подрзувмеватеся, что программу мы разместили в /usr/local/bin/. Если программа не запущена, то скрипт запускает её... Потом посылает сигнал USR1.&lt;/p&gt;
&lt;p&gt;&lt;img src="images/pub/ugly-touchpad/notify.jpg" border="0" alt="" style="display: block; margin-left: auto; margin-right: auto;" /&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;strong&gt;Небольшое замечание:&lt;/strong&gt; если в системе стоит какая то бадяга типа gsynaptics, то нужно организовать запуск нашей программы после него, поскольку он запросто может отменить действия synclient'а.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;a href="images/pub/ugly-touchpad/main.c.xz" target="_blank"&gt;&lt;img src="images/filetypes/text-x-source.png" border="0" alt="" /&gt; Скачать исходник&lt;/a&gt;&lt;/p&gt;]]></fulltext>
<state>1</state>
<created><![CDATA[2012-02-25 18:59:16]]></created>
<created_by_alias></created_by_alias>
<modified><![CDATA[2012-02-26 01:09:49]]></modified>
<publish_up><![CDATA[2012-02-25 20:27:57]]></publish_up>
<publish_down><![CDATA[0000-00-00 00:00:00]]></publish_down>
<images><![CDATA[{"image_intro":"","float_intro":"","image_intro_alt":"","image_intro_caption":"","image_fulltext":"","float_fulltext":"","image_fulltext_alt":"","image_fulltext_caption":""}]]></images>
<urls><![CDATA[{"urla":null,"urlatext":"","targeta":"","urlb":null,"urlbtext":"","targetb":"","urlc":null,"urlctext":"","targetc":""}]]></urls>
<attribs><![CDATA[{"show_title":"","link_titles":"","show_intro":"","show_category":"","link_category":"","show_parent_category":"","link_parent_category":"","show_author":"","link_author":"","show_create_date":"","show_modify_date":"","show_publish_date":"","show_item_navigation":"","show_icons":"","show_print_icon":"","show_email_icon":"","show_vote":"","show_hits":"","show_noauth":"","urls_position":"","alternative_readmore":"","article_layout":"","show_publishing_options":"","show_article_options":"","show_urls_images_backend":"","show_urls_images_frontend":""}]]></attribs>
<version>16</version>
<ordering>8</ordering>
<metakey></metakey>
<metadesc></metadesc>
<access>1</access>
<hits>3461</hits>
<metadata><![CDATA[{"robots":"","author":"","rights":"","xreference":""}]]></metadata>
<language><![CDATA[*]]></language>
<xreference></xreference>
<catid><![CDATA[notes/linux]]></catid>
<created_by><![CDATA[root]]></created_by>
<modified_by><![CDATA[root]]></modified_by>
<featured>0</featured>
<rating_sum>0</rating_sum>
<rating_count>0</rating_count>
</content><content>
<id>5</id>
<title><![CDATA[Archlinux, ванильное ядро, AppArmor и RT. Ветка 3.0.]]></title>
<alias><![CDATA[arch-kvanilla-aa-rt-3]]></alias>
<introtext><![CDATA[&lt;p style="text-align: justify;"&gt;О том как нужно правильно собирать ядро ходит легенд очень немало. Но вот майнтейнеры Archlinux походу не особо суеверны и потому в репозиториях всегда самое новое ядро с очень скудным набором патчей. Оно возможно и правильно ибо любое улучшение может принести с собой и глюки. Но когда дело доходит до установки некоторых очень важных вещей, то могут возникнуть трудности, причём очень много.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Очень полезным на компе может оказаться &lt;strong&gt;AppArmor&lt;/strong&gt;. Для тех, хто в танке обьясняю: это такая система безопасности, которая раздаёт права на запускаемые программы. Если для программы создан профиль, то AppArmor запрещает всё, что не разрешено явно. Таким образом можно защитится, от скомпрометированих программ с дырами, чтобы злоумышленник их посредством не мог получить получить доступ к Вашим данным. Где это надо? Ну возможно на серверах. Но на рабочем компьютере тоже не помешает. Пример: многими юзаемый Skype. При запуске он почему-то читает всю домашнюю папку &lt;em&gt;.mozilla&lt;/em&gt;. Причём всю. Что он там ищет - неясно. Ясно что для его работы она не нужна. Будучи откровенными параноиками мы защитимся от такого ;) Прелестью AppArmor является явное превосходство на дисретной системой доступа. Даже запуская программу из под рута, мы не можем её обойти. Вот только сам AppArmor - это теперь типа часть ядра, которую нужно настраивать... И вот чтобы её настроить нужно наложить пару патчей на ядро.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Дополнение &lt;strong&gt;RT&lt;/strong&gt;, реализирующее режим реального времении не есть обязательным, но мне пригодилось, потому и пишу.&lt;/p&gt;
]]></introtext>
<fulltext><![CDATA[
&lt;p style="text-align: justify;"&gt;Конечно сначала RT не использовал, а AppArmor добавлял путём доработки PKGBUILD из ABS. Это было ядро Linux 3.1.5. Хорошо что сам PKGBUILD написан по человечески - так, что нужно просто записать альтернативную версию, и дописать какие надо патчи и можно собирать. Потратил два часа но собрал... Оно даже заработало, но как-то вечерком смторел кино и ВНЕЗАПНО - Kernel Panic. Перегрузил, забил на это... Но когда это повторилось...&lt;/p&gt;
&lt;p&gt;&lt;img style="display: block; margin-left: auto; margin-right: auto;" src="images/comics/ffrustration.jpg" alt="" border="0" /&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Но ядро в официальном репозитории уже обновилось, очевидно что не просто так... видимо баги были и ещё какая то бадяга. Теперь бы надо было бы опять собирать. Но к месту вспомнил о Gentoo, и о том как ядро ставится там. Просто ставятся исходники, а мы их уже настраиваем и компиляем. Для Archlinux никто не мешает сделать так же. При этом имеем такие преимущества:&lt;/p&gt;
&lt;ul&gt;
&lt;li style="text-align: justify;"&gt;Возможность скомпилировать ядро под себя, по свою машину&lt;/li&gt;
&lt;li style="text-align: justify;"&gt;Уменьшение времени компиляции за счёт первого пункта&lt;/li&gt;
&lt;/ul&gt;
&lt;p style="text-align: justify;"&gt;В принципе первый пункт очень даже можно реализовать и с PKGBUILD'ом, но это всё морока. А то, что на сборку ядра уйдёт не 2 часа, а 40 минут - это ощутимый аргумент. На практике проверил - проще скачать, пропатчить и скомпилять, чем готовить PKGBUILD, отлаживать его и т.п. Тем более если такое ядро нужно только мне, то как то смысла готовить его для публикации в AUR нету.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Чтобы более быть уверенным в стабильности ядра, решил откатится до ветки 3.0. Она тогда ещё была в версии 3.0.14. А сейчас уже 3.0.22. Как я понимаю они там просто баги фиксят, новых глюков не добавляют.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Итак, на момент написания этой статьи мы используем такие версии ПО: Linux 3.0.22, AppArmor 2.7.2, RT-37.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Ядро берём на официальном архиве: &lt;a href="http://kernel.org/pub/linux/kernel/v3.0/linux-3.0.22.tar.xz" rel="nofollow" target="_blank"&gt;kernel.org&lt;/a&gt;. Где-то 62 МБ скачать - это мелочь. AppArmor берем с &lt;a href="https://launchpad.net/apparmor/2.7/2.7.2/+download/apparmor-2.7.2.tar.gz" rel="nofollow" target="_blank"&gt;launchpad&lt;/a&gt;. RT патч лежит не недалеко от ядра - на &lt;a href="http://kernel.org/pub/linux/kernel/projects/rt/3.0/patch-3.0.22-rt37.patch.xz" rel="nofollow" target="_blank"&gt;kernel.org&lt;/a&gt;.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Скачав всё это можно приступать. Во первых распакуем исходники ядра. Невзирая на то, что компилировать что-то от имени рута опасно и бла-бла-бла, распакуем их в /usr/local/src:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;# cd /usr/local/src/&lt;br /&gt;# tar -xvf /home/maxwel/Download/linux-3.0.22.tar.xz&lt;br /&gt;# cd linux-3.0.22/&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Теперь пропатчим. Начнём с AppArmor. Нужные нам патчи лежат в скаченном архиве в подпапке apparmor-2.7.2/kernel-patches/3.0/. Архив мы просто распакуем куда-нибудь, это неважно. Нужно наложить три патча из указанной папки в пронумерованном порядке:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;# patch -p1 &amp;lt; /home/maxwel/Download/apparmor-2.7.2/kernel-patches/3.0/0001-AppArmor-compatibility-patch-for-v5-network-controll.patch&lt;br /&gt;# patch -p1 &amp;lt; /home/maxwel/Download/apparmor-2.7.2/kernel-patches/3.0/0002-AppArmor-compatibility-patch-for-v5-interface.patch&lt;br /&gt;# patch -p1 &amp;lt; /home/maxwel/Download/apparmor-2.7.2/kernel-patches/3.0/0003-AppArmor-Allow-dfa-backward-compatibility-with-broke.patch&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Один есть. Теперь RT. Там всего один патч, сжатый в xz. Не проблема, накладываем и его.&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;# xzcat /home/maxwel/Download/patch-3.0.22-rt37.patch.xz | patch -p1&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Теперь можно конфигурировать и собирать, но надо немного притормозить. После такого патчинга в прошлой версии у меня отказался собираться драйвер на Wi-Fi. По тексту ошибки я так понял, что проблема в том, что драйвер не GPL, а связующие символы в экспорте как GPL. А драйвер то не простой, а гибридный. Напополам он закрыти он и вправду не GPL. Вообще у Broadcom интересный подход к дровам. Кстати инфа про устройства поддержки сети (Wi-Fi второй):&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;$ lspci | grep -i net&lt;br /&gt;09:00.0 Ethernet controller: Marvell Technology Group Ltd. 88E8040 PCI-E Fast Ethernet Controller (rev 12)&lt;br /&gt;0b:00.0 Network controller: Broadcom Corporation BCM4312 802.11b/g LP-PHY (rev 01)&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Но видимо люди уже с этим развлекались, на каком-то форуме написали, что надо просто в наглую заменить EXPORT_SYMBOL_GPL на EXPORT_SYMBOL в коде ядра, точнее в тех его частях, на которые ругается... Так и сделал, по быстрому сварганил патч. Накладывал его так же как и все остальные. Но это так для себя ибо если у Вас Wi-Fi от Intel, то скорее всего этого делать не придется. Насчёт Atheros даже не знаю. Во вском случае надо это иметь ввиду.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Теперь можно запускать конфигурацию:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;# make menuconfig&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Конфигурируем как захотим под себя. Надо только обязательно сделать следующее:&lt;/p&gt;
&lt;ul&gt;
&lt;li style="text-align: justify;"&gt;Processor type and features -&amp;gt; Preemption Model выбрать Fully Preemptible kernel (RT), чтобы активировать RT&lt;/li&gt;
&lt;li style="text-align: justify;"&gt;Включить Security Options -&amp;gt; AppArmor support, собственно включаем AppArmor&lt;/li&gt;
&lt;li style="text-align: justify;"&gt;Security Options -&amp;gt; AppArmor support -&amp;gt; AppArmor boot parameter default value установить в 1, это даёт автоматический подьём AppArmor при загрузке&lt;/li&gt;
&lt;li style="text-align: justify;"&gt;Включить Security Options -&amp;gt; AppArmor support -&amp;gt; Enable AppArmor 2.4 compatibility, это чтобы все утилиты работали&lt;/li&gt;
&lt;li style="text-align: justify;"&gt;Security Options -&amp;gt; Default security module установить в AppArmor, выбираем AppArmor как модуль безопосности&lt;/li&gt;
&lt;/ul&gt;
&lt;p style="text-align: justify;"&gt;Всякие TOMOYO Linux и SELinux в секции Security Options желательно поотключать.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Собираем:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;# make&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Можно пойти погулять. Когда соберётся, ставим модули:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;# make modules_install&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Само ядро же лежит arch/x86/boot/bzImage. Копируем к ядрам, тоесть в папку /boot. Прописываем его в GRUB (ну или в LILO, каждому своё). Грузимся и юзаем))&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;На случай если пригодится:&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;a href="images/pub/arch-kvanilla-aa-rt-3/wl-compat.patch.xz" target="_blank"&gt;&lt;img src="images/filetypes/text-x-patch.png" alt="" border="0" /&gt; Патч для совместимости с broadcom wl&lt;/a&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;a href="images/pub/arch-kvanilla-aa-rt-3/config.xz" target="_blank"&gt;&lt;img src="images/filetypes/text-x-patch.png" alt="" border="0" /&gt; Конфиг ядра для моего Dell Inspiron 1525&lt;/a&gt;&lt;/p&gt;]]></fulltext>
<state>1</state>
<created><![CDATA[2012-02-26 01:30:19]]></created>
<created_by_alias></created_by_alias>
<modified><![CDATA[2013-03-08 16:17:51]]></modified>
<publish_up><![CDATA[2012-02-26 03:07:25]]></publish_up>
<publish_down><![CDATA[0000-00-00 00:00:00]]></publish_down>
<images><![CDATA[{"image_intro":"","float_intro":"","image_intro_alt":"","image_intro_caption":"","image_fulltext":"","float_fulltext":"","image_fulltext_alt":"","image_fulltext_caption":""}]]></images>
<urls><![CDATA[{"urla":null,"urlatext":"","targeta":"","urlb":null,"urlbtext":"","targetb":"","urlc":null,"urlctext":"","targetc":""}]]></urls>
<attribs><![CDATA[{"show_title":"","link_titles":"","show_intro":"","show_category":"","link_category":"","show_parent_category":"","link_parent_category":"","show_author":"","link_author":"","show_create_date":"","show_modify_date":"","show_publish_date":"","show_item_navigation":"","show_icons":"","show_print_icon":"","show_email_icon":"","show_vote":"","show_hits":"","show_noauth":"","urls_position":"","alternative_readmore":"","article_layout":"","show_publishing_options":"","show_article_options":"","show_urls_images_backend":"","show_urls_images_frontend":""}]]></attribs>
<version>14</version>
<ordering>9</ordering>
<metakey></metakey>
<metadesc></metadesc>
<access>1</access>
<hits>1946</hits>
<metadata><![CDATA[{"robots":"","author":"","rights":"","xreference":""}]]></metadata>
<language><![CDATA[*]]></language>
<xreference></xreference>
<catid><![CDATA[notes/linux]]></catid>
<created_by><![CDATA[root]]></created_by>
<modified_by><![CDATA[root]]></modified_by>
<featured>0</featured>
<rating_sum>0</rating_sum>
<rating_count>0</rating_count>
</content><content>
<id>24</id>
<title><![CDATA[MPD и PulseAudio]]></title>
<alias><![CDATA[mpd-pulse-audio-per-user]]></alias>
<introtext><![CDATA[&lt;p style="text-align: justify;"&gt;Как то давно поставил себе MPD. Для тех, кто не в теме: MPD - это такой демонный проигрыватель музыки. Запускаем его просто в фоне, а музыку переключаем посредством дополнительного клиента. Это кстати очень удобно ибо клиент может выглядеть самым разнообразным способом, вплоть до какого-нибудь Web-интерфейса, сваянного на PHP. И возможности для вывода самые разные: ALSA, OSS, PulseAudio, JACK, можно транслировать музыку в сеть как радио. Когда на ноуте ещё была чисто ALSA то проблем вроде не было. Но вот обновился я до GNOME3... ВНЕЗАПНО потребовался PulseAudio...&lt;/p&gt;
]]></introtext>
<fulltext><![CDATA[
&lt;p&gt;&lt;img style="display: block; margin-left: auto; margin-right: auto;" src="images/comics/wtf.jpg" alt="wtf" width="221" height="150" /&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Тут и появилась проблема. Выводить MPD через PulseAudio то умеет, но он пытается запустить его от своего имени. А поскольку мой уже захватил на себя звуковуху, то он вывести звук уже не может. Ну а если повезёт и всё-таки он её отвоюет, то я не могу звук выводить, иногда даже если на паузу поставлю. И это вызывает неилюзорный баттхёрт. Поэтому я заинтерисовался вопросом как запустить MPD от своего имени.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Всё оказалось довольно таки просто. И как это сделать не есть секретно, походу даже в документации высветлен данный момент, хотя не уверен, не читал её всю. Это узнал откуда-то из интернетов.&lt;/p&gt;
&lt;h2 style="text-align: justify;"&gt;Шаг 1. Конфиг.&lt;/h2&gt;
&lt;p&gt;Просто взял и скопировал имеющийся конфиг к себе в home:&lt;/p&gt;
&lt;pre&gt;$ cp /etc/mpd.conf ~/.mpdconf&lt;/pre&gt;
&lt;p&gt;Там пришлось кое-что поправить. В первую очередь - это пути:&lt;/p&gt;
&lt;pre&gt;music_directory&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;"/путь/к/музыке"&lt;br /&gt;playlist_directory&amp;nbsp;&amp;nbsp; &amp;nbsp;"/home/username/.mpd/playlists"&lt;br /&gt;db_file&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;"/home/username/.mpd/mpd.db"&lt;br /&gt;log_file&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;"/home/username/.mpd/mpd.log"&lt;br /&gt;pid_file&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;"/home/username/.mpd/mpd.pid"&lt;br /&gt;state_file&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;"/home/username/.mpd/mpdstate"&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Очевидно, что я переложил все служебные файлы к себе в папку. Далее всё-таки сказал ему, чтобы запускался от моего имени:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;user&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;"username"&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Так же на всякий случай подправлю путь к сокету (если Вы не используете, то и править ничего не надо):&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;bind_to_address&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;"/home/username/.mpd/mpdsock"&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;И самое главное - это звуковой вывод. Я удалил все секции audio_output кроме этой:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;audio_output {&lt;br /&gt;&amp;nbsp;&amp;nbsp; &amp;nbsp;type&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;"pulse"&lt;br /&gt;&amp;nbsp;&amp;nbsp; &amp;nbsp;name&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;"Pulse Audio"&lt;br /&gt;}&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Тоесть той, которая описыват PulseAudio. Всё сводится к тому, что он просто законнектится к моему PulseAudio и не будет никому мешать.&lt;/p&gt;
&lt;h2 style="text-align: justify;"&gt;Шаг 2. Папки.&lt;/h2&gt;
&lt;p&gt;Далее создадим папки и файлы для работы MPD. Мы их уже упоминали, когда писали конфиг.&lt;/p&gt;
&lt;pre&gt;$ mkdir ~/.mpd&lt;br /&gt;$ mkdir ~/.mpd/playlists&lt;br /&gt;$ touch ~/.mpd/mod.{db,log,pid}&lt;br /&gt;$ touch ~/.mpd/mpdstate&lt;/pre&gt;
&lt;p&gt;Папки и файлы созданы. Всё готово.&lt;/p&gt;
&lt;h2&gt;Шаг 3. Запуск.&lt;/h2&gt;
&lt;p&gt;Запускать демон очень просто:&lt;/p&gt;
&lt;pre&gt;$ mpd&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;и всё, он запущен. Коннетимся мы согласно тем настройкам, которые записаны в &lt;em&gt;.mpdconf&lt;/em&gt;. Я их не менял, поэтому всё так и осталось: &lt;em&gt;127.0.0.1:6600&lt;/em&gt; если идти через TCP/IP. Ну или можно соединятся с сокетом &lt;em&gt;/home/username/.mpd/mpdsock&lt;/em&gt;. Если что, лично я использую клиент &lt;strong&gt;gmpc&lt;/strong&gt;. Если приспичит потушить демон то:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;$mpd --kill&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Вот так. Приятного прослушивания, товарищи.&lt;/p&gt;
&lt;p&gt;&lt;img style="display: block; margin-left: auto; margin-right: auto;" src="images/comics/music_headphones_happy.jpg" alt="music headphones happy" width="176" height="154" /&gt;&lt;/p&gt;]]></fulltext>
<state>1</state>
<created><![CDATA[2012-04-02 22:02:28]]></created>
<created_by_alias></created_by_alias>
<modified><![CDATA[2012-04-09 07:07:01]]></modified>
<publish_up><![CDATA[2012-04-02 22:33:20]]></publish_up>
<publish_down><![CDATA[0000-00-00 00:00:00]]></publish_down>
<images><![CDATA[{"image_intro":"","float_intro":"","image_intro_alt":"","image_intro_caption":"","image_fulltext":"","float_fulltext":"","image_fulltext_alt":"","image_fulltext_caption":""}]]></images>
<urls><![CDATA[{"urla":null,"urlatext":"","targeta":"","urlb":null,"urlbtext":"","targetb":"","urlc":null,"urlctext":"","targetc":""}]]></urls>
<attribs><![CDATA[{"show_title":"","link_titles":"","show_intro":"","show_category":"","link_category":"","show_parent_category":"","link_parent_category":"","show_author":"","link_author":"","show_create_date":"","show_modify_date":"","show_publish_date":"","show_item_navigation":"","show_icons":"","show_print_icon":"","show_email_icon":"","show_vote":"","show_hits":"","show_noauth":"","urls_position":"","alternative_readmore":"","article_layout":"","show_publishing_options":"","show_article_options":"","show_urls_images_backend":"","show_urls_images_frontend":""}]]></attribs>
<version>7</version>
<ordering>7</ordering>
<metakey></metakey>
<metadesc></metadesc>
<access>1</access>
<hits>1850</hits>
<metadata><![CDATA[{"robots":"","author":"","rights":"","xreference":""}]]></metadata>
<language><![CDATA[*]]></language>
<xreference></xreference>
<catid><![CDATA[notes/linux]]></catid>
<created_by><![CDATA[root]]></created_by>
<modified_by><![CDATA[root]]></modified_by>
<featured>0</featured>
<rating_sum>0</rating_sum>
<rating_count>0</rating_count>
</content><content>
<id>30</id>
<title><![CDATA[Перенос рипа диска с музыкой в свою библиотеку]]></title>
<alias><![CDATA[audio-cd-rip-splitting]]></alias>
<introtext><![CDATA[&lt;p style="text-align: justify;"&gt;Всем изестный факт: оптические диски ввиду своей долговечности тоже изнашиваются. Поэтому умелые товарищи просто делают копию диска на свой жеский диск и слушают ввиде файлов. Так удобнее, поскольку можно строить различные плейлисты из треков разных дисков. Понятно, что если у нас много дисков и нужно из них сделать рип, то хотелось бы чтобы всё было как-то автоматизировано. Такой софт есть и много. Порой у нас возникает желание сделать наиболее точную копию диска с максимальным сохранением качества. Тогда программы вроде ExactAudioCopy настраиваются на риппинг диска целиком, сохраняя рядом CUE-файл - список треков на нём. Слушать конечно можно, если плеер поддерживает разбор CUE-sheet. Но если нужно перекинуть какой-то трек на плеер, то это явно неудобно. Но если рип уже сделан в один файл проще его просто разбить на части.&lt;/p&gt;
]]></introtext>
<fulltext><![CDATA[
&lt;p style="text-align: justify;"&gt;&lt;em&gt;В интернетах выкладываются пиратские копии лицензионных диков имеено в таком варианте - большой аудиофайл и CUE-sheet. Данная статья к этому никакого отношения не имеет. Она просто рассматривает вопрос как разбить такой рип на треки. Где вы возьмете сам рип - ваши проблемы. Главное помнить о том, что если Вам нравится творчество некоего исполнителя и Вы хотите, чтобы он продолжал творить, то поддержите его материально - купите лицензионную запись.&lt;br /&gt;&lt;/em&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Итак допустим у нас есть lossless-рип диска в формате FLAC+CUE. Впрочем аудиоформат может быть другим, но никто не мешает его закодировать во FLAC. Сразу стоит заметить, что цель - получение потрекового рипа во FLAC. Почему FLAC? А почему бы и нет? Размеры норм, качество - безпотерьное, формат бесплатен и свободен, на Linux поддержка 100%. Впрочем нас всё устраивает.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Собственно понадобятся такие пакеты (работаем на Archlinux):&lt;/p&gt;
&lt;ul&gt;
&lt;li style="text-align: justify;"&gt;cuetools&lt;/li&gt;
&lt;li style="text-align: justify;"&gt;shntool&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 style="text-align: justify;"&gt;Разбивка рипа FLAC+CUE на треки.&lt;/h2&gt;
&lt;p style="text-align: justify;"&gt;Итак имеем файл FLAC с полным содержанием диска и прилагающийся к нему CUE-sheet. Первое, на что нужно обратить внимание - это кодировка CUE. Если рип снимался при помощи ExactAudioCopy, то вероятность того, что кодировка CP1251 составляет 98%. Нам же нужно всё в UTF-8. Кстати для дисков, в которых названия треков происаны латинницей разница не принципиальна. Разница есть для случаев когда это не так - в частности русский исполнитель и русские песни. Самый простой способ узнать кодировку, имея графический интерфейс - запустить gedit открыть им файл и посмотреть что он определит.&lt;/p&gt;
&lt;p&gt;&lt;img style="display: block; margin-left: auto; margin-right: auto;" src="images/pub/audio-cd-rip-splitting/gedit-encoding.jpg" alt="gedit-encoding" width="603" height="126" /&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Далее мы просто конвертируем кодировку, для чего используем iconv.&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;$ iconv -f CP1251 -t UTF8 album.cue &amp;gt; album.utf8.cue&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Итого мы получили CUE-sheet в кодировке UTF-8. Далее разбиваем, сначала определим метки времени:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;$ cuebreakpoints album.utf8.cue&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Должны получить список меток времени, по которым будет идти разделение. Нам не принципиально какие именно метки мы получим, важен тот факт, что мы их получили. Используя shnsplit и полученные метки времени делаем разбивку на треки:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;$ cuebreakpoints album.utf8.cue | shnsplit -o flac album.flac&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Получим набор треков с названием split-trackXX.flac, где XX - номер трека. Остаётся навесить на треки теги, указанные в CUE-sheet. Делаем с помощью скрипта cuetag:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;$ cuetag.sh album.utf8.cue split-track*.flac&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Теперь теги добавлены в файлы. Конечно записанные теги могут не совсем соответствовать тем, которые приняты в вашей музыкальной библоитеке. На такой случай пригодятся руки и программа easytag.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Вот впринципе и всё по поводу разбивки FLAC+CUE на FLAC-треки.&lt;/p&gt;]]></fulltext>
<state>1</state>
<created><![CDATA[2012-05-07 12:49:56]]></created>
<created_by_alias></created_by_alias>
<modified><![CDATA[2013-03-31 21:45:01]]></modified>
<publish_up><![CDATA[2012-05-07 14:29:14]]></publish_up>
<publish_down><![CDATA[0000-00-00 00:00:00]]></publish_down>
<images><![CDATA[{"image_intro":"","float_intro":"","image_intro_alt":"","image_intro_caption":"","image_fulltext":"","float_fulltext":"","image_fulltext_alt":"","image_fulltext_caption":""}]]></images>
<urls><![CDATA[{"urla":null,"urlatext":"","targeta":"","urlb":null,"urlbtext":"","targetb":"","urlc":null,"urlctext":"","targetc":""}]]></urls>
<attribs><![CDATA[{"show_title":"","link_titles":"","show_intro":"","show_category":"","link_category":"","show_parent_category":"","link_parent_category":"","show_author":"","link_author":"","show_create_date":"","show_modify_date":"","show_publish_date":"","show_item_navigation":"","show_icons":"","show_print_icon":"","show_email_icon":"","show_vote":"","show_hits":"","show_noauth":"","urls_position":"","alternative_readmore":"","article_layout":"","show_publishing_options":"","show_article_options":"","show_urls_images_backend":"","show_urls_images_frontend":""}]]></attribs>
<version>8</version>
<ordering>6</ordering>
<metakey></metakey>
<metadesc></metadesc>
<access>1</access>
<hits>563</hits>
<metadata><![CDATA[{"robots":"","author":"","rights":"","xreference":""}]]></metadata>
<language><![CDATA[*]]></language>
<xreference></xreference>
<catid><![CDATA[notes/linux]]></catid>
<created_by><![CDATA[root]]></created_by>
<modified_by><![CDATA[root]]></modified_by>
<featured>0</featured>
<rating_sum>0</rating_sum>
<rating_count>0</rating_count>
</content><content>
<id>31</id>
<title><![CDATA[Глюк с Adobe Flash (цветопередача)]]></title>
<alias><![CDATA[adobe-flash-glitch]]></alias>
<introtext><![CDATA[&lt;p style="text-align: justify;"&gt;Если &lt;a href="http://lurkmore.to/Внезапно" rel="nofollow" target="_blank"&gt;в один прекрасный момент&lt;/a&gt; при проигрывании на YouTube видео вы замечаете, что с цветом что-то не так, а точнее слишком синее видео, то эта заметка для вас.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Для устранения глюка достаточно создать файл&amp;nbsp;/etc/adobe/mms.cfg такого содержания:&lt;/p&gt;&lt;pre style="text-align: justify;"&gt;EnableLinuxHWVideoDecode=1
OverrideGPUValidation=true&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Люди говорят, что помогло, мне помогло и вам тоже должно помочь.&lt;/p&gt;]]></introtext>
<fulltext></fulltext>
<state>1</state>
<created><![CDATA[2012-05-09 18:05:43]]></created>
<created_by_alias></created_by_alias>
<modified><![CDATA[2013-03-08 16:19:43]]></modified>
<publish_up><![CDATA[2012-05-09 18:05:43]]></publish_up>
<publish_down><![CDATA[0000-00-00 00:00:00]]></publish_down>
<images><![CDATA[{"image_intro":"","float_intro":"","image_intro_alt":"","image_intro_caption":"","image_fulltext":"","float_fulltext":"","image_fulltext_alt":"","image_fulltext_caption":""}]]></images>
<urls><![CDATA[{"urla":null,"urlatext":"","targeta":"","urlb":null,"urlbtext":"","targetb":"","urlc":null,"urlctext":"","targetc":""}]]></urls>
<attribs><![CDATA[{"show_title":"","link_titles":"","show_intro":"","show_category":"","link_category":"","show_parent_category":"","link_parent_category":"","show_author":"","link_author":"","show_create_date":"","show_modify_date":"","show_publish_date":"","show_item_navigation":"","show_icons":"","show_print_icon":"","show_email_icon":"","show_vote":"","show_hits":"","show_noauth":"","urls_position":"","alternative_readmore":"","article_layout":"","show_publishing_options":"","show_article_options":"","show_urls_images_backend":"","show_urls_images_frontend":""}]]></attribs>
<version>4</version>
<ordering>5</ordering>
<metakey></metakey>
<metadesc></metadesc>
<access>1</access>
<hits>235</hits>
<metadata><![CDATA[{"robots":"","author":"","rights":"","xreference":""}]]></metadata>
<language><![CDATA[*]]></language>
<xreference></xreference>
<catid><![CDATA[notes/linux]]></catid>
<created_by><![CDATA[root]]></created_by>
<modified_by><![CDATA[root]]></modified_by>
<featured>0</featured>
<rating_sum>0</rating_sum>
<rating_count>0</rating_count>
</content><content>
<id>36</id>
<title><![CDATA[Выполнение фоновых задач]]></title>
<alias><![CDATA[linux-bg-tasks]]></alias>
<introtext><![CDATA[&lt;p style="text-align: justify;"&gt;Бывает, что нужно выполнить какую-то длительную операцию без собственного участия. При этом с планировщиком часто играться не охота, хочется просто начать дело и пойти куда нибудь. В принципе с этим проблем нет, можно просто оставить комп и пойти себе. Но гораздо интереснее дело обстоит, когда у нас есть сервер, доступ к которому у нас по ssh. Тогда наша длительная задача занимает сразу два компа, а это порой нежелательно. Хочеться избежать чьего-то вмешательства в процесс плюс избежать неожиданностей при перезагрузке клиентской машины. Ведь при разрыве соединения по ssh сам процесс тоже может прекритить работу, обосновуя это тем, что завершился терминал с которого этот процесс запустили. Но способ есть, как этого избежать. Рассмотрим на примере: нужно скачать исходники ядра Linux с &lt;a href="http://kernel.org/" rel="nofollow" target="_blank"&gt;kernel.org&lt;/a&gt;, а инет медленный и качать будет долго.&lt;/p&gt;
]]></introtext>
<fulltext><![CDATA[
&lt;p style="text-align: justify;"&gt;Для решения задачи применяем старый добрый wget. Разница лишь в том, как запускать процесс. А запускать будем так:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;$ nohup wget "&lt;a href="http://www.kernel.org/pub/linux/kernel/v3.0/linux-3.0.32.tar.xz" rel="nofollow"&gt;http://www.kernel.org/pub/linux/kernel/v3.0/linux-3.0.32.tar.xz&lt;/a&gt;" &amp;gt; wget.log 2&amp;gt;&amp;amp;1 &amp;amp;&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Скачивание как обычно начинается в текущую папку. Новым здесь есть наличие nohup, которое позволяет не придираться к тому факту запущен ли терминал или нет. Вывод самого wget мы направили в wget.log, чтобы можно было оперативно мониторить прогресс, поскольку так он никуда выводиться не будет. Мониторить можно хотябы так:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;$ tail -f wget.log&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;В терминале мы увидим как wget проводит скачивание. Ошибки от wget мы направляем в тот же файл. Амперсанад в конце строки автоматом отбрасывает задачу в фон по началу выполнения. Естессвенно по завершения скачивания процесс завершится сам.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Кстати выгодно применять этот приём для скачивания в папку, которая видна через Web-сервер. Если лог писать рядом, то можно следить за прогрессом просто из браузера. Очень полезно при скачивании больших файлов. Если нужно ещё как-то разнообразить процесс скачивания, то можно добавить wget'у нужные аргументы, nohup в этом не ограничивает.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Точно так же можно запускать любой другой процесс и спокойно отключаться и идти что-то другое делать. Главное - позаботиться о наличии способа следить за выполением, если нужно ибо после отключения обычным способом это уже не сделать.&lt;/p&gt;]]></fulltext>
<state>1</state>
<created><![CDATA[2012-06-04 09:19:25]]></created>
<created_by_alias></created_by_alias>
<modified><![CDATA[2013-03-08 16:20:34]]></modified>
<publish_up><![CDATA[2012-06-04 09:19:25]]></publish_up>
<publish_down><![CDATA[0000-00-00 00:00:00]]></publish_down>
<images><![CDATA[{"image_intro":"","float_intro":"","image_intro_alt":"","image_intro_caption":"","image_fulltext":"","float_fulltext":"","image_fulltext_alt":"","image_fulltext_caption":""}]]></images>
<urls><![CDATA[{"urla":null,"urlatext":"","targeta":"","urlb":null,"urlbtext":"","targetb":"","urlc":null,"urlctext":"","targetc":""}]]></urls>
<attribs><![CDATA[{"show_title":"","link_titles":"","show_intro":"","show_category":"","link_category":"","show_parent_category":"","link_parent_category":"","show_author":"","link_author":"","show_create_date":"","show_modify_date":"","show_publish_date":"","show_item_navigation":"","show_icons":"","show_print_icon":"","show_email_icon":"","show_vote":"","show_hits":"","show_noauth":"","urls_position":"","alternative_readmore":"","article_layout":"","show_publishing_options":"","show_article_options":"","show_urls_images_backend":"","show_urls_images_frontend":""}]]></attribs>
<version>3</version>
<ordering>4</ordering>
<metakey></metakey>
<metadesc></metadesc>
<access>1</access>
<hits>266</hits>
<metadata><![CDATA[{"robots":"","author":"","rights":"","xreference":""}]]></metadata>
<language><![CDATA[*]]></language>
<xreference></xreference>
<catid><![CDATA[notes/linux]]></catid>
<created_by><![CDATA[root]]></created_by>
<modified_by><![CDATA[root]]></modified_by>
<featured>0</featured>
<rating_sum>0</rating_sum>
<rating_count>0</rating_count>
</content><content>
<id>38</id>
<title><![CDATA[Настройка кодировки в gedit]]></title>
<alias><![CDATA[gedit-encoding]]></alias>
<introtext><![CDATA[&lt;p style="text-align: justify;"&gt;Пользователям GNOME хорошо известен этот редактор - gedit. Наверное потому что дефолтный и ставится вместе с остальными программами GNOME.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Но в процессе использования могут возникать справеливые возмущения по поводу кодировок открываемых файлов. Если у Вас куча файлов, созданных в виндовом Блоктноте и содержат символы кириллицы то отрываться они будут как кракозябры. А это не есть хорошо. Поэтому рассморим как этому помочь.&lt;/p&gt;
]]></introtext>
<fulltext><![CDATA[
&lt;p style="text-align: justify;"&gt;Как такового интерфейса для настройки я не видел. Но есть такие штуки как gconf-editor и dconf-editor. Первая поможет для gedit версии 2, а вторая - gedit-3. Запустить соответсенную программу можно просто нажав Alt+F2 ввести нужну комманду. В gconf-editor переходим в ветку /apps/gedit-2/preferences/encodings/, а dconf-editor - org.gnome.gedit.preferences.encodings.&lt;/p&gt;
&lt;p&gt;&lt;img style="display: block; margin-left: auto; margin-right: auto;" src="images/pub/gedit-encoding/gconf.jpg" alt="gconf" width="600" height="428" /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img style="display: block; margin-left: auto; margin-right: auto;" src="images/pub/gedit-encoding/dconf.jpg" alt="dconf" width="600" height="516" /&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;В обоих случаях мы имеем два парамметра - auto-detected и show-in-menu (это для dconf, для gconf названия параметров написаны через символ подчеркивания, а не дефис). Первый парметр отвечает заавтоматическое определение кодировки, а воторой за списое кодировок, отображаемый в диалоге сохранения/открытия файла. Собственно нужно обратить внимание на первый так как это его нельзя нигде настроить.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Настройки представляют собой массивы текстовых строк. Какждая строка - название кодировки. Последовательность в массиве указывает на порядок определения или отображения кодировки. Нужно просто задать нужный для себя набор. Мои приведены на скриншотах. В этом контексте важные кодировки это: UTF-8 - самая православная и нужная кодировка в Linux и WINDOWS-1251 - самая распространённая киррилическая кодировка под Widnows.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Вобщем вроде всё. Удачи в настройке.&lt;/p&gt;]]></fulltext>
<state>1</state>
<created><![CDATA[2012-06-14 23:39:09]]></created>
<created_by_alias></created_by_alias>
<modified><![CDATA[2012-06-14 23:53:46]]></modified>
<publish_up><![CDATA[2012-06-14 23:53:46]]></publish_up>
<publish_down><![CDATA[0000-00-00 00:00:00]]></publish_down>
<images><![CDATA[{"image_intro":"","float_intro":"","image_intro_alt":"","image_intro_caption":"","image_fulltext":"","float_fulltext":"","image_fulltext_alt":"","image_fulltext_caption":""}]]></images>
<urls><![CDATA[{"urla":null,"urlatext":"","targeta":"","urlb":null,"urlbtext":"","targetb":"","urlc":null,"urlctext":"","targetc":""}]]></urls>
<attribs><![CDATA[{"show_title":"","link_titles":"","show_intro":"","show_category":"","link_category":"","show_parent_category":"","link_parent_category":"","show_author":"","link_author":"","show_create_date":"","show_modify_date":"","show_publish_date":"","show_item_navigation":"","show_icons":"","show_print_icon":"","show_email_icon":"","show_vote":"","show_hits":"","show_noauth":"","urls_position":"","alternative_readmore":"","article_layout":"","show_publishing_options":"","show_article_options":"","show_urls_images_backend":"","show_urls_images_frontend":""}]]></attribs>
<version>2</version>
<ordering>3</ordering>
<metakey></metakey>
<metadesc></metadesc>
<access>1</access>
<hits>512</hits>
<metadata><![CDATA[{"robots":"","author":"","rights":"","xreference":""}]]></metadata>
<language><![CDATA[*]]></language>
<xreference></xreference>
<catid><![CDATA[notes/linux]]></catid>
<created_by><![CDATA[root]]></created_by>
<modified_by><![CDATA[root]]></modified_by>
<featured>0</featured>
<rating_sum>0</rating_sum>
<rating_count>0</rating_count>
</content><content>
<id>40</id>
<title><![CDATA[Конвертирование музыки с APE во FLAC]]></title>
<alias><![CDATA[ape-to-flac]]></alias>
<introtext><![CDATA[&lt;p style="text-align: justify;"&gt;&lt;a href="index.php?option=com_content&amp;amp;view=article&amp;amp;id=30:audio-cd-rip-splitting&amp;amp;catid=9:linux&amp;amp;Itemid=103" target="_self"&gt;Совсем недавно&lt;/a&gt; был рассмотрен вопрос о том, как рип музыкального диска FLAC+CUE разбить на FLAC-треки. Но вот как быть если рип не FLAC+CUE, а скажем APE+CUE? Как раз эта заметка по идее должна восполнить этот пробел.&lt;/p&gt;
]]></introtext>
<fulltext><![CDATA[
&lt;p style="text-align: justify;"&gt;В распоряжении есть следующие инструменты:&lt;/p&gt;
&lt;ul&gt;
&lt;li style="text-align: justify;"&gt;Консольный Monkey's Audio Converter (mac), который поддерживает ape и wav;&lt;/li&gt;
&lt;li style="text-align: justify;"&gt;Консольный Free Lossless Audio Codec (flac), который поддерживает wav и flac.&lt;/li&gt;
&lt;/ul&gt;
&lt;p style="text-align: justify;"&gt;Вполне очевидной есть мысль сначала перегнать &lt;strong&gt;ape&lt;/strong&gt; в &lt;strong&gt;wav&lt;/strong&gt;, а потом &lt;strong&gt;wav&lt;/strong&gt; во &lt;strong&gt;flac&lt;/strong&gt;. Если делать это по очереди, то после нескольких таких конвертаций это может самую малость достать. Поэтому предлагаю делать так:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;$ mac album.ape - -d | flac --best - &amp;gt; album.flac&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Тоесть мы вроде бы делаем как бы две операции, но одновременно, не создавая промежуточный файл &lt;em&gt;image.wav&lt;/em&gt;. А это уже уменьшает требования к свободному месту на винте (хотя не особо, если удалять за собой использованный файлы, то экономии никакой тут нету). Но особо приятно то, что с нашей точки зрения это одна операция, которая только длится раза в два дольше (грубо говоря по времени как сума затраченного времени на две операции).&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Сконвертировав &lt;strong&gt;ape&lt;/strong&gt; во &lt;strong&gt;flac&lt;/strong&gt; можно с чистой совестью &lt;a href="index.php?option=com_content&amp;amp;view=article&amp;amp;id=30:audio-cd-rip-splitting&amp;amp;catid=9:linux&amp;amp;Itemid=103" target="_self"&gt;приступать к разбивке&lt;/a&gt;.&lt;/p&gt;]]></fulltext>
<state>1</state>
<created><![CDATA[2012-06-17 09:58:04]]></created>
<created_by_alias></created_by_alias>
<modified><![CDATA[2013-03-31 21:45:25]]></modified>
<publish_up><![CDATA[2012-06-17 09:58:43]]></publish_up>
<publish_down><![CDATA[0000-00-00 00:00:00]]></publish_down>
<images><![CDATA[{"image_intro":"","float_intro":"","image_intro_alt":"","image_intro_caption":"","image_fulltext":"","float_fulltext":"","image_fulltext_alt":"","image_fulltext_caption":""}]]></images>
<urls><![CDATA[{"urla":null,"urlatext":"","targeta":"","urlb":null,"urlbtext":"","targetb":"","urlc":null,"urlctext":"","targetc":""}]]></urls>
<attribs><![CDATA[{"show_title":"","link_titles":"","show_intro":"","show_category":"","link_category":"","show_parent_category":"","link_parent_category":"","show_author":"","link_author":"","show_create_date":"","show_modify_date":"","show_publish_date":"","show_item_navigation":"","show_icons":"","show_print_icon":"","show_email_icon":"","show_vote":"","show_hits":"","show_noauth":"","urls_position":"","alternative_readmore":"","article_layout":"","show_publishing_options":"","show_article_options":"","show_urls_images_backend":"","show_urls_images_frontend":""}]]></attribs>
<version>4</version>
<ordering>2</ordering>
<metakey></metakey>
<metadesc></metadesc>
<access>1</access>
<hits>1652</hits>
<metadata><![CDATA[{"robots":"","author":"","rights":"","xreference":""}]]></metadata>
<language><![CDATA[*]]></language>
<xreference></xreference>
<catid><![CDATA[notes/linux]]></catid>
<created_by><![CDATA[root]]></created_by>
<modified_by><![CDATA[root]]></modified_by>
<featured>0</featured>
<rating_sum>0</rating_sum>
<rating_count>0</rating_count>
</content><content>
<id>68</id>
<title><![CDATA[Правильная фоновая картинка для GRUB 0.97]]></title>
<alias><![CDATA[grub097-correct-background]]></alias>
<introtext><![CDATA[&lt;p style="text-align: justify;"&gt;Даже при наличии всяких новых GRUB2 (~1.97) некоторые пользователи остаются юзателями &lt;strong&gt;GRUB 0.97&lt;/strong&gt;. Особенно если загрузчик уже много лет нормально запускает систему, то зачем его на что-то менять? Вот и я придерживаюсь того же мнения. Но порой может стрельнуть что-то в голову и захочется заиметь фоновую картинку, то на 0.97 это тоже реализируемо.&lt;/p&gt;
]]></introtext>
<fulltext><![CDATA[
&lt;p style="text-align: justify;"&gt;Итак картинка стандартно должна быть &lt;em&gt;640x480&lt;/em&gt;, а глучина цвета должна быть &lt;em&gt;14 цветов&lt;/em&gt;, формат &lt;em&gt;xpm&lt;/em&gt;. Для того чтобы сделать всё по быстрому можно воспользоваться утилитой с пакета &lt;strong&gt;ImageMagick&lt;/strong&gt;&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;$ convert -resize 640x480 -colors 14 -verbose &lt;em&gt;исходная_картинка&lt;/em&gt;.jpg pic.xpm&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Полученную картинку &lt;strong&gt;pic.xpm.gz&lt;/strong&gt; можно сжать в &lt;strong&gt;gzip&lt;/strong&gt; (хотя необязательно)&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;$ gzip pic.xpm&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;И далее закидаем кудато в &lt;strong&gt;/boot&lt;/strong&gt; (например в &lt;strong&gt;/boot/grub&lt;/strong&gt;) чтобы на одном разделе с конфигом было. В конфигу GRUB прописываем&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;splashimage=(hd0,0)/grub/pic.xpm.gz&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;это когда у нас &lt;strong&gt;/boot&lt;/strong&gt; идёт отдеьным разделом и это есть самый первый раздел на винте. Если же это не отдельный раздел то&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;splashimage=(hd0,0)/boot/grub/pic.xpm.gz&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;когда &lt;strong&gt;/boot&lt;/strong&gt; на корневом разделе, а корневой раздел - первый на винте. Если что неясно читаем документацию в &lt;strong&gt;GRUB&lt;/strong&gt; как правильно указывать разделы в конфиге.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Теперь можно наслаждаться хоть и не очень качественной, но всё же картинкой в &lt;strong&gt;GRUB&lt;/strong&gt;.&lt;/p&gt;]]></fulltext>
<state>1</state>
<created><![CDATA[2013-03-12 13:10:12]]></created>
<created_by_alias></created_by_alias>
<modified><![CDATA[2013-03-12 13:20:15]]></modified>
<publish_up><![CDATA[2013-03-12 13:10:59]]></publish_up>
<publish_down><![CDATA[0000-00-00 00:00:00]]></publish_down>
<images><![CDATA[{"image_intro":"","float_intro":"","image_intro_alt":"","image_intro_caption":"","image_fulltext":"","float_fulltext":"","image_fulltext_alt":"","image_fulltext_caption":""}]]></images>
<urls><![CDATA[{"urla":null,"urlatext":"","targeta":"","urlb":null,"urlbtext":"","targetb":"","urlc":null,"urlctext":"","targetc":""}]]></urls>
<attribs><![CDATA[{"show_title":"","link_titles":"","show_intro":"","show_category":"","link_category":"","show_parent_category":"","link_parent_category":"","show_author":"","link_author":"","show_create_date":"","show_modify_date":"","show_publish_date":"","show_item_navigation":"","show_icons":"","show_print_icon":"","show_email_icon":"","show_vote":"","show_hits":"","show_noauth":"","urls_position":"","alternative_readmore":"","article_layout":"","show_publishing_options":"","show_article_options":"","show_urls_images_backend":"","show_urls_images_frontend":""}]]></attribs>
<version>3</version>
<ordering>1</ordering>
<metakey></metakey>
<metadesc></metadesc>
<access>1</access>
<hits>225</hits>
<metadata><![CDATA[{"robots":"","author":"","rights":"","xreference":""}]]></metadata>
<language><![CDATA[*]]></language>
<xreference></xreference>
<catid><![CDATA[notes/linux]]></catid>
<created_by><![CDATA[root]]></created_by>
<modified_by><![CDATA[root]]></modified_by>
<featured>0</featured>
<rating_sum>0</rating_sum>
<rating_count>0</rating_count>
</content><content>
<id>69</id>
<title><![CDATA[Сокрытие разделов в Nautilus без монтирования]]></title>
<alias><![CDATA[nautilus-hiding-partitions]]></alias>
<introtext><![CDATA[&lt;p style="text-align: justify;"&gt;Те, кто пользуется линуксом и в частности файловым менеджером &lt;strong&gt;Nautilus&lt;/strong&gt; уже оценили удобность интерфейса монтирования флешек при их подключении. Они всегда видны на боковой панели и их можно в любой нужный момент смонтировать и размонтировать. Но вот те, кто использует мультисистемную конфигурацию, т.е. несколько ОС на одном компе, наверное заметили, что туда также часто попадают несмонтированные разделы винта. С одной стороны удобно, но далеко не всегда они должны быть под рукой. Бывают потребности в сокрытии их.&lt;/p&gt;
]]></introtext>
<fulltext><![CDATA[
&lt;p style="text-align: justify;"&gt;Самый простой способ - смонтировать их руками через команду &lt;strong&gt;mount&lt;/strong&gt;. Тогда они оттуда исчезают. Но это далеко не всегда удобно и зачастую просто не нужно. Но есть способ похитрее. Он описан &lt;a href="http://www.worldofnubcraft.com/969/hide-your-disks-or-partitions-from-nautilus/" rel="nofollow" target="_blank"&gt;тут&lt;/a&gt;.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Суть способа такова. Обнаружением и монтированием дисков занимается такая хитрая штука как &lt;strong&gt;udisks&lt;/strong&gt;. &lt;strong&gt;Nautilus&lt;/strong&gt; же обменивается с ним информацией через &lt;strong&gt;dbus&lt;/strong&gt;. Грубо говоря что &lt;strong&gt;udisks&lt;/strong&gt; нашёл, то &lt;strong&gt;Nautilus&lt;/strong&gt; и показывает. Поэтому нужно заставить &lt;strong&gt;udisks&lt;/strong&gt; не выдавать некоторые разделы. Это делается элементарно просто через правила &lt;strong&gt;udev&lt;/strong&gt;. Создаём файлик типа &lt;em&gt;/etc/udev/rules.d/99-hide-partitions.rules&lt;/em&gt;:&lt;/p&gt;
&lt;pre style="text-align: left;"&gt;KERNEL=="sda1", ENV{UDISKS_PRESENTATION_HIDE}="1"
KERNEL=="sdb2", ENV{UDISKS_PRESENTATION_HIDE}="1"&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;В этом примере скрываются разделы &lt;em&gt;/dev/sda1&lt;/em&gt; и &lt;em&gt;/dev/sdb2&lt;/em&gt;. Впрочем отбирать можно и по другим критериям. Если воспользоваться утилитой &lt;strong&gt;udevadm&lt;/strong&gt;, то можно узнать много интересного, в том числе и список критериев для отбора конкретного девайса.&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;$ udevadm info -a -p /sys/class/block/sdb2
Udevadm info starts with the device specified by the devpath and then&lt;br /&gt;walks up the chain of parent devices. It prints for every device&lt;br /&gt;found, all possible attributes in the udev rules key format.&lt;br /&gt;A rule to match, can be composed by the attributes of the device&lt;br /&gt;and the attributes from one single parent device.
looking at device '/devices/pci0000:00/0000:00:1f.1/ata4/host3/target3:0:0/3:0:0:0/block/sdb/sdb2':&lt;br /&gt;KERNEL=="sdb2"&lt;br /&gt;SUBSYSTEM=="block"&lt;br /&gt;DRIVER==""&lt;br /&gt;ATTR{ro}=="0"&lt;br /&gt;ATTR{size}=="104855552"&lt;br /&gt;ATTR{stat}==" 164 0 1312 313 0 0 0 0 0 313 313"&lt;br /&gt;ATTR{partition}=="2"&lt;br /&gt;ATTR{start}=="718848"&lt;br /&gt;ATTR{discard_alignment}=="0"&lt;br /&gt;ATTR{alignment_offset}=="0"&lt;br /&gt;ATTR{inflight}==" 0 0"&lt;br /&gt;
looking at parent device '/devices/pci0000:00/0000:00:1f.1/ata4/host3/target3:0:0/3:0:0:0/block/sdb':&lt;br /&gt;KERNELS=="sdb"&lt;br /&gt;SUBSYSTEMS=="block"&lt;br /&gt;DRIVERS==""&lt;br /&gt;ATTRS{ro}=="0"&lt;br /&gt;ATTRS{size}=="234441648"&lt;br /&gt;ATTRS{stat}==" 595 0 4754 982 0 0 0 0 0 708 982"&lt;br /&gt;ATTRS{range}=="16"&lt;br /&gt;ATTRS{discard_alignment}=="0"&lt;br /&gt;ATTRS{events}==""&lt;br /&gt;ATTRS{ext_range}=="256"&lt;br /&gt;ATTRS{events_poll_msecs}=="-1"&lt;br /&gt;ATTRS{alignment_offset}=="0"&lt;br /&gt;ATTRS{inflight}==" 0 0"&lt;br /&gt;ATTRS{removable}=="0"&lt;br /&gt;ATTRS{capability}=="50"&lt;br /&gt;ATTRS{events_async}==""&lt;br /&gt;.........&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;И этот пример не полный. Впринципе любое уникальное отличие можно использовать, а можно и несколько штук. Но лично я для себя решил отбирать нужные разделы по &lt;strong&gt;UUID&lt;/strong&gt; файловой системы. Всё равно меняется только либо при форматировании либо при большом желании. Наш файлик с правилами приобретает такой вид:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;ENV{ID_FS_UUID}=="04F45320F4531371", ENV{UDISKS_PRESENTATION_HIDE}="1"&lt;br /&gt;ENV{ID_FS_UUID}=="C0C8739AC8738002", ENV{UDISKS_PRESENTATION_HIDE}="1"&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;&amp;nbsp;Проверить всё ли работает можно через дамп &lt;strong&gt;udisks&lt;/strong&gt;:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;$ udisks --dump&lt;br /&gt;.......&lt;br /&gt;========================================================================&lt;br /&gt;Showing information for /org/freedesktop/UDisks/devices/sdb2&lt;br /&gt;&amp;nbsp; native-path:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; /sys/devices/pci0000:00/0000:00:1f.1/ata4/host3/target3:0:0/3:0:0:0/block/sdb/sdb2&lt;br /&gt;&amp;nbsp; device:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 8:18&lt;br /&gt;&amp;nbsp; device-file:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; /dev/sdb2&lt;br /&gt;.....&lt;br /&gt;&amp;nbsp; detected at:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Mon 27 May 2013 12:58:03 PM EEST&lt;br /&gt;&amp;nbsp; system internal:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 1&lt;br /&gt;&amp;nbsp; removable:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 0&lt;br /&gt;&amp;nbsp; has media:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 1 (detected at Mon 27 May 2013 12:58:03 PM EEST)&lt;br /&gt;.......&lt;br /&gt;&amp;nbsp; is read only:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 0&lt;br /&gt;&amp;nbsp; is mounted:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 0&lt;br /&gt;&amp;nbsp; mount paths:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&lt;br /&gt;&amp;nbsp; mounted by uid:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 0&lt;br /&gt;&amp;nbsp; &lt;span style="text-decoration: underline;"&gt;presentation hide:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 1&lt;/span&gt;&lt;br /&gt;&amp;nbsp; presentation nopolicy:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 0&lt;br /&gt;.......&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Если против &lt;strong&gt;presentation hide&lt;/strong&gt; видим еденичку, то правило сработало правильно. Но если Nautilus всё равно показывает разделы, значит он работает не через &lt;strong&gt;udisks&lt;/strong&gt;. Дело в том, что с выходом &lt;strong&gt;udisks2&lt;/strong&gt; всё немного не так. Для него нужно писать правила такого плана:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;ENV{ID_FS_UUID}=="04F45320F4531371", ENV{UDISKS_IGNORE}="1"&lt;br /&gt;ENV{ID_FS_UUID}=="C0C8739AC8738002", ENV{UDISKS_IGNORE}="1"&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;А проверить срабатывание можно так:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;$ udisksctl dump&lt;br /&gt;/org/freedesktop/UDisks2/block_devices/sdb5:&lt;br /&gt;&amp;nbsp; org.freedesktop.UDisks2.Block:&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; Configuration:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; []&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; CryptoBackingDevice:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; '/'&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; Device:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; /dev/sdb5&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; DeviceNumber:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; 2069&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; HintAuto:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; false&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; HintIconName:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;span style="text-decoration: underline;"&gt;HintIgnore:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; true&lt;/span&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; HintName:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&lt;br style="text-align: justify;" /&gt;&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Тут смотрим на &lt;strong&gt;HintIgnore&lt;/strong&gt;, и убеждаемся что там значение &lt;strong&gt;true&lt;/strong&gt;.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Вот впринципе и всё, от этого уже можно что-то мутить.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;em&gt;PS&lt;/em&gt; В системе могут быть установлены и обе версии &lt;strong&gt;udisks&lt;/strong&gt;, но делом занимается только одна, поэтому если нужно пробовать обоими способами.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;em&gt;PPS&lt;/em&gt; Для применения правил нужно перезагружать машину, применить их без перезагрузки способа пока не нашёл.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;em&gt;PPPS&lt;/em&gt; Очевидно, что не только для &lt;strong&gt;Nautilus&lt;/strong&gt; это работает, а и для всего, что работает через &lt;strong&gt;udisks&lt;/strong&gt;.&lt;/p&gt;]]></fulltext>
<state>1</state>
<created><![CDATA[2013-05-27 10:53:27]]></created>
<created_by_alias></created_by_alias>
<modified><![CDATA[2013-05-27 11:33:13]]></modified>
<publish_up><![CDATA[2013-05-27 11:28:05]]></publish_up>
<publish_down><![CDATA[0000-00-00 00:00:00]]></publish_down>
<images><![CDATA[{"image_intro":"","float_intro":"","image_intro_alt":"","image_intro_caption":"","image_fulltext":"","float_fulltext":"","image_fulltext_alt":"","image_fulltext_caption":""}]]></images>
<urls><![CDATA[{"urla":null,"urlatext":"","targeta":"","urlb":null,"urlbtext":"","targetb":"","urlc":null,"urlctext":"","targetc":""}]]></urls>
<attribs><![CDATA[{"show_title":"","link_titles":"","show_intro":"","show_category":"","link_category":"","show_parent_category":"","link_parent_category":"","show_author":"","link_author":"","show_create_date":"","show_modify_date":"","show_publish_date":"","show_item_navigation":"","show_icons":"","show_print_icon":"","show_email_icon":"","show_vote":"","show_hits":"","show_noauth":"","urls_position":"","alternative_readmore":"","article_layout":"","show_publishing_options":"","show_article_options":"","show_urls_images_backend":"","show_urls_images_frontend":""}]]></attribs>
<version>8</version>
<ordering>0</ordering>
<metakey></metakey>
<metadesc></metadesc>
<access>1</access>
<hits>269</hits>
<metadata><![CDATA[{"robots":"","author":"","rights":"","xreference":""}]]></metadata>
<language><![CDATA[*]]></language>
<xreference></xreference>
<catid><![CDATA[notes/linux]]></catid>
<created_by><![CDATA[root]]></created_by>
<modified_by><![CDATA[root]]></modified_by>
<featured>0</featured>
<rating_sum>0</rating_sum>
<rating_count>0</rating_count>
</content><category>
<id>10</id>
<path><![CDATA[notes/programming]]></path>
<extension><![CDATA[com_content]]></extension>
<title><![CDATA[Програмизм]]></title>
<alias><![CDATA[programming]]></alias>
<note></note>
<description></description>
<published>1</published>
<access>1</access>
<params><![CDATA[{"category_layout":"","image":""}]]></params>
<metadesc></metadesc>
<metakey></metakey>
<metadata><![CDATA[{"author":"","robots":""}]]></metadata>
<created_time><![CDATA[2012-02-25 17:21:38]]></created_time>
<modified_time><![CDATA[0000-00-00 00:00:00]]></modified_time>
<hits>0</hits>
<language><![CDATA[*]]></language>
<created_user_id><![CDATA[root]]></created_user_id>
</category><content>
<id>15</id>
<title><![CDATA[Создание компонента для Joomla 2.5. Часть 1. Начало.]]></title>
<alias><![CDATA[com-joomla-25-1]]></alias>
<introtext><![CDATA[&lt;p style="text-align: justify;"&gt;Как уже наверное стало всем очевидно, это сайт работает под управлением CMS Joomla. Из коробки в неё входит практически всё: статьи публиковать можно, новости добавлять и вести блог тоже... но порой хочется чего иного,а не просто статей и блогов. Для этого в Joomla предусмотрена такая штука как расширения. Их существует очень большое количество. Надо только поискать, например в &lt;a href="http://extensions.joomla.org/" target="_blank"&gt;официальном репозитории&lt;/a&gt;. Но бывают случаи, когда нужного расширения нету там или просто нам заняться нечем и мы хочем что-то покодить.&lt;/p&gt;
]]></introtext>
<fulltext><![CDATA[
&lt;p style="text-align: justify;"&gt;Сразу надо оговорить, что в Joomla любое раширение должно быть зарегистрировано в базе данных. Чтобы не влезать во все тонкости организации БД, мы поступим проще - мы сделаем как во всех готовых расширениях, тоесть создадим инсталляционный пакет, а от него уже будем прыгать.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Итак для начала создадим папку с файлами инсталлятора. Самый главный файл здесь, который мы будем иметь - это XML с параметрами компонета, согласно которым Joomla Installer сможет его корректно установить. Имя этого файла должно совпадать с именем компонента, так например если наш компонет звать com_testing, то файл надо обозвать testing.xml. Итак сам файлик:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;&amp;lt;?xml version="1.0" encoding="utf-8"?&amp;gt;
&amp;lt;extension type="component" version="2.5.0" method="upgrade"&amp;gt;
 
    &amp;lt;name&amp;gt;com_testing&amp;lt;/name&amp;gt;
    &amp;lt;creationDate&amp;gt;March 2012&amp;lt;/creationDate&amp;gt;
    &amp;lt;author&amp;gt;Paul N. Maxwell&amp;lt;/author&amp;gt;
    &amp;lt;authorEmail&amp;gt;author@testing.org.ua&amp;lt;/authorEmail&amp;gt;
    &amp;lt;authorUrl&amp;gt;http://testing.org.ua/&amp;lt;/authorUrl&amp;gt;
    &amp;lt;copyright&amp;gt;Copyright Info&amp;lt;/copyright&amp;gt;
    &amp;lt;license&amp;gt;GPL&amp;lt;/license&amp;gt;
    &amp;lt;version&amp;gt;0.0.1&amp;lt;/version&amp;gt;
 
    &amp;lt;files folder="site"&amp;gt;
        &amp;lt;filename&amp;gt;index.html&amp;lt;/filename&amp;gt;
        &amp;lt;filename&amp;gt;testing.php&amp;lt;/filename&amp;gt;
    &amp;lt;/files&amp;gt;
    &amp;lt;administration&amp;gt;
    &amp;lt;/administration&amp;gt;
&amp;lt;/extension&amp;gt;&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Итак по порядку. Тег &lt;em&gt;extension&lt;/em&gt; описывает, что это расширение есть компонет для Joomla 2.5.0. Тег &lt;em&gt;name&lt;/em&gt; задаёт имя самого компнента. &lt;em&gt;creationDate&lt;/em&gt; - текстовая строка, которая намекает когда расширение было создано. &lt;em&gt;author&lt;/em&gt;, &lt;em&gt;authorEmail&lt;/em&gt; и &lt;em&gt;authorUrl&lt;/em&gt; - это контактные данные автора расширения соответсвенно его имя, адреса E-mail и адрес его домашней страницы. &lt;em&gt;copyright&lt;/em&gt; и &lt;em&gt;license&lt;/em&gt; - это данные о правообладателе и лицензия под которой расширение распространяется. &lt;em&gt;version&lt;/em&gt; - это версия инсталлируемого расширения, походу Joomla по этим ориентируется как обновлять расширение, так что рекомендую писать его по всем принятым правилам.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Секция &lt;em&gt;files&lt;/em&gt; с параметром &lt;em&gt;folder="site"&lt;/em&gt; содержит в себе все файлы, которые должны быть установлены для обеспечения клиентского функционала. Все файлы должны лежать рядом с этим файлом в папке &lt;em&gt;site&lt;/em&gt;. Каждый файл описывается в тэге &lt;em&gt;filename&lt;/em&gt;, каждая папка описывается в тэге &lt;em&gt;folder&lt;/em&gt;.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Последняя сеция &lt;em&gt;administration&lt;/em&gt; отвечает за установку админской части компонета. Пока что там пусто ибо нам админка для начала не требуется. Но сама секция должна быть, обязательно.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Итак рядом с файлом инсталлятора создаём две папки &lt;em&gt;admin&lt;/em&gt; и &lt;em&gt;site&lt;/em&gt;. В папку site кладём файл &lt;em&gt;index.html&lt;/em&gt; такого содержания:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;&amp;lt;html&amp;gt;&amp;lt;body bgcolor="#FFFFFF"&amp;gt;&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Это типа хак для того, чтобы в папку всякий онтерисующиеся не заходили и ничего не видели, если на хостинге включён Directory Listing в настройках сервера. И ещё один файлик кладём туда &lt;em&gt;testing.php&lt;/em&gt;. Запоминаем себе как правило - всё что написано в этом файле будет выведено в секции содеражания на странице. Сейчас можно просто написать что то типа "Hello world!". Как вы уже поняли этот файл тоже должен называться как и сам компонет. Тоесть он основной - через него всё и происходит.&lt;/p&gt;]]></fulltext>
<state>1</state>
<created><![CDATA[2012-03-17 09:11:49]]></created>
<created_by_alias></created_by_alias>
<modified><![CDATA[2012-03-17 10:48:34]]></modified>
<publish_up><![CDATA[2012-03-17 10:00:28]]></publish_up>
<publish_down><![CDATA[0000-00-00 00:00:00]]></publish_down>
<images><![CDATA[{"image_intro":"","float_intro":"","image_intro_alt":"","image_intro_caption":"","image_fulltext":"","float_fulltext":"","image_fulltext_alt":"","image_fulltext_caption":""}]]></images>
<urls><![CDATA[{"urla":null,"urlatext":"","targeta":"","urlb":null,"urlbtext":"","targetb":"","urlc":null,"urlctext":"","targetc":""}]]></urls>
<attribs><![CDATA[{"show_title":"","link_titles":"","show_intro":"","show_category":"","link_category":"","show_parent_category":"","link_parent_category":"","show_author":"","link_author":"","show_create_date":"","show_modify_date":"","show_publish_date":"","show_item_navigation":"","show_icons":"","show_print_icon":"","show_email_icon":"","show_vote":"","show_hits":"","show_noauth":"","urls_position":"","alternative_readmore":"","article_layout":"","show_publishing_options":"","show_article_options":"","show_urls_images_backend":"","show_urls_images_frontend":""}]]></attribs>
<version>18</version>
<ordering>2</ordering>
<metakey></metakey>
<metadesc></metadesc>
<access>1</access>
<hits>1492</hits>
<metadata><![CDATA[{"robots":"","author":"","rights":"","xreference":""}]]></metadata>
<language><![CDATA[*]]></language>
<xreference></xreference>
<catid><![CDATA[notes/programming]]></catid>
<created_by><![CDATA[root]]></created_by>
<modified_by><![CDATA[root]]></modified_by>
<featured>0</featured>
<rating_sum>0</rating_sum>
<rating_count>0</rating_count>
</content><content>
<id>16</id>
<title><![CDATA[Создание компонента для Joomla 2.5. Часть 2. MVC.]]></title>
<alias><![CDATA[com-joomla-25-2]]></alias>
<introtext><![CDATA[&lt;p style="text-align: justify;"&gt;Эта статья есть логическое продолжение &lt;a href="index.php?option=com_content&amp;amp;view=article&amp;amp;id=15:com-joomla-25-1&amp;amp;catid=10:programming&amp;amp;Itemid=104" target="_blank"&gt;этой&lt;/a&gt;. Итак у нас есть база. В нашем &lt;em&gt;testing.php&lt;/em&gt; мы можем писать всё-то угодно, но статической информацией довго рад не будешь. Конечно это PHP скрипт и можно написать тут обработку. Но батя не рекомендует всё усложнять ибо в Joomla уже всё сделано за нас. Нужно просто использовать.&lt;/p&gt;
]]></introtext>
<fulltext><![CDATA[
&lt;p style="text-align: justify;"&gt;CMS Joomla использует концепцию MVC для взаимодействия всех частей движка. Кто не знает что такое MVC - гуглим, на википедии написано. Центральным персонажем в MVC выступает контроллер, который уже обращается в виду и модели для того, чтобы совершить обработку и вывести контент на страницу к пользователю. Собственно в нашем &lt;em&gt;testing.php&lt;/em&gt; мы должны написать вывов самого контроллера. Это будет выглядеть так:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;&amp;lt;?php&lt;br /&gt;// No direct access to this file&lt;br /&gt;defined('_JEXEC') or die('Restricted access');&lt;br /&gt;&amp;nbsp;&lt;br /&gt;// import joomla controller library&lt;br /&gt;jimport('joomla.application.component.controller');&lt;br /&gt;&amp;nbsp;&lt;br /&gt;// Get an instance of the controller prefixed by HelloWorld&lt;br /&gt;$controller = JController::getInstance('Testing');&lt;br /&gt;&amp;nbsp;&lt;br /&gt;// Perform the Request task&lt;br /&gt;$controller-&amp;gt;execute(JRequest::getCmd('task'));&lt;br /&gt;&amp;nbsp;&lt;br /&gt;// Redirect if set by the controller&lt;br /&gt;$controller-&amp;gt;redirect();&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;В основном во многих компонетах так всё и устроено, то есть тут всё стандартно. Для нас важен только вызов &lt;em&gt;JController::getInstance&lt;/em&gt;, который создаёт обьект нашего контроллера. Помните, что контроллер должен существовать, иначе работать не будет.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Тепер рассмотри сам контроллер. Это класс-наследник от &lt;em&gt;JController&lt;/em&gt;. Он описывается в файле &lt;em&gt;controller.php&lt;/em&gt; рядом с &lt;em&gt;testing.php&lt;/em&gt;. Базово он выглядит так:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;&amp;lt;?php &lt;br /&gt;// No direct access to this file &lt;br /&gt;defined('_JEXEC') or die('Restricted access'); &lt;br /&gt;&amp;nbsp; &lt;br /&gt;// import Joomla controller library &lt;br /&gt;jimport('joomla.application.component.controller'); &lt;br /&gt;&amp;nbsp;&lt;br /&gt;class TestingController extends JController &lt;br /&gt;{ &lt;br /&gt;} &lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Тоесть сам класс назывется &lt;em&gt;TestingController&lt;/em&gt;. Мы же вызываем инстанцию от &lt;em&gt;'Testing'&lt;/em&gt;. Если суть ещё не уловили - читаем ещё раз и внимательно. Как ни странно с этим контроллером всё уже будет работать. Он уже может выбрать представление и отобразить его на экране.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;strong&gt;ВАЖНО!!!&lt;/strong&gt; Не забудьте добавить &lt;em&gt;controller.php&lt;/em&gt; в список устанавливаемых файлов в файл инсталляции &lt;em&gt;testing.xml&lt;/em&gt;.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Теперь к предаставлениям. Это тоже классы-наследники, только от &lt;em&gt;JView&lt;/em&gt;. Создаётся представление так. Для начала рядом с &lt;em&gt;testing.php&lt;/em&gt; создаём папку &lt;em&gt;views&lt;/em&gt; - туда все представления и складируются. Для нашего представления создаём свою папку &lt;em&gt;testing&lt;/em&gt; (в папке &lt;em&gt;views&lt;/em&gt;). В этой папке создаём файл &lt;em&gt;view.html.php&lt;/em&gt;, который и будет хранить наш класс. Содержание этого файла:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;&amp;lt;?php &lt;br /&gt;// No direct access to this file &lt;br /&gt;defined('_JEXEC') or die('Restricted access'); &lt;br /&gt;&amp;nbsp; &lt;br /&gt;// import Joomla view library &lt;br /&gt;jimport('joomla.application.component.view'); &lt;br /&gt;&amp;nbsp; &lt;br /&gt;class TestingViewTesting extends JView &lt;br /&gt;{ &lt;br /&gt;} &lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Как и контроллер, предаставление будучи ничем не модифицированым уже полноценно работает. Логика названия класса предаставления такая [имя инстанции контроллера] + 'View' + [имя самого представления (совпадёт с именем папки)]. Остаётся только шаблон сделать. Для этого рядом с &lt;em&gt;view.html.php&lt;/em&gt; создаём папку &lt;em&gt;tmpl&lt;/em&gt;. В папку кладём &lt;em&gt;default.php&lt;/em&gt; - содержание этого файла мы и увидим на странице. Это обычный PHP скрпит, который при этом ещё и может выводить информацию из представления. Предаставление в шаблоне доступно как &lt;em&gt;$this&lt;/em&gt;. В начале файла шаблона рекомендуется написать вот это:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;&amp;lt;?php &lt;br /&gt;// No direct access to this file &lt;br /&gt;defined('_JEXEC') or die('Restricted access'); &lt;br /&gt;?&amp;gt;&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;А дальше по тексту писать содеражание страницы. Подобный метод защищает от прямых обращений к этим файлам. Теперь надо его как-то вызывать. Тоесть надо иметь возможность привязать отображение контента к пункту меню. Это делается очень просто: в папке &lt;em&gt;tmpl&lt;/em&gt; рядом с &lt;em&gt;default.php&lt;/em&gt; создаём &lt;em&gt;default.xml&lt;/em&gt;. В нём пишем:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;&amp;lt;?xml version="1.0" encoding="utf-8"?&amp;gt;
&amp;lt;metadata&amp;gt;
    &amp;lt;layout title="Testing component"&amp;gt;
        &amp;lt;message&amp;gt;Default page&amp;lt;/message&amp;gt;
    &amp;lt;/layout&amp;gt;
&amp;lt;/metadata&amp;gt;&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Тепер в типах пунктов меню мы увидим ещё один "Default page" в группе "Testing component". Выбираем и ставим, наслаждаемся проделанной работой.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;strong&gt;ЗАМЕЧАНИЕ.&lt;/strong&gt; Во все созданные папки нужно положить такой же &lt;em&gt;index.html&lt;/em&gt; как и в папке &lt;em&gt;site&lt;/em&gt;.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&lt;strong&gt;ВАЖНО!!!&lt;/strong&gt; Необходимо добавить папку &lt;em&gt;views&lt;/em&gt; в список устанавливаемых файлов в файле &lt;em&gt;testing.xml&lt;/em&gt;.&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;&amp;lt;folder&amp;gt;views&amp;lt;/folder&amp;gt;&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Теперь можно паковать в ZIP и ставить.&lt;/p&gt;]]></fulltext>
<state>1</state>
<created><![CDATA[2012-03-17 10:05:18]]></created>
<created_by_alias></created_by_alias>
<modified><![CDATA[2012-03-17 10:47:28]]></modified>
<publish_up><![CDATA[2012-03-17 10:47:28]]></publish_up>
<publish_down><![CDATA[0000-00-00 00:00:00]]></publish_down>
<images><![CDATA[{"image_intro":"","float_intro":"","image_intro_alt":"","image_intro_caption":"","image_fulltext":"","float_fulltext":"","image_fulltext_alt":"","image_fulltext_caption":""}]]></images>
<urls><![CDATA[{"urla":null,"urlatext":"","targeta":"","urlb":null,"urlbtext":"","targetb":"","urlc":null,"urlctext":"","targetc":""}]]></urls>
<attribs><![CDATA[{"show_title":"","link_titles":"","show_intro":"","show_category":"","link_category":"","show_parent_category":"","link_parent_category":"","show_author":"","link_author":"","show_create_date":"","show_modify_date":"","show_publish_date":"","show_item_navigation":"","show_icons":"","show_print_icon":"","show_email_icon":"","show_vote":"","show_hits":"","show_noauth":"","urls_position":"","alternative_readmore":"","article_layout":"","show_publishing_options":"","show_article_options":"","show_urls_images_backend":"","show_urls_images_frontend":""}]]></attribs>
<version>6</version>
<ordering>1</ordering>
<metakey></metakey>
<metadesc></metadesc>
<access>1</access>
<hits>2008</hits>
<metadata><![CDATA[{"robots":"","author":"","rights":"","xreference":""}]]></metadata>
<language><![CDATA[*]]></language>
<xreference></xreference>
<catid><![CDATA[notes/programming]]></catid>
<created_by><![CDATA[root]]></created_by>
<modified_by><![CDATA[root]]></modified_by>
<featured>0</featured>
<rating_sum>0</rating_sum>
<rating_count>0</rating_count>
</content><content>
<id>17</id>
<title><![CDATA[Создание компонента для Joomla 2.5. Часть 3. Локализация.]]></title>
<alias><![CDATA[com-joomla-25-3]]></alias>
<introtext><![CDATA[&lt;p style="text-align: justify;"&gt;Немаловажным аспектом при реализации компонента есть его локализация. Очевидно, что напряму прописаные в коде строки не есть универсально и если сайт многоязычный, то это может вызвать пробемы. Но к счастью разработчики Joomla позаботились и об этом.&lt;/p&gt;
]]></introtext>
<fulltext><![CDATA[
&lt;p style="text-align: justify;"&gt;Сразу заметим, что все строки, что описываются в XML файлах уже поддаются переводу. Нужно просто вместо строкового значения придумать какой нибудь идентификатор. Этот идентификатор уже потом надо локализировать для одного или нескольких языков.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Все идентификаторы желательно начинать с названия компонента. Например для нашего случая подойдёт что-то вроде &lt;em&gt;COM_TESTING_STRING1&lt;/em&gt;. При надобности употребить идентификатор строки в коде шаблона (а это скорее всего придётся делать и не раз) нужно использовать вставку PHP кода.&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;&amp;lt;?php echo JText::_('COM_TESTING_STRING1'); ?&amp;gt;&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;И вообще так можно поступать в любом месте кода компонента.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Сами файлы с локализацией - это обычные безсекционные INI-файлы. Как имя параметра выступает идентификатор строки, а значение - это то, что будет возвращено подпрограммой локализации. Каждый файл называется по такому принципу: [код языка].com_[компонент].ini. Тоесть пример в нашем случае это &lt;em&gt;en-GB.com_testing.ini&lt;/em&gt;.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Хотя бы некоторые файлы локализации включить в инсталлятор просто необходимо. Для этого рядом с файлом &lt;em&gt;testing.xml&lt;/em&gt; (надеюсь что вы всё ещё помните что это за файл) содаём папку language, а в ней папки для каждого из языков: &lt;em&gt;en-GB&lt;/em&gt;, &lt;em&gt;ru-RU&lt;/em&gt;, &lt;em&gt;uk-UA&lt;/em&gt;. В каждую из этих папок кладём созданные нами файлы локализации: &lt;em&gt;en-GB.com_testing.ini&lt;/em&gt;, &lt;em&gt;ru-RU.com_testing.ini&lt;/em&gt;, &lt;em&gt;uk-UA.com_testing.ini&lt;/em&gt; соответсвенно.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Также прописываем эти файлы в &lt;em&gt;testing.xml&lt;/em&gt;. Для этого внутрь extenstion добавляем ещёи секцию &lt;em&gt;languages&lt;/em&gt;.&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;&amp;lt;languages&amp;gt;
    &amp;lt;language tag="en-GB" client="site"&amp;gt;language/en-GB/en-GB.com_testing.ini&amp;lt;/language&amp;gt;
    &amp;lt;language tag="ru-RU" client="site"&amp;gt;language/ru-RU/ru-RU.com_testing.ini&amp;lt;/language&amp;gt;
    &amp;lt;language tag="uk-UA" client="site"&amp;gt;language/uk-UA/uk-UA.com_testing.ini&amp;lt;/language&amp;gt;
&amp;lt;/languages&amp;gt;&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Всё, можно паковать и ставить.&lt;/p&gt;]]></fulltext>
<state>1</state>
<created><![CDATA[2012-03-17 16:53:03]]></created>
<created_by_alias></created_by_alias>
<modified><![CDATA[2012-03-17 20:09:24]]></modified>
<publish_up><![CDATA[2012-03-17 16:53:03]]></publish_up>
<publish_down><![CDATA[0000-00-00 00:00:00]]></publish_down>
<images><![CDATA[{"image_intro":"","float_intro":"","image_intro_alt":"","image_intro_caption":"","image_fulltext":"","float_fulltext":"","image_fulltext_alt":"","image_fulltext_caption":""}]]></images>
<urls><![CDATA[{"urla":null,"urlatext":"","targeta":"","urlb":null,"urlbtext":"","targetb":"","urlc":null,"urlctext":"","targetc":""}]]></urls>
<attribs><![CDATA[{"show_title":"","link_titles":"","show_intro":"","show_category":"","link_category":"","show_parent_category":"","link_parent_category":"","show_author":"","link_author":"","show_create_date":"","show_modify_date":"","show_publish_date":"","show_item_navigation":"","show_icons":"","show_print_icon":"","show_email_icon":"","show_vote":"","show_hits":"","show_noauth":"","urls_position":"","alternative_readmore":"","article_layout":"","show_publishing_options":"","show_article_options":"","show_urls_images_backend":"","show_urls_images_frontend":""}]]></attribs>
<version>9</version>
<ordering>0</ordering>
<metakey></metakey>
<metadesc></metadesc>
<access>1</access>
<hits>2733</hits>
<metadata><![CDATA[{"robots":"","author":"","rights":"","xreference":""}]]></metadata>
<language><![CDATA[*]]></language>
<xreference></xreference>
<catid><![CDATA[notes/programming]]></catid>
<created_by><![CDATA[root]]></created_by>
<modified_by><![CDATA[root]]></modified_by>
<featured>0</featured>
<rating_sum>0</rating_sum>
<rating_count>0</rating_count>
</content><category>
<id>11</id>
<path><![CDATA[notes/admin]]></path>
<extension><![CDATA[com_content]]></extension>
<title><![CDATA[Админство]]></title>
<alias><![CDATA[admin]]></alias>
<note></note>
<description></description>
<published>1</published>
<access>1</access>
<params><![CDATA[{"category_layout":"","image":""}]]></params>
<metadesc></metadesc>
<metakey></metakey>
<metadata><![CDATA[{"author":"","robots":""}]]></metadata>
<created_time><![CDATA[2012-02-25 17:22:30]]></created_time>
<modified_time><![CDATA[2012-02-25 17:22:40]]></modified_time>
<hits>0</hits>
<language><![CDATA[*]]></language>
<created_user_id><![CDATA[root]]></created_user_id>
<modified_user_id><![CDATA[root]]></modified_user_id>
</category><content>
<id>7</id>
<title><![CDATA[phpMyAdmin и капча]]></title>
<alias><![CDATA[pma-captcha]]></alias>
<introtext><![CDATA[&lt;p style="text-align: justify;"&gt;Каждму, кто делает сайты хоть раз приходилось иметь дело с базой данных MySQL. И неудивительно, MySQL - чуть ли не самая популярная СУБД среди всех ресурсов Интернета. Она имеет кучу преимуществ, кучу сервисов, кучу встроенных функций. Ну и очевидно, что разрабатывая очередной движок порой приходится вручную менять данные в базе данных, чтобы проверить как это всё работает. Конечно есть куча клиентов, которые могут это делать, но любому автономному клиенту надо иметь возможность подключатся к порту 3306. А это возможно не всегда, ибо если сервер БД находится на той же машине, где и Веб-сервер, то админ, будучи параноиком, мог и закрыть его... во избежание... Но в случае с сервером БД на другой машине ситуация не обязательно будет лучше, ведь можно поместить в списки доступа в порту 3306 только IP той машины, которая в Веб-сервером... ну или вообще если весь хостинг находится в более мелкой сети, а из Интернета доступен только через реверсивный прокси...&amp;nbsp; Поэтому не случайно большинство начинающих Веб-мастеров использует phpMyAdmin для своих развлечений. Скорее всего Вы уже о нём слышали и даже пользовались им. А оно и впарвду удобно - сам клиент фактически лежит там, где и сайт, что гарантирует чуть более чем полную доступность СУБД. Но ведь лежащий на сервере phpMyAdmin может обнаружить какой-то недобрый человек и использовать его для взлома БД... Элементарным брутом, тут ничего не сделать... Хотя если у Вас статический IP, то можно ограничить доступ только с Вашего... Но зачастую это не так... Можно запаролить папку средствами Веб-сервера, но тут суть дела не изменится - можно взломать один пароль, значить можно взломать и второй... Правда это будет сложнее... Но не стоит забывать про то, что админ всегда прав и может запретить вытворять подобные вещи. Так что ограничение по IP и пароль никак не есть универсальными вариантами. Но можно усложнить процес брута тем, что придётся ещё и угадывать буквы с картинки... Да, да - о капче все слыхали ;)&lt;/p&gt;
]]></introtext>
<fulltext><![CDATA[
&lt;p style="text-align: justify;"&gt;Мы все кроем матом всякие буквы которые не может прочитать, когда регистрируемся на форумах, в LastFM или ещё где-то... Ну вот любой посягнувшый на Вашу БД будет испытывать то же самое...&lt;/p&gt;
&lt;p&gt;&lt;img style="display: block; margin-left: auto; margin-right: auto;" src="images/comics/jecky-chan.jpg" alt="jecky-chan" width="236" height="150" /&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Что сказать про себя, то я думаю можно сделать авторизацию немного сложней во имя безопасности... Есстественно рассматриваем тип авторизации cookie, то есть тот, который предлагается из коробки...&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Значит так... сначала создаём в корне phpMyAdmin'а папку captcha - туда мы положим всё дополнительное, что нужно для реализации... Самое главное там (и наверное единственное) - это скрипт, котрый выдаёт картинку. У меня он вот такой:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;&amp;lt;?php&lt;br /&gt;// Задаём тип выводимого содержимого, отключаем кеширование браузером&lt;br /&gt;header('Content-Type: image/png');&lt;br /&gt;header('Cache-control: no-cache, no-store');&lt;br /&gt;&lt;br /&gt;// Подключаемся к сесси, созданной самим phpMyAdmin (ну или создаём её, если нету)&lt;br /&gt;session_name('phpMyAdmin');&lt;br /&gt;session_start();&lt;br /&gt;&lt;br /&gt;$im = imagecreatetruecolor(120, 30); // Создаём картинку 120x30&lt;br /&gt;$white = imagecolorallocate($im, 255, 255, 255); // Описываем белый цвет&lt;br /&gt;$black = imagecolorallocate($im, 0, 0, 0); // Описываем чёрный цвет&lt;br /&gt;$font = 'arialbd.ttf'; // Имя шрифта для отрисовки символов (он должен лежать рядом со скриптом)&lt;br /&gt;&lt;br /&gt;imagefilledrectangle($im, 0, 0, 119, 29, $white); // Делаем картинку белый фон&lt;br /&gt;$code = ''; // Сюда сгенерируем код&lt;br /&gt;$j = 10;&lt;br /&gt;$sym = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'; // Символы, из которых будет сложен код&lt;br /&gt;// Собственно процесс генерации кода&lt;br /&gt;for($i = 0; $i &amp;lt; 5; $i++) {&lt;br /&gt;$number = $sym[mt_rand(0, strlen($sym)-1)];&lt;br /&gt;$color = imagecolorallocate($im, mt_rand(0, 200), mt_rand(0, 200), mt_rand(0, 200));&lt;br /&gt;imagettftext($im, mt_rand(15, 25), mt_rand(-20, 20), $j, 25, $color, $font, $number);&lt;br /&gt;$j += mt_rand(15, 23);&lt;br /&gt;$code .= $number;&lt;br /&gt;}&lt;br /&gt;// Добавляем шум из чёрных точек&lt;br /&gt;while($i &amp;lt; 500) {&lt;br /&gt;imagesetpixel($im, mt_rand(0, 120), mt_rand(0, 30), $black);&lt;br /&gt;$i++;&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;$_SESSION['code_session'] = md5($code); // Записываем хеш кода в сессию&lt;br /&gt;imagepng($im); // Выводим что получилось&lt;br /&gt;imagedestroy($im); // Очищаем память&lt;br /&gt;exit(); // Выход&lt;br /&gt;?&amp;gt;&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Код прост как дверь, и то такое выражение может обидеть её ;) Понятно что скрипту надо поддержа GD в PHP, а также поддержка TrueType шрифтов. Мы рандомно генерируем код, пишем его в сессию к phpMyAdmin, чтобы с ним потом сравнить то, что ввёл пользователь. На сам phpMyAdmin нужно наложить &lt;a href="images/pub/pma-captcha/pma-captcha.patch.xz" target="_blank"&gt;патч&lt;/a&gt;. Сюда не выкладываю ибо впадло. Но в двух словах: он в блоке проверки логина и пароля делает ещё и проверку кода и если тот не такой как сгенерированый, авторизоция считается не валидной...&lt;/p&gt;
&lt;p&gt;&lt;img style="display: block; margin-left: auto; margin-right: auto;" src="images/pub/pma-captcha/login-form.jpg" alt="login-form" width="400" height="525" /&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Код генерируется при обновлении картинки. Средствами javascript в патче реализировано обновление картинки при клике на ней. Тепер подобрать пароль к БД стало намного сложнее. Для приведённого патча скрипт генерации картинки дожен называться &lt;em&gt;img.php&lt;/em&gt;.&lt;/p&gt;]]></fulltext>
<state>1</state>
<created><![CDATA[2012-02-27 06:20:34]]></created>
<created_by_alias></created_by_alias>
<modified><![CDATA[2012-02-28 08:55:59]]></modified>
<publish_up><![CDATA[2012-02-27 07:00:42]]></publish_up>
<publish_down><![CDATA[0000-00-00 00:00:00]]></publish_down>
<images><![CDATA[{"image_intro":"","float_intro":"","image_intro_alt":"","image_intro_caption":"","image_fulltext":"","float_fulltext":"","image_fulltext_alt":"","image_fulltext_caption":""}]]></images>
<urls><![CDATA[{"urla":null,"urlatext":"","targeta":"","urlb":null,"urlbtext":"","targetb":"","urlc":null,"urlctext":"","targetc":""}]]></urls>
<attribs><![CDATA[{"show_title":"","link_titles":"","show_intro":"","show_category":"","link_category":"","show_parent_category":"","link_parent_category":"","show_author":"","link_author":"","show_create_date":"","show_modify_date":"","show_publish_date":"","show_item_navigation":"","show_icons":"","show_print_icon":"","show_email_icon":"","show_vote":"","show_hits":"","show_noauth":"","urls_position":"","alternative_readmore":"","article_layout":"","show_publishing_options":"","show_article_options":"","show_urls_images_backend":"","show_urls_images_frontend":""}]]></attribs>
<version>9</version>
<ordering>17</ordering>
<metakey></metakey>
<metadesc></metadesc>
<access>1</access>
<hits>847</hits>
<metadata><![CDATA[{"robots":"","author":"","rights":"","xreference":""}]]></metadata>
<language><![CDATA[*]]></language>
<xreference></xreference>
<catid><![CDATA[notes/admin]]></catid>
<created_by><![CDATA[root]]></created_by>
<modified_by><![CDATA[root]]></modified_by>
<featured>0</featured>
<rating_sum>0</rating_sum>
<rating_count>0</rating_count>
</content><content>
<id>8</id>
<title><![CDATA[Простой FireWall для сервера]]></title>
<alias><![CDATA[server-firewall]]></alias>
<introtext><![CDATA[&lt;p style="text-align: justify;"&gt;Итак, сейчас мы поговорим о сетевой безопасности. Ни для кого не секрет, что устанавливая ОС на сервер мы тем самим включаем его в сеть. При этом не всегда (точнее очень редко) настраивется брандмауэр. А это не есть очень хорошо, ибо все сервисы, установленые на нём всегда и всем доступны. Казалось бы всё нормально, поставил пароль и все дела... Но брут никто не отменял... он всегда поможет и всех выручит... Чем давать возможность подбирать уж лучше перекрыть доступ на совсем. Для тех, кому сервисами пользоваться не надо это не есть проблема. Ну а взломщики пусть негодуют...&lt;/p&gt;
]]></introtext>
<fulltext><![CDATA[
&lt;p style="text-align: justify;"&gt;Всё, о чём идёт здесь речь делалось на Gentoo Linux, но применить эти знания можно на любом другом дистрибутиве. И так начнём. Для начала установим необходимые пакеты:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;# emerge -av net-firewall/iptables app-admin/sshguard&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Теперь пошагово настроим firewall при помощи iptables. Для начала создадим необходимые цепочки:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;# iptables -N TCP&lt;br /&gt;# iptables -N UDP&lt;br /&gt;# iptables -N SYN_FLOOD&lt;br /&gt;# iptables -N bruteguard&lt;br /&gt;# iptables -N sshguard&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Тепер поясним для чего эти цепочки нужны. Первая будет содержать правила открытия TCP портов. Вторая откроет UDP порты. Третья обеспецит защиту от SYN-флуда. Четвёртая обеспечит защиту от брутфорса. Пятая - специальная, для блокировки специфыичных адресов (будет рассмотрено).&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Сразу оговорим, что сервер просто выполняет функции какого-то Веб-сервера или FTP, но никому не раздаёт интернет, не служит маршрутизатором. Поэтому все операции по переброске пакетов запретим:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;# iptables -P FORWARD DROP&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Также мы предполагаем не ущемлять возможности сервера куда-то соединится и совершить какую нибудь операцию. Иными словами разрешаем весь исходящий траффик:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;# iptables -P OUTPUT ACCEPT&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;А вот входящий траффик настроим более тщательно. Первым делом разрешим входящий траффик, который касается уже установленных соединений, пропускаем весь траффик сервера от самого к себе, блокируем некорректные пакеты, пропускаем пинги:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;# iptables -A INPUT -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT&lt;br /&gt;# iptables -A INPUT -i lo -j ACCEPT&lt;br /&gt;# iptables -A INPUT -m conntrack --ctstate INVALID -j DROP&lt;br /&gt;# iptables -A INPUT -p icmp --icmp-type 8 -m conntrack --ctstate NEW -j ACCEPT&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Далее добавляем правило на пропуск траффика новых соединений к открытым портам UDP, фильтруем SYN флуд, пропускем траффик к TCP портам:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;# iptables -A INPUT -p udp -m conntrack --ctstate NEW -j UDP&lt;br /&gt;# iptables -A INPUT -p tcp --syn -j SYN_FLOOD&lt;br /&gt;# iptables -A INPUT -p tcp --syn -m conntrack --ctstate NEW -j TCP&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Наконец, настраиваем корректное отбрасывание пакетов, не прошедших в предыдущих правилах:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;# iptables -A INPUT -p udp -j REJECT --reject-with icmp-port-unreachable&lt;br /&gt;# iptables -A INPUT -p tcp -j REJECT --reject-with tcp-rst&lt;br /&gt;# iptables -A INPUT -j REJECT --reject-with icmp-proto-unreachable&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Ну и конечно же настроим партизанскую политику для цепочки INPUT:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;# iptables -P INPUT DROP&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Но это ещё не всё... нужно ещё обеспечить защиту от SYN флуда. Наполняем раннее созданную цепочку необходимым содержимим. Суть фильтрации SYN флуда в том, чтобы ограничить скорость поступления SYN пакетов к программам. Делаем так:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;# iptables -A SYN_FLOOD -m limit --limit 500/sec --limit-burst 1500 -j RETURN&lt;br /&gt;# iptables -A SYN_FLOOD -j DROP&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Ну и конечно же добавим защиту от брута. Тут принцип таков - в начале цепочки bruteguard поставим правила для пропуска траффика с IP белого списка, тоесть тех IP которых никогда не будем блокировать, чтобы не случилось. А в конце пишем ссылку на цепочку sshguard.&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;# iptables -A bruteguard -j sshguard&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Цепочка sshguard будет напоняться автоматически при помощи программы sshguard (мы её установили).&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Теперь пора поговорить о том как что-нибудь открыть. Предположим, что нужно дать все доступ к апачу:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;# iptables -A TCP -p tcp --dport 80 -j ACCEPT&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Тоесть мы пропускаем новый траффик, идущий протоколом TCP к порту 80. Другой пример - дадим доступ по ssh из некоторой подсети 192.168.1.0/24:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;# iptables -A TCP -s 192.168.1.0/24 -p tcp --dport 22 -j ACCEPT&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Думаю по аналогии тут всё понятно... Если что не ясно, всегда можно обратится к документации по iptables, гуглить мы умеем. Обязательное, о чём не стоит забывать - защита от брутофорса. Для защиты от брутфорса нобходимо до пропуска траффика добавить правило:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;# iptables -A TCP -p tcp --dport 22 -j bruteguard&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Очевидно, что даный антибрутфорс относится к ssh. Хотя никто не мешает прикрутить к какому нибудь другому порту. Логика такова: сначала траффик направляется к bruteguard и если там никто пакет не остановит (например запись в sshguard), то пакет будет пропущен потом следующим правилом. Остаётся настроить сам sshguard ибо смысла нет в нём. Начиная с версии он использует прозрачную технологию анализа логов Log-Sucker. Это значит, что надо просто создать такой лог, в который будет сбрасыватся инфа о неудачных авторизациях. У меня системный лог ведёт syslog-ng, посему будем настраивать именно его. Первое - создадим фильтр для отборки сообщений (это прописываем в /etc/syslog-ng/syslog-ng.conf):&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;filter f_sshguard { facility(auth, authpriv) and not program("sshguard") and (program("sshd") or program("proftpd")); };&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Данное правило отбирает сообщения авторизации от sshd и proftpd (такой у меня FTP сервер). Теперь назначим точку записи логов:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;destination sshguard { file("/var/log/sshguard.log" template("$DATE $FULLHOST $MSGHDR$MESSAGE\n")); };&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Ну и наконец свяжем правило и фильтр:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;log { source(src); filter(f_sshguard); destination(sshguard); };&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Готово. Перегружем конфигурацию syslog-ng:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;# /etc/init.d/syslog-ng reload&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Остаётся настроить сам Log-Sucker. В файле /etc/conf.d/sshguard пишем:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;SSHGUARD_OPTS="${SSHGUARD_OPTS} -l /var/log/sshguard.log"&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Если найдётё ещё опции -l в SSHGUARD_OPTS, то проследите, чтобы логи были на местах или уберите их совсем. Запускаем, добавляем в автозапуск:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;# /etc/init.d/sshguard start&lt;br /&gt;# rc-update add sshguard default&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Тепер всё должно работать. При этих настройках четыре раза неправильный пароль - бан на 10 минут. Ещё раз - на 20. И т.д. Если надо срочно всех разбанить - просто перезапускаем sshguard.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;В этой статье конечно не рассмотрены все тонкости настройки брандмауэра. Если интересует что-то ещё, свяжитесь, попробуем исправится...&lt;/p&gt;]]></fulltext>
<state>1</state>
<created><![CDATA[2012-02-28 08:51:18]]></created>
<created_by_alias></created_by_alias>
<modified><![CDATA[2012-02-29 14:46:01]]></modified>
<publish_up><![CDATA[2012-02-28 08:51:18]]></publish_up>
<publish_down><![CDATA[0000-00-00 00:00:00]]></publish_down>
<images><![CDATA[{"image_intro":"","float_intro":"","image_intro_alt":"","image_intro_caption":"","image_fulltext":"","float_fulltext":"","image_fulltext_alt":"","image_fulltext_caption":""}]]></images>
<urls><![CDATA[{"urla":null,"urlatext":"","targeta":"","urlb":null,"urlbtext":"","targetb":"","urlc":null,"urlctext":"","targetc":""}]]></urls>
<attribs><![CDATA[{"show_title":"","link_titles":"","show_intro":"","show_category":"","link_category":"","show_parent_category":"","link_parent_category":"","show_author":"","link_author":"","show_create_date":"","show_modify_date":"","show_publish_date":"","show_item_navigation":"","show_icons":"","show_print_icon":"","show_email_icon":"","show_vote":"","show_hits":"","show_noauth":"","urls_position":"","alternative_readmore":"","article_layout":"","show_publishing_options":"","show_article_options":"","show_urls_images_backend":"","show_urls_images_frontend":""}]]></attribs>
<version>15</version>
<ordering>16</ordering>
<metakey></metakey>
<metadesc></metadesc>
<access>1</access>
<hits>1673</hits>
<metadata><![CDATA[{"robots":"","author":"","rights":"","xreference":""}]]></metadata>
<language><![CDATA[*]]></language>
<xreference></xreference>
<catid><![CDATA[notes/admin]]></catid>
<created_by><![CDATA[root]]></created_by>
<modified_by><![CDATA[root]]></modified_by>
<featured>0</featured>
<rating_sum>0</rating_sum>
<rating_count>0</rating_count>
</content><content>
<id>9</id>
<title><![CDATA[Secondary MySQL server]]></title>
<alias><![CDATA[secondary-mysql]]></alias>
<introtext><![CDATA[&lt;p style="text-align: justify;"&gt;При установке сервера зачатую приходится ещё и ставить какую нибудь СУБД. Ну и кончно же большую популярность на рынке СУБД приобрела MySQL. Много есть учебников, пособий по тому как с ней работать. Когда сильно увлекаешся всем эим делом, то иногда забываешь, что силы MySQL ограничены.&lt;/p&gt;
]]></introtext>
<fulltext><![CDATA[
&lt;p style="text-align: justify;"&gt;Вот буквально на днях случилось. На сервере установлена система управления учебным процессом &lt;a href="http://claroline.net/" rel="nofollow" target="_blank"&gt;Claroline&lt;/a&gt; (ОС Gentoo Linux). Вроде и штука неплохая и преподавателям нравится, но с БД в неё явно проблемы. При установке предлагало, что можно сделать её мультибазовой, чтобы она сама могла создавать БД по мере надобности. Но так как для этого очевидно требуются немалые права, а на этом MySQL сервере ещё не один проект, то делать это как то стрёмно. Поэтому выбрал вариант с однобазовой конфигурацией, где бы все таблицы предварялись префиксами и ложились в одну БД. Ой, зря...&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Немного времени прошло, БД разрослась до 768 таблиц (!). Много, нечего сказать. И всё бы было до лампочки, если бы не было такого при попытке сделать бэкап:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;mysqldump: Got error: 23: Out of resources when opening file './claroline/c_С001_qwz_tracking.MYD' (Errcode: 24) when using LOCK TABLES&lt;/pre&gt;
&lt;p&gt;&lt;img style="display: block; margin-left: auto; margin-right: auto;" src="images/comics/ffrustration.jpg" alt="ffrustration" width="236" height="177" /&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Вот и задумался над тем как сделать так, чтобы и баз было несколько, и всё это было безопасно. Сначала думал собрать из исходников, положить в отдельную папку и там юзать. Но потом стал ман курить и что-то не вкурил. cmake отказался конфигурать исходники, поэтому был найден другой путь. Оказывается иметь ещё одну копию бинарников вовсек необязательно, можно просто дважды запустить одни и те же, только с разными конфигурациями.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Итак для начала я создал папку, куда бы собирал все файлы от другого сервера.&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;# mkdir -p /opt/claroline/{conf,db,var}&lt;br /&gt;# chown mysql:mysql /opt/claroline/{db,var}&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Далее копирую существующий конфиг MySQL в новую папку:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;# cp /etc/mysql/my.cnf /opt/claroline/conf/&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Далее правлю новый конфиг. Внёс вот такие изменения:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;[client]&lt;br /&gt;port = 3307&lt;br /&gt;socket = /opt/claroline/var/mysqld.sock&lt;br /&gt;&lt;br /&gt;[mysqld_safe]&lt;br /&gt;err-log = /opt/claroline/var/mysql.err&lt;br /&gt;&lt;br /&gt;[mysqld]&lt;br /&gt;port = 3307&lt;br /&gt;socket = /opt/claroline/var/mysqld.sock&lt;br /&gt;pid-file = /opt/claroline/var/mysqld.pid&lt;br /&gt;log-error = /opt/claroline/var/mysqld.err&lt;br /&gt;basedir = /usr&lt;br /&gt;datadir = /opt/claroline/db&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Больше ничего не трогал. Думаю очевидно что 3307 - это номер порта, по которому мы будем коннектится, а /opt/claroline/var/mysqld.sock - это соответственно UNIX-сокет. Теперь ставлю базовіе таблицы mysql:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;# mysql_install_db --defaults-file=/opt/claroline/conf/my.cnf&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Далее запуск и настройка. Запускаем командой:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;# start-stop-daemon --verbose --start --exec /usr/sbin/mysqld --background --pidfile /opt/claroline/var/mysqld.pid \&lt;br /&gt;&amp;nbsp;--wait 1000 --nicelevel 0 --ionice 2 -- --defaults-file=/opt/claroline/conf/my.cnf&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;У меня почему то он не захотел встать на порт 3307, как я ему сказал. Почему он так поступил неизвестно. Но пока можно обойтись и коннектится через сокет. Меняю пароль для рута:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;# mysqladmin --socket=/opt/claroline/var/mysqld.sock -u root password 'new-password'&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Сервер останавливаем командой:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;# start-stop-daemon --verbose --stop --exec /usr/sbin/mysqld --pidfile /opt/claroline/var/mysqld.pid --retry 120 \&lt;br /&gt;&amp;nbsp;-- --defaults-file=/opt/claroline/conf/my.cnf&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Но как выяснилось позже, это просто nmap не захотел показать, что порт 3307 кем то обслуживается... netstat же убедил меня что порт 3307 прослушивается и готов принимать соединения. Но вот только такая бадяга: обратится можно только как к 127.0.0.1:3307. К localhost:3307 почему то не прокатило.&lt;/p&gt;
&lt;p&gt;&lt;img style="display: block; margin-left: auto; margin-right: auto;" src="images/comics/jecky-chan.jpg" alt="jecky-chan" width="236" height="150" /&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Даные мутки необходимы на всех вещах, которые юзают этот сервер. Хотя лично от себя рекомендую коннектится через сокет. Я так настроил phpMyAdmin и теперь он предлагает два сервера на выбор. К обоим нормально коннектится и в обоих может всё настроить. Команды на запуск и остановку сервера закинул в /etc/local.d. Пока что...&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Логичеким продолжением истории является &lt;a href="index.php?option=com_content&amp;amp;view=article&amp;amp;id=11:clar-db-single-to-multi&amp;amp;catid=11:admin&amp;amp;Itemid=105" target="_self"&gt;публикация&lt;/a&gt; о перенесении БД Claroline с single-mode в multi-mode.&lt;/p&gt;]]></fulltext>
<state>1</state>
<created><![CDATA[2012-03-01 13:07:52]]></created>
<created_by_alias></created_by_alias>
<modified><![CDATA[2013-03-08 16:24:27]]></modified>
<publish_up><![CDATA[2012-03-02 21:49:26]]></publish_up>
<publish_down><![CDATA[0000-00-00 00:00:00]]></publish_down>
<images><![CDATA[{"image_intro":"","float_intro":"","image_intro_alt":"","image_intro_caption":"","image_fulltext":"","float_fulltext":"","image_fulltext_alt":"","image_fulltext_caption":""}]]></images>
<urls><![CDATA[{"urla":null,"urlatext":"","targeta":"","urlb":null,"urlbtext":"","targetb":"","urlc":null,"urlctext":"","targetc":""}]]></urls>
<attribs><![CDATA[{"show_title":"","link_titles":"","show_intro":"","show_category":"","link_category":"","show_parent_category":"","link_parent_category":"","show_author":"","link_author":"","show_create_date":"","show_modify_date":"","show_publish_date":"","show_item_navigation":"","show_icons":"","show_print_icon":"","show_email_icon":"","show_vote":"","show_hits":"","show_noauth":"","urls_position":"","alternative_readmore":"","article_layout":"","show_publishing_options":"","show_article_options":"","show_urls_images_backend":"","show_urls_images_frontend":""}]]></attribs>
<version>13</version>
<ordering>15</ordering>
<metakey></metakey>
<metadesc></metadesc>
<access>1</access>
<hits>905</hits>
<metadata><![CDATA[{"robots":"","author":"","rights":"","xreference":""}]]></metadata>
<language><![CDATA[*]]></language>
<xreference></xreference>
<catid><![CDATA[notes/admin]]></catid>
<created_by><![CDATA[root]]></created_by>
<modified_by><![CDATA[root]]></modified_by>
<featured>0</featured>
<rating_sum>0</rating_sum>
<rating_count>0</rating_count>
</content><content>
<id>11</id>
<title><![CDATA[Claroline: миграция БД]]></title>
<alias><![CDATA[clar-db-single-to-multi]]></alias>
<introtext><![CDATA[&lt;p style="text-align: justify;"&gt;Совсем недавно был рассмотрен вопрос о том, как установить ещё один MySQL сервер на сервере с Gentoo Linux. Как причина даных танцев с бубном послужила система усправления учебным процессом &lt;a href="http://claroline.net" rel="nofollow" target="_blank"&gt;Claroline&lt;/a&gt;. Ну и как логичное продолжение далее следует рассмотреть как саму базу переносить. Хотя все вопросы по поводу сопряжения Claroline с СУБД - это забота человека, который за неё ответсвенен. В моём случае этим человеком оказался я, поэтому пишу здесь и об этом.&lt;/p&gt;
]]></introtext>
<fulltext><![CDATA[
&lt;p style="text-align: justify;"&gt;Эта статья есть логичное продолжение &lt;a href="index.php?option=com_content&amp;amp;view=article&amp;amp;id=9:secondary-mysql&amp;amp;catid=11:admin&amp;amp;Itemid=105" target="_self"&gt;статьи&lt;/a&gt; о втором MySQL серере.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Итак, после длительных рассматриваний было выявлено несколько отличий, которые можно систематизировать так:&lt;/p&gt;
&lt;ul&gt;
	&lt;li style="text-align: justify;"&gt;В мультибазовом режиме Claroline созадёт для каждого курса отдельную БД, с именем, которое включает его шифр. В такой БД около 49 таблиц (вообще число точное, просто не ручаюсь что так будет всегда).&lt;/li&gt;
	&lt;li style="text-align: justify;"&gt;В каждой отдельной БД мультибазового режима имена таблиц совершенно одинаковые.&lt;/li&gt;
	&lt;li style="text-align: justify;"&gt;Для общих таблиц по прежнему используется основная БД.&lt;/li&gt;
	&lt;li style="text-align: justify;"&gt;В одндобазовом режиме все эти таблицы есстественно идут о основную БД, только предваряются префиксами, которые такие же как и имя БД в мыльтибазовом режиме.&lt;/li&gt;
&lt;/ul&gt;
&lt;p style="text-align: justify;"&gt;Вот и все отличия. Больше их просто нет. Так что работа несложная. Вот основные моменты:&lt;/p&gt;
&lt;ol style="text-align: justify;"&gt;
	&lt;li&gt;Создать пользователя БД для Claroline, который бы имел право создавать базы.&lt;/li&gt;
	&lt;li&gt;Скопировать БД однобазового режиму на этот сервер, далее это будет основная БД.&lt;/li&gt;
	&lt;li&gt;Проанализировать список сущестующих курсов.&lt;/li&gt;
	&lt;li&gt;Для каждого курса создать новую БД (называть соответственно).&lt;/li&gt;
	&lt;li&gt;В каждую новую БД переместить таблицы, которые предваряются соответсвенным префиксом. При этом префиксы необходимо стереть.&lt;/li&gt;
	&lt;li&gt;Исправить конфиг Claroline.&lt;/li&gt;
&lt;/ol&gt;
&lt;p style="text-align: justify;"&gt;Вот так. Теперь можно рассмотреть поподробнее. Первые два пункта смысла описывать нету, с этим думаю проблем не будет.&lt;/p&gt;
&lt;h2&gt;Перенесение данных&lt;/h2&gt;
&lt;p style="text-align: justify;"&gt;Собственно для переноса использовал вот такой простой PHP скрипт:&lt;/p&gt;&lt;pre style="text-align: justify;"&gt;&amp;lt;?php&lt;br /&gt;&lt;br /&gt;header("Content-type: text/plain; charset=utf-8");&lt;br /&gt;error_reporting(E_ALL);&lt;br /&gt;ini_set("display_errors", 1);&lt;br /&gt;ini_set("display_startup_errors", 1);&lt;br /&gt;&lt;br /&gt;// Это конфигурация&lt;br /&gt;$host = '127.0.0.1:3307'; // адрес сервера БД&lt;br /&gt;$user = 'claroline'; // пользователь БД для Claroline&lt;br /&gt;$pass = 'парольотбазы'; // пароль пользователя&lt;br /&gt;$db_master = 'claroline'; // основная БД&lt;br /&gt;&lt;br /&gt;mysql_connect($host, $user, $pass);&lt;br /&gt;mysql_select_db($db_master);&lt;br /&gt;&lt;br /&gt;$query1 = "SELECT `dbName` FROM `cl_cours`";&lt;br /&gt;$result1 = mysql_query($query1);&lt;br /&gt;&lt;br /&gt;while($row1 = mysql_fetch_object($result1)) {&lt;br /&gt;&amp;nbsp;&amp;nbsp; &amp;nbsp;echo "Processing: ";&lt;br /&gt;&amp;nbsp;&amp;nbsp; &amp;nbsp;echo $row1-&amp;gt;dbName."\n";&lt;br /&gt;&amp;nbsp;&amp;nbsp; &amp;nbsp;// Create database&lt;br /&gt;&amp;nbsp;&amp;nbsp; &amp;nbsp;$query2 = "CREATE DATABASE `{$row1-&amp;gt;dbName}` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci";&lt;br /&gt;&amp;nbsp;&amp;nbsp; &amp;nbsp;mysql_query($query2);&lt;br /&gt;&amp;nbsp;&amp;nbsp; &amp;nbsp;// Seearch tables&lt;br /&gt;&amp;nbsp;&amp;nbsp; &amp;nbsp;$query2 = "SHOW TABLES LIKE '".$row1-&amp;gt;dbName."_%'";&lt;br /&gt;&amp;nbsp;&amp;nbsp; &amp;nbsp;$result2 = mysql_query($query2);&lt;br /&gt;&amp;nbsp;&amp;nbsp; &amp;nbsp;while($row2 = mysql_fetch_row($result2)) {&lt;br /&gt;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;$slice = strlen($row1-&amp;gt;dbName."_");&lt;br /&gt;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;$table = substr($row2[0], $slice);&lt;br /&gt;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;$query3 = "RENAME TABLE `$db_master`.`{$row2[0]}` TO `{$row1-&amp;gt;dbName}`.`$table`";&lt;br /&gt;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;mysql_query($query3);&lt;br /&gt;&amp;nbsp;&amp;nbsp; &amp;nbsp;}&lt;br /&gt;}&lt;br /&gt;mysql_close();&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Скрипт, отработав, сделает все необходимые правки в БД.&lt;/p&gt;
&lt;h2&gt;Конфиг Claroline&lt;/h2&gt;
&lt;p style="text-align: justify;"&gt;Конфиг лежит в platform/conf/course_main.conf.php. Там правим адреса сервера БД:&lt;/p&gt;&lt;pre style="text-align: justify;"&gt;$GLOBALS['dbHost'] = '127.0.0.1:3307';&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Далее имя и пароль пользователя БД (тут только пароль, имя пользователся не изменилось):&lt;/p&gt;&lt;pre style="text-align: justify;"&gt;$GLOBALS['dbPass'] = '*******************';&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Отключаем однобазовый режим:&lt;/p&gt;&lt;pre style="text-align: justify;"&gt;$GLOBALS['singleDbEnabled'] = FALSE;&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;И напоследок указываем новый разделитель для получения имён таблиц:&lt;/p&gt;&lt;pre style="text-align: justify;"&gt;$GLOBALS['dbGlu'] = '`.`';&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Вот и всё. Готово. Теперь надо будет раз зайти в системные настройки Claroline, он поматерится, что типа не он конфиг писал, нажимаем "Save", и эта проблема исчезнет. Радуемся.&lt;/p&gt;]]></fulltext>
<state>1</state>
<created><![CDATA[2012-03-03 21:26:28]]></created>
<created_by_alias></created_by_alias>
<modified><![CDATA[2013-03-08 16:27:10]]></modified>
<publish_up><![CDATA[2012-03-03 21:26:28]]></publish_up>
<publish_down><![CDATA[0000-00-00 00:00:00]]></publish_down>
<images><![CDATA[{"image_intro":"","float_intro":"","image_intro_alt":"","image_intro_caption":"","image_fulltext":"","float_fulltext":"","image_fulltext_alt":"","image_fulltext_caption":""}]]></images>
<urls><![CDATA[{"urla":null,"urlatext":"","targeta":"","urlb":null,"urlbtext":"","targetb":"","urlc":null,"urlctext":"","targetc":""}]]></urls>
<attribs><![CDATA[{"show_title":"","link_titles":"","show_intro":"","show_category":"","link_category":"","show_parent_category":"","link_parent_category":"","show_author":"","link_author":"","show_create_date":"","show_modify_date":"","show_publish_date":"","show_item_navigation":"","show_icons":"","show_print_icon":"","show_email_icon":"","show_vote":"","show_hits":"","show_noauth":"","urls_position":"","alternative_readmore":"","article_layout":"","show_publishing_options":"","show_article_options":"","show_urls_images_backend":"","show_urls_images_frontend":""}]]></attribs>
<version>8</version>
<ordering>14</ordering>
<metakey></metakey>
<metadesc></metadesc>
<access>1</access>
<hits>1532</hits>
<metadata><![CDATA[{"robots":"","author":"","rights":"","xreference":""}]]></metadata>
<language><![CDATA[*]]></language>
<xreference></xreference>
<catid><![CDATA[notes/admin]]></catid>
<created_by><![CDATA[root]]></created_by>
<modified_by><![CDATA[root]]></modified_by>
<featured>0</featured>
<rating_sum>0</rating_sum>
<rating_count>0</rating_count>
</content><content>
<id>21</id>
<title><![CDATA[Отправка почты через внешний почтовый сервер]]></title>
<alias><![CDATA[postfix-relay]]></alias>
<introtext><![CDATA[&lt;p style="text-align: justify;"&gt;Итак. Как известно любой уважающий себя он-лайн сервис поддерживает такую штуку как отправка электронной почты пользователям. Назначение может быть разнообразно. Это и активация аккаунта, и восстановление пароля, и рассылка новостей. Чтобы почта отправлялась очевидно, что на сервере нужно заиметь почтовик, тоесть почтовый сервер. И организируя его нужно позаботиться, чтобы взаимодействие было двусторонним, тоесть чтобы почту можно было принимать, а не только отправлять. Это нужно для того, чтобы другие почтовые сервисы не относились к нашей почте как к спаму (хотя даже и это не всегда помогает). Есстественно, что у сервера должен быть внешний IP и соответсвенная MX-запись в описании доменной зоны. Но это возможно не всегда, особенно в больших конторах со скудными финансами. Зачастую контора имеет один внеший IP, а все остальные присоедены к Интернету через NAT и реверсивное проксирование. Вот если нам внезапно понадобилось отправлять почту с сервера в локальной сети и при этом у нас уже есть почтовик, настроенный для работы с Интернетом, то мы можем это использовать для себя. Тоесть используем имеющийся постовик как relay...&lt;/p&gt;
]]></introtext>
<fulltext><![CDATA[
&lt;p style="text-align: justify;"&gt;Здесь мы рассмотрим как это делается с postfix на сервере с Gentoo. Для других дистров это тоже легко применить, главное суть понять.&lt;/p&gt;
&lt;h2 style="text-align: justify;"&gt;Шаг 1.&lt;/h2&gt;
&lt;p style="text-align: justify;"&gt;Нужно заиметь учётку на работающем почтовике, чтобы мы могли юзать его как relay. Делается не сложно, просто обращаемся к админу того сервера с соответсвующей просьбой. Ну реализацию этого шага я думаю по деталям разъяснять&amp;nbsp; не стоит.&lt;/p&gt;
&lt;h2 style="text-align: justify;"&gt;Шаг 2.&lt;/h2&gt;
&lt;p style="text-align: justify;"&gt;Открываем &lt;em&gt;/etc/postfix/main.cf&lt;/em&gt; и ищем там настройку &lt;em&gt;relayhost&lt;/em&gt;. Она отвечает за пересылку почты через релай. Указываем адрес, по которому нам доступен почтовик в локалке.&lt;/p&gt;
&lt;pre&gt;relayhost = [mail.local]&lt;/pre&gt;
&lt;p&gt;Тут mail.local - это и есть этот адрес.&lt;/p&gt;
&lt;h2&gt;Шаг 3.&lt;/h2&gt;
&lt;p&gt;Авторизация на релай-сервере. Отрываем тот же &lt;em&gt;/etc/postfix/main.cf&lt;/em&gt; и дописываем такие строки:&lt;/p&gt;
&lt;pre&gt;defer_transport = smtp&lt;br /&gt;smtp_sasl_auth_enable = yes&lt;br /&gt;smtp_sasl_password_maps = hash:/etc/postfix/saslpass&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Это мы активировали функию авторизации через SASL. Учтите, если авторизация какая-то хитро-мудрая, то этот способ может не подойти, на этот счёт лучше поговорить с вашим админом.&lt;/p&gt;
&lt;p&gt;Далее в файо &lt;em&gt;/etc/postfix/saslpass&lt;/em&gt;, который мы указали раннее прописываем логин а пароль от сервера.&lt;/p&gt;
&lt;pre&gt;mail.local relayuser@mail.local:password&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;На всякий случай комментирую: первое - это адрес сервера, второе - логин, третье (после двоеточия) - это пароль. После этого создаём хешированную таблицу (которую postfix и будет читать).&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;# postmap /etc/postfix/saslpass&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Остаётся перегрузить настройки postfix.&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;# /etc/init.d/postfix reload&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Вот собственно и всё. Можно работать. Главное корректно задавать адрес отправителя в заголовках, ибо может не прокатить.&lt;/p&gt;]]></fulltext>
<state>1</state>
<created><![CDATA[2012-03-29 12:03:04]]></created>
<created_by_alias></created_by_alias>
<modified><![CDATA[2012-03-29 12:56:47]]></modified>
<publish_up><![CDATA[2012-03-29 12:56:47]]></publish_up>
<publish_down><![CDATA[0000-00-00 00:00:00]]></publish_down>
<images><![CDATA[{"image_intro":"","float_intro":"","image_intro_alt":"","image_intro_caption":"","image_fulltext":"","float_fulltext":"","image_fulltext_alt":"","image_fulltext_caption":""}]]></images>
<urls><![CDATA[{"urla":null,"urlatext":"","targeta":"","urlb":null,"urlbtext":"","targetb":"","urlc":null,"urlctext":"","targetc":""}]]></urls>
<attribs><![CDATA[{"show_title":"","link_titles":"","show_intro":"","show_category":"","link_category":"","show_parent_category":"","link_parent_category":"","show_author":"","link_author":"","show_create_date":"","show_modify_date":"","show_publish_date":"","show_item_navigation":"","show_icons":"","show_print_icon":"","show_email_icon":"","show_vote":"","show_hits":"","show_noauth":"","urls_position":"","alternative_readmore":"","article_layout":"","show_publishing_options":"","show_article_options":"","show_urls_images_backend":"","show_urls_images_frontend":""}]]></attribs>
<version>4</version>
<ordering>13</ordering>
<metakey></metakey>
<metadesc></metadesc>
<access>1</access>
<hits>773</hits>
<metadata><![CDATA[{"robots":"","author":"","rights":"","xreference":""}]]></metadata>
<language><![CDATA[*]]></language>
<xreference></xreference>
<catid><![CDATA[notes/admin]]></catid>
<created_by><![CDATA[root]]></created_by>
<modified_by><![CDATA[root]]></modified_by>
<featured>0</featured>
<rating_sum>0</rating_sum>
<rating_count>0</rating_count>
</content><content>
<id>39</id>
<title><![CDATA[Настройка PuTTY для аутентификации по публичному ключу (без пароля) на SSH сервере]]></title>
<alias><![CDATA[putty-pubkey-auth]]></alias>
<introtext><![CDATA[&lt;p style="text-align: justify;"&gt;Работая со многими серверами с одного компа порой начинаешь замечать, что вводить пароль каждый раз как-то напряжно. Хочется, чтобы щёлкнул и вошёл. И это есть возможно, благодаря механизму публичных и приватных ключей SSH. Но перед тем как читать дальше запомните &lt;strong&gt;важную вещь&lt;/strong&gt;: &lt;span style="text-decoration: underline;"&gt;безпарольная авторизация образует брешь в безопасности всей системы, поэтому рекомендуется over 9000 раз подумать перед тем как настраивать это&lt;/span&gt;. Рекомендуется такую авторизацию применять только на компе личного пользования, для уверенности что посторонние не получат ваш приватный ключ.&lt;/p&gt;
]]></introtext>
<fulltext><![CDATA[
&lt;p style="text-align: justify;"&gt;Работает это так: у Вас на компе есть приватный ключ, который очень важный в плане безорасности и его нельзя передавать третьим лицам; на сервере есть соответственный вашему приватному публичный ключ, который используется для подтверждения аутентичности. Публичный ключ не так критичен, его можно в открытую передавать и ничего страшного не случится, разве что злоумышленник разрешит Вам войти на свой сервер без пароля.&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;img src="images/comics/orly.jpg" alt="orly" width="273" height="200" /&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Ну вот так приблизительно. Для начала нужно сгенерировать себе приватный ключ. Для этого в пакете PuTTY есть программа PuTTYgen. Запускаем её, по желанию выбираем длину и тип ключа. Нажимаем "Generate".&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;img src="images/pub/putty-pubkey-auth/puttygen1.jpg" alt="puttygen1" width="483" height="464" /&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Далее просто водим мышкой по свободному пространству под полоской пока она не заполнится. От движений мыши оно берёт энтропию для генерации ключа.&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;img src="images/pub/putty-pubkey-auth/puttygen2.jpg" alt="puttygen2" width="483" height="464" /&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Когда генерация завершится мы увидим публичный ключ. По желанию можно изменить коментарий к ключу в поле "Key comment". Берём и копируем содержимое поля "Public key for pasting into OpenSSH authorized keys file" в пустой текстовый файл. Перевод строки в конец не добавляем, это не нужно. Файл пока сохраняем, например с именем &lt;strong&gt;my_key.pub&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img style="display: block; margin-left: auto; margin-right: auto;" src="images/pub/putty-pubkey-auth/puttygen3.jpg" alt="puttygen3" width="483" height="464" /&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Далее нажимаем кнопку "Save private key" и выбираем место для сохранения файла с приватным ключом (расширение *.ppk). Напоминаю, что третьим лицам этот файл передавать нельзя иначе нету смысла в защите.&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;img src="images/pub/putty-pubkey-auth/puttygen4.jpg" alt="puttygen4" width="483" height="464" /&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Тепер заливаем файл с публичным ключом на сервер (а сервер у нас ясное дело на Linux). Добавляем наш публичный ключ к перечню авторизированных (обычно это файл &lt;em&gt;.ssh/authorized_keys&lt;/em&gt; в домашнем каталоге пользователя, за которого мы хотим войти).&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;$ cat my_key.pub &amp;gt;&amp;gt; ~/.ssh/authorized_keys&lt;br /&gt;$ echo &amp;gt;&amp;gt; ~/.ssh/authorized_keys&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Сервер готов. Тепер у себя в настройках PuTTY в &lt;em&gt;Connection -&amp;gt; SSH -&amp;gt; Auth -&amp;gt; Private key file for authentication&lt;/em&gt; указываем путь к файлу *.ppk, в котором находится сгенерированный нами ключ.&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;img src="images/pub/putty-pubkey-auth/putty.jpg" alt="putty" width="456" height="435" /&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Вот собственно и всё. Максимум, что спросят при входе - это имя пользователя, но его тоже можно указать в настройках и не вводить. Тепер процесс входа значительно облегчился.&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;img src="images/comics/fuck-yeah.jpg" alt="fuck-yeah" width="189" height="181" /&gt;&lt;/p&gt;]]></fulltext>
<state>1</state>
<created><![CDATA[2012-06-15 18:41:58]]></created>
<created_by_alias></created_by_alias>
<modified><![CDATA[2012-06-15 19:16:16]]></modified>
<publish_up><![CDATA[2012-06-15 19:16:16]]></publish_up>
<publish_down><![CDATA[0000-00-00 00:00:00]]></publish_down>
<images><![CDATA[{"image_intro":"","float_intro":"","image_intro_alt":"","image_intro_caption":"","image_fulltext":"","float_fulltext":"","image_fulltext_alt":"","image_fulltext_caption":""}]]></images>
<urls><![CDATA[{"urla":null,"urlatext":"","targeta":"","urlb":null,"urlbtext":"","targetb":"","urlc":null,"urlctext":"","targetc":""}]]></urls>
<attribs><![CDATA[{"show_title":"","link_titles":"","show_intro":"","show_category":"","link_category":"","show_parent_category":"","link_parent_category":"","show_author":"","link_author":"","show_create_date":"","show_modify_date":"","show_publish_date":"","show_item_navigation":"","show_icons":"","show_print_icon":"","show_email_icon":"","show_vote":"","show_hits":"","show_noauth":"","urls_position":"","alternative_readmore":"","article_layout":"","show_publishing_options":"","show_article_options":"","show_urls_images_backend":"","show_urls_images_frontend":""}]]></attribs>
<version>5</version>
<ordering>12</ordering>
<metakey></metakey>
<metadesc></metadesc>
<access>1</access>
<hits>591</hits>
<metadata><![CDATA[{"robots":"","author":"","rights":"","xreference":""}]]></metadata>
<language><![CDATA[*]]></language>
<xreference></xreference>
<catid><![CDATA[notes/admin]]></catid>
<created_by><![CDATA[root]]></created_by>
<modified_by><![CDATA[root]]></modified_by>
<featured>0</featured>
<rating_sum>0</rating_sum>
<rating_count>0</rating_count>
</content><content>
<id>41</id>
<title><![CDATA[Корректная настройка локали в PuTTY при входе на SSH сервер на Gentoo Linux]]></title>
<alias><![CDATA[putty-gentoo-locale]]></alias>
<introtext><![CDATA[&lt;p style="text-align: justify;"&gt;PuTTY вроде как неплохой клиент для соединений по SSH. Но вот не всегда получается с первого раза настроить локаль, чтобы корректно всё отображалось. Эта заментка должна осветить пару важных моментов из этого вопроса. Итак у нас есть сервер с Gentoo Linux, на нём локаль en_US.UTF-8. Кстати язык не принципиален, главное чтобы UTF-8, так как именно эта кодировка сейчас очень распространилась в Linux системах. Итак попробуем достичь гармонии PuTTY с сервером, дабы небыло кракозяблей и процей ерунды...&lt;/p&gt;
]]></introtext>
<fulltext><![CDATA[
&lt;p style="text-align: justify;"&gt;Поскольку у нас локаль UTF-8, то и PuTTY нужно выбрать именно её. Для этого заходим в &lt;em&gt;Window -&amp;gt; Translation&lt;/em&gt; и так в &lt;em&gt;Remote character set&lt;/em&gt; выбираем &lt;em&gt;UTF-8&lt;/em&gt;.&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;img alt="putty2" src="images/pub/putty-gentoo-locale/putty2.jpg" height="435" width="456" /&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Так же укажем Font has &lt;em&gt;XWindows&lt;/em&gt; encoding, это для отрисовки псевдографики в таких приложениях как &lt;em&gt;Midnight Commander&lt;/em&gt; например. Но это ещё не всё. Нужно бы ещё указать тип терминала и маппинг функциональных кнопок. Для этого в &lt;em&gt;Terminal -&amp;gt; Keyboard -&amp;gt; The Function keys&lt;/em&gt; and keypad указываем &lt;em&gt;XTerm R6&lt;/em&gt;.&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;img alt="putty1" src="images/pub/putty-gentoo-locale/putty1.jpg" height="435" width="456" /&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Также убедимся, что в &lt;em&gt;Connection -&amp;gt; Data -&amp;gt; Terminal-type&lt;/em&gt; string установлен &lt;em&gt;xterm&lt;/em&gt;.&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;img alt="putty3" src="images/pub/putty-gentoo-locale/putty3.jpg" height="435" width="456" /&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Вот так должно работать с коррекным маппингом кнопок и так будет даже на мышь реагировать, если приложение допускает это. Но запустив &lt;strong&gt;mc&lt;/strong&gt; можно случайно обнаружить, что вместо псевдографических линий у нас наборы букв.&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;img alt="mc before" src="images/pub/putty-gentoo-locale/mc_before.jpg" height="413" width="666" /&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Исправить это можно двумя способами. Первый проще, нужно просто указать несколько иные настройки PuTTY: &lt;em&gt;Terminal -&amp;gt; Keyboard -&amp;gt; The Function&lt;/em&gt;: &lt;em&gt;Linux&lt;/em&gt; и &lt;em&gt;Connection -&amp;gt; Data -&amp;gt; Terminal-type&lt;/em&gt;: &lt;em&gt;linux&lt;/em&gt;. Но тогда отпадает мышка. Если Вы ею не пользуетесь, то этот способ Вам покатит. Но если всё же мышь нужна, то убедитесь, что на сервере &lt;strong&gt;mc&lt;/strong&gt; собран с USE флагом &lt;strong&gt;slang&lt;/strong&gt;, а не &lt;strong&gt;ncurses&lt;/strong&gt;. Тогда настроек в PuTTY менять не надо и всё работает и мышь и клавиатура.&lt;/p&gt;
&lt;p style="text-align: center;"&gt;&lt;img style="display: block; margin-left: auto; margin-right: auto;" alt="mc after" src="images/pub/putty-gentoo-locale/mc_after.jpg" height="413" width="666" /&gt;&lt;/p&gt;]]></fulltext>
<state>1</state>
<created><![CDATA[2012-06-17 10:56:49]]></created>
<created_by_alias></created_by_alias>
<modified><![CDATA[2012-06-17 11:21:11]]></modified>
<publish_up><![CDATA[2012-06-17 11:21:11]]></publish_up>
<publish_down><![CDATA[0000-00-00 00:00:00]]></publish_down>
<images><![CDATA[{"image_intro":"","float_intro":"","image_intro_alt":"","image_intro_caption":"","image_fulltext":"","float_fulltext":"","image_fulltext_alt":"","image_fulltext_caption":""}]]></images>
<urls><![CDATA[{"urla":null,"urlatext":"","targeta":"","urlb":null,"urlbtext":"","targetb":"","urlc":null,"urlctext":"","targetc":""}]]></urls>
<attribs><![CDATA[{"show_title":"","link_titles":"","show_intro":"","show_category":"","link_category":"","show_parent_category":"","link_parent_category":"","show_author":"","link_author":"","show_create_date":"","show_modify_date":"","show_publish_date":"","show_item_navigation":"","show_icons":"","show_print_icon":"","show_email_icon":"","show_vote":"","show_hits":"","show_noauth":"","urls_position":"","alternative_readmore":"","article_layout":"","show_publishing_options":"","show_article_options":"","show_urls_images_backend":"","show_urls_images_frontend":""}]]></attribs>
<version>4</version>
<ordering>11</ordering>
<metakey></metakey>
<metadesc></metadesc>
<access>1</access>
<hits>967</hits>
<metadata><![CDATA[{"robots":"","author":"","rights":"","xreference":""}]]></metadata>
<language><![CDATA[*]]></language>
<xreference></xreference>
<catid><![CDATA[notes/admin]]></catid>
<created_by><![CDATA[root]]></created_by>
<modified_by><![CDATA[root]]></modified_by>
<featured>0</featured>
<rating_sum>0</rating_sum>
<rating_count>0</rating_count>
</content><content>
<id>42</id>
<title><![CDATA[Создание обратного HTTP прокси сервера на nginx]]></title>
<alias><![CDATA[nginx-rev-proxy]]></alias>
<introtext><![CDATA[&lt;p style="text-align: justify;"&gt;Уже ни для кого не секрет, что в последнее время всё больше и больше серверов Интернета переходит на использование &lt;strong&gt;nginx&lt;/strong&gt; вместо &lt;strong&gt;Apache&lt;/strong&gt;. Он просто лучше справляется с нагрузкой, нежели &lt;strong&gt;Apache&lt;/strong&gt;. Вот только с подключением дополнительных скриптовых языков бывают проблемы. Некоторые вещи просто уже реально заточены под &lt;strong&gt;Apache&lt;/strong&gt; и переделывать их под &lt;strong&gt;nginx&lt;/strong&gt; несколько напряжно. Но есть один нюанс: по большому счёту &lt;strong&gt;nginx&lt;/strong&gt; используется как "морда" к &lt;strong&gt;Apache&lt;/strong&gt;, тоесть &lt;strong&gt;nginx&lt;/strong&gt; только принимает запросы от клиентов и отправляет им ответы. А обработкой данных занимается &lt;strong&gt;Apache&lt;/strong&gt;. Тоесть здесь положено говорить о том, что &lt;strong&gt;nginx&lt;/strong&gt; - это frontend, а &lt;strong&gt;Apache&lt;/strong&gt; - это backend. Вот о настройке таких вещей здесь пойдёт речь.&lt;/p&gt;
]]></introtext>
<fulltext><![CDATA[
&lt;p style="text-align: justify;"&gt;Итак у нас уже есть &lt;strong&gt;Apache&lt;/strong&gt;, настроен и работает.&lt;/p&gt;
&lt;h2 style="text-align: justify;"&gt;Настройка конфигурации frontend-backend&lt;/h2&gt;
&lt;p style="text-align: justify;"&gt;Итак. Для начала нужно установить &lt;strong&gt;nginx&lt;/strong&gt;. Особенного ничего нет, ставить нужно так как предлагает используемый Вами дистрибутив. Главное убедитесь, что он поставился с модулем &lt;strong&gt;ngx_http_proxy_module&lt;/strong&gt;.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Далее нужно освободить порт 80 от &lt;strong&gt;Apache&lt;/strong&gt; ибо он потребуется для &lt;strong&gt;nginx&lt;/strong&gt;. Для этого ищем в конфигах Apache директиву &lt;em&gt;Listen&lt;/em&gt;. По умолчанию там обычно написано&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;Listen 80&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;что означает слушать порт &lt;em&gt;80&lt;/em&gt;. Нужно изменить это,например так:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;Listen 127.0.0.1:8080&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Так мы указали, что нужно слушать порт &lt;em&gt;8080&lt;/em&gt; и только на &lt;em&gt;127.0.0.1&lt;/em&gt; (для backend так и надо, ибо с внешним миром будет общатся frontend). Теперь поищем все директивы обьявления виртуальных хостов, тоесть&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;&amp;lt;VirtualHost *:80&amp;gt;&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;эта конструкция может выглядеть и по другому (например вместо * может быть задан IP адрес, но скорее всего Вы сами его туда и вписывали, а значит в курсе), но суть та же - нужно поменять порт на новый.&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;&amp;lt;VirtualHost 127.0.0.1:8080&amp;gt;&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Нужно проделать это со всеми хостами, котороые занимают порт 80. И тоже важно найти директиву &lt;em&gt;NameVirtualHost&lt;/em&gt;:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;NameVirtualHost *:80&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;и тоже заменить порт на 8080:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;NameVirtualHost 127.0.0.1:8080&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Всё, с &lt;strong&gt;Apache&lt;/strong&gt; разобрались. Для правильной настройки frontend нужно посоздавать в конфигурации &lt;strong&gt;nginx&lt;/strong&gt; отделные сервера для каждого виртуального хоста. Конечно &lt;strong&gt;nginx&lt;/strong&gt; допускает, что можно прописать один, чтобы проксировал все, но ИМХО это небезопасно ибо разрешает всё. А ещё неизвестно, кто и что будет ломать. Так что лучше перестраховаться и дать доступ только туда, куда надо. Примерная конфигурация сервера в конфиге &lt;strong&gt;nginx&lt;/strong&gt; выглядит так:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;server {&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; listen 80;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; server_name adment.org.ua;&lt;br /&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; access_log /var/log/nginx/adment_access_log main;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; error_log /var/log/nginx/adment_error_log info;&lt;br /&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; proxy_http_version 1.1;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; proxy_set_header Host $host;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; proxy_set_header X-Forwarded-Host $host;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; proxy_set_header X-Real-IP $remote_addr;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;&lt;br /&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; location / {&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; proxy_pass http://127.0.0.1:8080;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }&lt;br /&gt;}&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Это как раз гипотетическая конфигурация для этого сайта (на самом же деле нужно спрашивать у хостера как тут всё устроено). И так по порядку. &lt;em&gt;listen 80&lt;/em&gt; означает, что ведётся прослушивание порта 80. Далее &lt;em&gt;server_name adment.org.ua&lt;/em&gt; задаёт доменное имя сервера, на который даный сервер будет отзываться. Если их несколько, то нужно указать их через пробел. Директивы &lt;em&gt;access_log&lt;/em&gt; и &lt;em&gt;error_log&lt;/em&gt; указывают пути к логам. Директива &lt;em&gt;proxy_http_version 1.1&lt;/em&gt; выбирает протокол &lt;em&gt;HTTP/1.1&lt;/em&gt; для работы с backend. Набор директив &lt;em&gt;proxy_set_header&lt;/em&gt; корректирует заголовки, посылаемые к &lt;strong&gt;Apache&lt;/strong&gt;. Дословно происходит вот что:&lt;/p&gt;
&lt;ul&gt;
&lt;li style="text-align: justify;"&gt;имя хоста передаётся без изменений&lt;/li&gt;
&lt;li style="text-align: justify;"&gt;устанавливается заголовок &lt;em&gt;X-Forwarded-Host&lt;/em&gt;, который содержит то же имя хоста;&lt;/li&gt;
&lt;li style="text-align: justify;"&gt;устанавливается реальный адрес клиента на заголовке &lt;em&gt;X-Real-IP&lt;/em&gt;;&lt;/li&gt;
&lt;li style="text-align: justify;"&gt;к заголовку &lt;em&gt;X-Forwarded-For&lt;/em&gt; добавляется IP-адрес клиента тот же, что и в &lt;em&gt;X-Real-IP&lt;/em&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p style="text-align: justify;"&gt;Данные заголовки могут быть использованы для точного определения клиента, работающего с Web-приложением. Скрипты на сервере должны читать их и делать выводы уже по ним, ибо в &lt;em&gt;REMOTE_ADDR&lt;/em&gt; будет содержаться &lt;em&gt;127.0.0.1&lt;/em&gt; (адрес frontend относительно backend). Хотя можно установить на &lt;strong&gt;Apache&lt;/strong&gt; модуль &lt;strong&gt;mod_rpaf&lt;/strong&gt;, который будет приводить всё в норму, но если конфигурация будет более сложной чем просто fontend-backend, то рекомендуется всё вытягивание адресов клиента делать уже в скриптах, чтобы не потерять важную информацию.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;С секции &lt;em&gt;location /&lt;/em&gt; описана одна единственная директива &lt;em&gt;proxy_pass&lt;/em&gt;, которая указывает к какому серверу вести перенаправление запросов. У нас это &lt;em&gt;127.0.0.1:8080&lt;/em&gt;, так как настроен &lt;strong&gt;Apache&lt;/strong&gt;. После запуска &lt;strong&gt;ngnix&lt;/strong&gt; все хосты будут вновь доступны.&lt;/p&gt;]]></fulltext>
<state>0</state>
<created><![CDATA[2012-06-18 07:17:54]]></created>
<created_by_alias></created_by_alias>
<modified><![CDATA[2012-09-26 22:11:37]]></modified>
<publish_up><![CDATA[0000-00-00 00:00:00]]></publish_up>
<publish_down><![CDATA[0000-00-00 00:00:00]]></publish_down>
<images><![CDATA[{"image_intro":"","float_intro":"","image_intro_alt":"","image_intro_caption":"","image_fulltext":"","float_fulltext":"","image_fulltext_alt":"","image_fulltext_caption":""}]]></images>
<urls><![CDATA[{"urla":null,"urlatext":"","targeta":"","urlb":null,"urlbtext":"","targetb":"","urlc":null,"urlctext":"","targetc":""}]]></urls>
<attribs><![CDATA[{"show_title":"","link_titles":"","show_intro":"","show_category":"","link_category":"","show_parent_category":"","link_parent_category":"","show_author":"","link_author":"","show_create_date":"","show_modify_date":"","show_publish_date":"","show_item_navigation":"","show_icons":"","show_print_icon":"","show_email_icon":"","show_vote":"","show_hits":"","show_noauth":"","urls_position":"","alternative_readmore":"","article_layout":"","show_publishing_options":"","show_article_options":"","show_urls_images_backend":"","show_urls_images_frontend":""}]]></attribs>
<version>8</version>
<ordering>10</ordering>
<metakey></metakey>
<metadesc></metadesc>
<access>1</access>
<hits>3</hits>
<metadata><![CDATA[{"robots":"","author":"","rights":"","xreference":""}]]></metadata>
<language><![CDATA[*]]></language>
<xreference></xreference>
<catid><![CDATA[notes/admin]]></catid>
<created_by><![CDATA[root]]></created_by>
<modified_by><![CDATA[root]]></modified_by>
<featured>0</featured>
<rating_sum>0</rating_sum>
<rating_count>0</rating_count>
</content><content>
<id>53</id>
<title><![CDATA[Установка GIT репозитория для работы через чистый HTTP]]></title>
<alias><![CDATA[http-git]]></alias>
<introtext><![CDATA[&lt;p&gt;Установка GIT репозитория для работы через чистый HTTP&lt;/p&gt;]]></introtext>
<fulltext></fulltext>
<state>0</state>
<created><![CDATA[2012-09-21 07:11:22]]></created>
<created_by_alias></created_by_alias>
<modified><![CDATA[0000-00-00 00:00:00]]></modified>
<publish_up><![CDATA[0000-00-00 00:00:00]]></publish_up>
<publish_down><![CDATA[0000-00-00 00:00:00]]></publish_down>
<images><![CDATA[{"image_intro":"","float_intro":"","image_intro_alt":"","image_intro_caption":"","image_fulltext":"","float_fulltext":"","image_fulltext_alt":"","image_fulltext_caption":""}]]></images>
<urls><![CDATA[{"urla":null,"urlatext":"","targeta":"","urlb":null,"urlbtext":"","targetb":"","urlc":null,"urlctext":"","targetc":""}]]></urls>
<attribs><![CDATA[{"show_title":"","link_titles":"","show_intro":"","show_category":"","link_category":"","show_parent_category":"","link_parent_category":"","show_author":"","link_author":"","show_create_date":"","show_modify_date":"","show_publish_date":"","show_item_navigation":"","show_icons":"","show_print_icon":"","show_email_icon":"","show_vote":"","show_hits":"","show_noauth":"","urls_position":"","alternative_readmore":"","article_layout":"","show_publishing_options":"","show_article_options":"","show_urls_images_backend":"","show_urls_images_frontend":""}]]></attribs>
<version>1</version>
<ordering>9</ordering>
<metakey></metakey>
<metadesc></metadesc>
<access>1</access>
<hits>0</hits>
<metadata><![CDATA[{"robots":"","author":"","rights":"","xreference":""}]]></metadata>
<language><![CDATA[*]]></language>
<xreference></xreference>
<catid><![CDATA[notes/admin]]></catid>
<created_by><![CDATA[root]]></created_by>
<featured>0</featured>
<rating_sum>0</rating_sum>
<rating_count>0</rating_count>
</content><content>
<id>54</id>
<title><![CDATA[Настройка аутентификации в Apache на основе данных с БД MySQL]]></title>
<alias><![CDATA[apache-mysql-auth]]></alias>
<introtext><![CDATA[&lt;p style="text-align: justify;"&gt;Как уже упоминалось &lt;a href="index.php?option=com_content&amp;amp;view=article&amp;amp;id=56:apache-dir-passwording&amp;amp;catid=11:admin&amp;amp;Itemid=105" target="_blank"&gt;в прошлой записке&lt;/a&gt;, модули аутентификации пользователей средствами Apache могут оказаться весьма полезными. Но основное неудобство в этом деле как ни странно будет создание файликов с паролями. Порой бывает, что уже есть хранилище такой информации, только в другой форме. Например есть форум, где каждый пользователь создаёт свой аккаунт. И есть какие-то файлы, которые должны быть доступны только для пользователей форума. Перегонять их через CGI сценарий - дело неблагодарное и никак не может сказаться на скорости работы положительно. Статический файл стянуть куда быстрее и проще, нужно только нужным образом задать к нему доступ.&lt;/p&gt;
]]></introtext>
<fulltext><![CDATA[
&lt;p style="text-align: justify;"&gt;В Apache такое сделать возможно, для этого есть средства. И тут мы рассморим как использовать БД MySQL как хранилище паролей.&lt;/p&gt;
&lt;h2 style="text-align: justify;"&gt;Способ 1. &lt;em&gt;mod_auth_mysql&lt;/em&gt;&lt;/h2&gt;
&lt;p style="text-align: justify;"&gt;Это есть специализированный модуль для подчитывания логинов и паролей с таблицы в MySQL. Прежде чем его использовать рекомендую пройти на &lt;a href="http://modauthmysql.sourceforge.net/" rel="nofollow" target="_blank"&gt;оффициальный сайт&lt;/a&gt; и посмотреть дату последнего обновления (версия 3.0.0 от 22.06.2005), после чего хорошо подумать. Нет, я не утверждаю, что старый софт никуда не годится, но с этим модулем всё походу именно так. Ни один с вариантов конфигурации, описанных в оффициальной документации не прокатил, поскольку в них не было указанного &lt;em&gt;AuthUserFile&lt;/em&gt;, а Apache 2.2.22 очень его хотел. В принципе опытным путём подобрал что-то рабочее. Выгладело именно так:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;AuthType Basic &lt;em&gt;# использование базовой аутентификации&lt;/em&gt;&lt;br /&gt;AuthName "Restricted Area" &lt;em&gt;# сообщение, которое сопровождает запрос пароля&lt;/em&gt;&lt;br /&gt;AuthBasicAuthoritative Off &lt;em&gt;# не требовать аутентификацию через Basic&lt;/em&gt;&lt;br /&gt;&lt;br /&gt;AuthMYSQLEnable on &lt;em&gt;# включить MySQL аутентификацию&lt;/em&gt;&lt;br /&gt;AuthMySQLAuthoritative on &lt;em&gt;# требовать прохождение MySQL аунентификации&lt;/em&gt;&lt;br /&gt;AuthMySQLHost 127.0.0.1 &lt;em&gt;# адрес MySQL сервера&lt;/em&gt;&lt;br /&gt;AuthMySQLPort 3306 &lt;em&gt;# порт MySQL сервера&lt;/em&gt;&lt;br /&gt;AuthMySQLUser db_auth &lt;em&gt;# имя пользователя сервера БД&lt;/em&gt;&lt;br /&gt;AuthMySQLPassword db_auth_pass &lt;em&gt;# его пароль&lt;/em&gt;&lt;br /&gt;AuthMySQLDB users_base &lt;em&gt;# название самой БД&lt;/em&gt;&lt;br /&gt;AuthMySQLUserTable users &lt;em&gt;# название таблицы&lt;/em&gt;&lt;br /&gt;AuthMySQLPwEncryption none &lt;em&gt;# указание того, что в БД пароли находятся в чистом виде&lt;/em&gt;&lt;br /&gt;AuthMySQLNameField username &lt;em&gt;# название поля с логинами пользователей&lt;/em&gt;&lt;br /&gt;AuthMySQLPasswordField password &lt;em&gt;# название поля с паролями&lt;/em&gt;&lt;br /&gt;Require valid-user &lt;em&gt;# впускать любого правильного пользователя&lt;/em&gt;
&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Такая конфигурация подразумеват, что в БД &lt;em&gt;user_base&lt;/em&gt; есть таблица &lt;em&gt;users&lt;/em&gt; с полями &lt;em&gt;username&lt;/em&gt; и &lt;em&gt;password&lt;/em&gt; под логин и пароль соответсвенно. Модуль там ищет пару погин-пароль и если такая находится, вход считается выполненным. Пароли в БД могут быть и хешированными, для этого нужно менять значение директивы &lt;em&gt;AuthMySQLPwEncryption&lt;/em&gt; в значения &lt;em&gt;crypt&lt;/em&gt;, &lt;em&gt;scrambled&lt;/em&gt; (шифрование MySQL), &lt;em&gt;md5&lt;/em&gt;, &lt;em&gt;aes&lt;/em&gt; или &lt;em&gt;sha1&lt;/em&gt; (нужное подчеркнуть).&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Оно даже как-то работало, но периодически переспрашивало пароль. Потом выяснил, что модуть периодически сбоил и терял соединение с БД в процессе выполения запроса, после чего всё же учёл тот факт, что модуль всё-таки древний. Далее мои развлечения с ним закончились.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Потом я посмотрел в репозиторий Gentoo (да, именно она установлена сервере) и кроме рассмотренного &lt;em&gt;www-apache/mod_auth_mysql&lt;/em&gt; нашёл там &lt;em&gt;www-apache/mod-auth-mysql&lt;/em&gt; уже версии 4.3.9. Он конечно был отмечен как нестабильный, но исследования ради надо было попробовать. Эти два друга вместе стоять не могут впринципе, поэтому пришлось просто заменить.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Походу это то же самое, только потянутое с Debian. В конфигурацию Apache добавляется аналогично своему предшественнику. Включил и результат меня не впечетлил - Apache оказался запускаться, он не смог найти в &lt;em&gt;apache2_mod_auth_mysql.so&lt;/em&gt; символ &lt;em&gt;apache2_mysql_auth_module&lt;/em&gt;. Неясно куда смотрел пишущий конфиги, оно же с коробки не работает. Может потому на нём нет кейворда стабильности. Ну и фиг с ним, випилил.&lt;/p&gt;
&lt;h2 style="text-align: justify;"&gt;Способ 2. &lt;em&gt;mod_authnz_external&lt;/em&gt;&lt;/h2&gt;
&lt;p style="text-align: justify;"&gt;Ну поскольку модуля для аутентификации кончились, пришлось копать немного в другую сторону. И нашлось универсальное решение - аутентификация внешней программой. Всё, что нужно - это внешний аутентификатор, который осуществит запрос к БД и скажет, правильные ли даны реквизиты.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Для начала нужно обьявить аутентификатор в конфигурации Apache:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;&amp;lt;IfModule authnz_external_module&amp;gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; DefineExternalAuth cl_auth pipe /var/www/localhost/bin/authscript&lt;br /&gt;&amp;lt;/IfModule&amp;gt;&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Тут проблема состоит в том, что прописать это в &lt;em&gt;.htaccess&lt;/em&gt; просто нельзя, поэтому нужно буть админом сервера. Это можно писать либо в глобальную конфигурацию сервера либо в конфигурацию виртуального хоста. Но не глубже.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Далее защищаем нужную папку:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;AuthType Basic &lt;em&gt;# использование базовой аутентификации&lt;/em&gt;&lt;br /&gt;AuthName "Restricted Area" &lt;em&gt;# сообщение, которое сопровождает запрос пароля&lt;/em&gt;&lt;br /&gt;AuthBasicProvider external &lt;em&gt;# использовать mod_authnz_external&lt;/em&gt;&lt;br /&gt;AuthExternal cl_auth &lt;em&gt;# какой именно аутентификатор использовать&lt;/em&gt;&lt;br /&gt;Require valid-user &lt;em&gt;# впускать любого правильного пользователя&lt;/em&gt;
&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Это уже можно писать куда угодно. Следует отметить, что можно использовать лишь базовую аутентификацию, поскольку &lt;em&gt;mod_authnz_external&lt;/em&gt; с дайджестами скорее всего работать не будет. Его разработчики обясняют это тем, что для дайджестов нужно иметь лишь базу с чистыми паролями или с уже готовыми дайджестами, что в реальной жизни далеко не всегда возможно. Поэтому походу они не парились над поддержкой. Хотя нужно как-то попробовать ;-).&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Теперь перейдём к аутентификатору. Нужную нам задачу с лихвой выполнит вот такой скрипт:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;#!/usr/bin/php&lt;br /&gt;&amp;lt;?php&lt;br /&gt;$db = new mysqli("127.0.0.1", "db_auth", "db_auth_pass", "users_base", 3306);&lt;br /&gt;if(!$db)&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; exit(1);&lt;br /&gt;$fp=fopen("php://stdin","r");&lt;br /&gt;$username = stream_get_line($fp, 1024,"\n");&lt;br /&gt;$password = stream_get_line($fp, 1024,"\n");&lt;br /&gt;fclose($fp);&lt;br /&gt;$result = $db-&amp;gt;query("SELECT `id` FROM `users` WHERE `username` = '".$db-&amp;gt;real_escape_string($username)."' AND `password` = '".$db-&amp;gt;real_escape_string($password)."'");&lt;br /&gt;if(!$result)&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; exit(1);&lt;br /&gt;if($result-&amp;gt;num_rows == 1)&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; exit(0);&lt;br /&gt;exit(1);&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Всё просто: если в базе наши одну пару логин и пароль, введённую юзером, то возвращаем 0, чем говорим о том, что все окай. Иначе просто возвращаем 1. Сохраняем его как &lt;em&gt;/var/www/localhost/bin/authscript&lt;/em&gt;, даём права на исполнение.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Вроде бы всё нормально. Но не совсем. Тут происходит так же, как и &lt;em&gt;mod_auth_mysql&lt;/em&gt;, только реже. А пароль-то всё равно спрашивает повторно и это раздражает. Очень раздражает. Судя по логам этот скрипт возвращает код -5 раньше чем серевер даст ему реквизиты на проверку. Почему - ещё не знаю, но подозреваю, что связано это с какими то системными ограничениями. На PHP списывать не буду, так как заменял его не один раз. Заменил вот этим:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;#!/usr/bin/perl&lt;br /&gt;&lt;br /&gt;use DBI;&lt;br /&gt;&lt;br /&gt;$username= &amp;lt;STDIN&amp;gt;;&lt;br /&gt;chomp $username;&lt;br /&gt;&lt;br /&gt;$passname= &amp;lt;STDIN&amp;gt;;&lt;br /&gt;chomp $passname;&lt;br /&gt;&lt;br /&gt;my $dbh = DBI-&amp;gt;connect('dbi:mysql:users_base:127.0.0.1:3306', 'db_auth', 'db_auth_pass') or exit 1;&lt;br /&gt;&lt;br /&gt;my $sth = $dbh-&amp;gt;prepare('SELECT id FROM users WHERE username = ? AND password = ?');&lt;br /&gt;$sth-&amp;gt;execute($username, $passname);&lt;br /&gt;&lt;br /&gt;if($sth-&amp;gt;rows == 1) {&lt;br /&gt;    exit 0;&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;exit 1;&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Этот скрипт вылетает, но уже не так часто. Так что проблема целиком не устранена. Надо будет как-то занятся.&lt;/p&gt;
&lt;h2 style="text-align: justify;"&gt;Способ 3. Автоматическая файлогенерация&lt;/h2&gt;
&lt;p style="text-align: justify;"&gt;Но преследуя цель аутентифицировать юзеров на основе данных с БД MySQL не обязательно делать в неё запросы каждый раз, когда нужно проверить правильность реквизитов. Можно просто на основе данных с БД создать файлик с паролями и аутентифицировать при помощи &lt;em&gt;mod_auth_basic&lt;/em&gt; или &lt;em&gt;mod_auth_digest&lt;/em&gt; в связке с &lt;em&gt;mod_authn_file&lt;/em&gt;. Как это делать я уже рассказывал &lt;a href="index.php?option=com_content&amp;amp;view=article&amp;amp;id=56:apache-dir-passwording&amp;amp;catid=11:admin&amp;amp;Itemid=105" target="_blank"&gt;в предыдущей записке&lt;/a&gt;. Тут мы только рассмотрим примерную методику генерации файлов.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Итак, если будем юзать &lt;em&gt;mod_auth_basic&lt;/em&gt;, то скрит дожен быть примерно следующим:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;#!/usr/bin/php&lt;br /&gt;&amp;lt;?php&lt;br /&gt;$db = new mysqli("127.0.0.1", "db_auth", "db_auth_pass", "users_base", 3306);&lt;br /&gt;if(!$db) exit(1);&lt;br /&gt;&lt;br /&gt;function getPasswd($login, $pass) {&lt;br /&gt;    return crypt($pass, base64_encode($pass));&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;function getPasswdLine($login, $pass) {&lt;br /&gt;    return "{$login}:".getPasswd($login, $pass);&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;$file = "/var/www/localhost/etc/db.htpasswd"; // путь, где будет лежать файл с паролями&lt;br /&gt;$tmp = "/tmp/db.htpasswd";&lt;br /&gt;&lt;br /&gt;$result = $db-&amp;gt;query('SELECT `username`, `password` FROM `users`');&lt;br /&gt;if(!$result) exit(1);&lt;br /&gt;$out = fopen($tmp, 'w');&lt;br /&gt;while($row = $result-&amp;gt;fetch_row()) {&lt;br /&gt;    $line = getPasswdLine($row[0], $row[1])."\n";&lt;br /&gt;    fwrite($out, $line);&lt;br /&gt;}&lt;br /&gt;fclose($out);&lt;br /&gt;system("mv -f $tmp $file");&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Вот примерно где-то так. Скрипт можно кинуть в cron на исполенение через некоторое время. Но лучше будет модифицировать программу так, чтобы при смене пароля пользователем или регистрации нового вызывался этот код. Так лучше, потому что изменения будут вступать в силу сразу же, и не будет необходимости ждать, когда же файл будет обновлен.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Если хотим использовать mod_auth_digest, то скрипт немного другой:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;#!/usr/bin/php&lt;br /&gt;&amp;lt;?php&lt;br /&gt;$realm = "Restricted Area";&lt;br /&gt;$db = new mysqli("127.0.0.1", "db_auth", "db_auth_pass", "users_base", 3306);&lt;br /&gt;if(!$db)&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; exit(1);&lt;br /&gt;function getDigest($login, $realm, $pass) {&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; return md5("{$login}:{$realm}:{$pass}");&lt;br /&gt;}&lt;br /&gt;function getDigestLine($login, $realm, $pass) {&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; return "{$login}:{$realm}:".getDigest($login, $realm, $pass);&lt;br /&gt;}&lt;br /&gt;$file = "/var/www/claroline/etc/dbo.htdigest";&lt;br /&gt;$tmp = "/tmp/dbo.htdigest";&lt;br /&gt;$result = $db-&amp;gt;query('SELECT `username`, `password` FROM `users`');&lt;br /&gt;if(!$result)&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; exit(1);&lt;br /&gt;$out = fopen($tmp, 'w');&lt;br /&gt;while($row = $result-&amp;gt;fetch_row()) {&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; $line = getDigestLine($row[0], $realm, $row[1])."\n";&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; fwrite($out, $line);&lt;br /&gt;}&lt;br /&gt;fclose($out);&lt;br /&gt;system("mv -f $tmp $file");&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Вот впринципе и всё. Естесственно оба скрипта требуют, чтобы пароли в БД были в чистом виде. Поэтому стоит задуматся о том, чтобы модифицировать программу так, чтобы она сама шифровала пароль в нужный формат ещё при смене, если есть необходимость скрывать пароли пользователей в самой БД. В любом случае из приведённых скриптов ясно и понятно как именно их нужно шифровать.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Скачать скипты:&lt;br /&gt;&lt;a href="images/pub/apache-mysql-auth/authscript_php.xz" target="_blank"&gt;&lt;img src="images/filetypes/application-x-php.png" alt="" border="0" /&gt; Аутентификатор для &lt;em&gt;mod_authnz_external&lt;/em&gt; (php)&lt;/a&gt;&lt;br /&gt;&lt;a href="images/pub/apache-mysql-auth/authscript_pl.xz" target="_blank"&gt;&lt;img src="images/filetypes/application-x-perl.png" alt="" border="0" /&gt; Аутентификатор для &lt;em&gt;mod_authnz_external&lt;/em&gt; (perl)&lt;/a&gt;&lt;br /&gt;&lt;a href="images/pub/apache-mysql-auth/htpasswd_gen_php.xz" target="_blank"&gt;&lt;img src="images/filetypes/application-x-php.png" alt="" border="0" /&gt; Генератор файла с паролями для mod_auth_basic (php)&lt;/a&gt;&lt;br /&gt;&lt;a href="images/pub/apache-mysql-auth/htdigest_gen_php.xz" target="_blank"&gt;&lt;img src="images/filetypes/application-x-php.png" alt="" border="0" /&gt; Генератор файла с паролями для mod_auth_digest (php)&lt;/a&gt;&lt;/p&gt;]]></fulltext>
<state>1</state>
<created><![CDATA[2012-09-23 07:12:40]]></created>
<created_by_alias></created_by_alias>
<modified><![CDATA[2013-03-08 16:30:46]]></modified>
<publish_up><![CDATA[2012-09-23 12:43:25]]></publish_up>
<publish_down><![CDATA[0000-00-00 00:00:00]]></publish_down>
<images><![CDATA[{"image_intro":"","float_intro":"","image_intro_alt":"","image_intro_caption":"","image_fulltext":"","float_fulltext":"","image_fulltext_alt":"","image_fulltext_caption":""}]]></images>
<urls><![CDATA[{"urla":null,"urlatext":"","targeta":"","urlb":null,"urlbtext":"","targetb":"","urlc":null,"urlctext":"","targetc":""}]]></urls>
<attribs><![CDATA[{"show_title":"","link_titles":"","show_intro":"","show_category":"","link_category":"","show_parent_category":"","link_parent_category":"","show_author":"","link_author":"","show_create_date":"","show_modify_date":"","show_publish_date":"","show_item_navigation":"","show_icons":"","show_print_icon":"","show_email_icon":"","show_vote":"","show_hits":"","show_noauth":"","urls_position":"","alternative_readmore":"","article_layout":"","show_publishing_options":"","show_article_options":"","show_urls_images_backend":"","show_urls_images_frontend":""}]]></attribs>
<version>33</version>
<ordering>8</ordering>
<metakey></metakey>
<metadesc></metadesc>
<access>1</access>
<hits>524</hits>
<metadata><![CDATA[{"robots":"","author":"","rights":"","xreference":""}]]></metadata>
<language><![CDATA[*]]></language>
<xreference></xreference>
<catid><![CDATA[notes/admin]]></catid>
<created_by><![CDATA[root]]></created_by>
<modified_by><![CDATA[root]]></modified_by>
<featured>0</featured>
<rating_sum>0</rating_sum>
<rating_count>0</rating_count>
</content><content>
<id>55</id>
<title><![CDATA[Простая автоматизированная система создания и хранения бекапов]]></title>
<alias><![CDATA[bash-automated-backup]]></alias>
<introtext><![CDATA[&lt;p&gt;Простая автоматизированная система создания и хранения бекапов&lt;/p&gt;]]></introtext>
<fulltext></fulltext>
<state>0</state>
<created><![CDATA[2012-09-23 07:17:41]]></created>
<created_by_alias></created_by_alias>
<modified><![CDATA[2012-09-23 12:43:07]]></modified>
<publish_up><![CDATA[0000-00-00 00:00:00]]></publish_up>
<publish_down><![CDATA[0000-00-00 00:00:00]]></publish_down>
<images><![CDATA[{"image_intro":"","float_intro":"","image_intro_alt":"","image_intro_caption":"","image_fulltext":"","float_fulltext":"","image_fulltext_alt":"","image_fulltext_caption":""}]]></images>
<urls><![CDATA[{"urla":null,"urlatext":"","targeta":"","urlb":null,"urlbtext":"","targetb":"","urlc":null,"urlctext":"","targetc":""}]]></urls>
<attribs><![CDATA[{"show_title":"","link_titles":"","show_intro":"","show_category":"","link_category":"","show_parent_category":"","link_parent_category":"","show_author":"","link_author":"","show_create_date":"","show_modify_date":"","show_publish_date":"","show_item_navigation":"","show_icons":"","show_print_icon":"","show_email_icon":"","show_vote":"","show_hits":"","show_noauth":"","urls_position":"","alternative_readmore":"","article_layout":"","show_publishing_options":"","show_article_options":"","show_urls_images_backend":"","show_urls_images_frontend":""}]]></attribs>
<version>2</version>
<ordering>7</ordering>
<metakey></metakey>
<metadesc></metadesc>
<access>1</access>
<hits>0</hits>
<metadata><![CDATA[{"robots":"","author":"","rights":"","xreference":""}]]></metadata>
<language><![CDATA[*]]></language>
<xreference></xreference>
<catid><![CDATA[notes/admin]]></catid>
<created_by><![CDATA[root]]></created_by>
<modified_by><![CDATA[root]]></modified_by>
<featured>0</featured>
<rating_sum>0</rating_sum>
<rating_count>0</rating_count>
</content><content>
<id>56</id>
<title><![CDATA[Защита папки паролем на Web-сервере Apache]]></title>
<alias><![CDATA[apache-dir-passwording]]></alias>
<introtext><![CDATA[&lt;p style="text-align: justify;"&gt;В жизни всякое бывает, часто приходится ограничивать доступ к разным данным. Такие данные могут быть размещены на Web-сервере и видны в Интернет. Чтобы ограничить доступ к такой информации можно придумать разные ухищрения, но самым популярным способом есть установка пароля. Всё очень просто: мы выставляем на папку в файлами пароль и чтобы в неё попасть, пользователь должен будет вводить пароль. Если пароль сообщить только нужным людям, то доступ к информации будет ограничен.&lt;/p&gt;
]]></introtext>
<fulltext><![CDATA[
&lt;p style="text-align: justify;"&gt;Итак, если мы используем один их самых популярных Web-серверов &lt;strong&gt;Apache&lt;/strong&gt;, то мы вполне можем реализировать это. Для этого в комплекте есть специальные модули.&lt;/p&gt;
&lt;h2 style="text-align: justify;"&gt;Базовая аутентификация через &lt;em&gt;mod_auth_basic&lt;/em&gt;&lt;/h2&gt;
&lt;p style="text-align: justify;"&gt;Самый распространённый тип аутентификации, поскольку модуль &lt;em&gt;mod_auth_basic&lt;/em&gt; установлен если не на 95%, то хотя бы на 80% серверов. А это уже немало. Суть такова. Пользователь пытается получить доступ к данным и тут оказывается, что папка защищена. Браузер спрашивает у пользователя его логин и пароль. Далее пользователь даёт свои реквизиты, после чего бразуер отправляет эти сведения серверу. Далее идёт проверка одним из модулей семейства &lt;em&gt;mod_authn_&lt;/em&gt; (или &lt;em&gt;mod_authnz_&lt;/em&gt;). Если реквизиты правильные, то пользователь получает доступ к чему хотел. Если же нет, браузер спрашивает ещё раз. Он будет так делать до тех пор, пока не получить правильные реквизиты или пользователь не откажется, назав &lt;em&gt;Esc&lt;/em&gt; или &lt;em&gt;Cancel&lt;/em&gt;. Случае отказа сервер выдаст ошибку &lt;em&gt;401 Authorization Required&lt;/em&gt;.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Самым распространённым модулем проверки правильности логина и пароля есть &lt;em&gt;mod_authn_file&lt;/em&gt;. Он предусматривает сохранение базы логинов и паролей в файле специального формата. Простейшая конфигурация для защиты папки паролем выглядит так:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;AuthType Basic &lt;em&gt;# указание использовать mod_auth_basic&lt;/em&gt;&lt;br /&gt;AuthName "Restricted Area" &lt;em&gt;# фраза, которая будет присутсвовать при запросе пароля&lt;/em&gt;&lt;br /&gt;AuthBasicProvider file &lt;em&gt;# указание использовать mod_authn_file&lt;/em&gt;&lt;br /&gt;AuthUserFile /var/www/localhost/etc/.htpasswd &lt;em&gt;# путь к файлу с паролями&lt;/em&gt;&lt;br /&gt;Require valid-user &lt;em&gt;# указание впускать только любые правильные реквизиты&lt;/em&gt;&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Путь к файлу с паролями нужно указывать абсолютный, иначе будет произведён его поиск в каталоге, заданному директивой &lt;em&gt;ServerRoot&lt;/em&gt;. Если сервер не является Вашей собственностью и Вы там не админ (ну например это какой-то хостинг), то скорее всего файл будет размещён где-то в &lt;em&gt;DocumentRoot&lt;/em&gt; или рядом. Если абсолютный путь &lt;em&gt;DocumentRoot&lt;/em&gt; Вам никто не сообщил, то его можно вычислить например фот таким PHP-скриптом:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;&amp;lt;?php&lt;br /&gt;echo __FILE__;&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Скрипт покажет своё абсолютное расположение. Ну а далее уже несложно догадаться. Кстати явно указывать на использование &lt;em&gt;mod_authn_file&lt;/em&gt; нет нужды, так как это предусматривается по умолчанию. Последняя строка тоже может меняться в зависимости от необходимого результата. В приведённом выше примере правильными считаются любые реквизиты, которые находяться в файле &lt;em&gt;/var/www/localhost/etc/.htpasswd&lt;/em&gt;. Но можно проверять и немного не так. Если в этом файле находятся много реквизитов и не всем нужно дать доступ, то можно немного разнообразить это дело.&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;Require user alex damien&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Этот пример пропустит только позователей &lt;em&gt;alex&lt;/em&gt; и &lt;em&gt;damien&lt;/em&gt;. Можно прописать много пользователей по аналогии, но это бывает не очень удобно, особенно если тысячи их. Данный функционал обеспечивается модулем &lt;em&gt;mod_authz_user&lt;/em&gt;.&lt;/p&gt;
&lt;h3 style="text-align: justify;"&gt;Групповая авторизация посредством &lt;em&gt;mod_authz_groupfile&lt;/em&gt;&lt;/h3&gt;
&lt;p style="text-align: justify;"&gt;И тут на помощь может прийти разделение пользователей на группы. Это есть удобно. Для этого создадим файлик с группами, назовём его например &lt;em&gt;/var/www/localhost/etc/.htgroup&lt;/em&gt;. Запишем нашу группу пользователей:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;group1: alex damien&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;И так для кажой группы. Сколько груп, столько и сторок. В нашу конфигурацию добавим директиву:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;AuthGroupFile /var/www/localhost/etc/.htgroup&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;И наконец укажем какую группу надо пропускать:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;Require group group1&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Можно указать и несколько, по аналогии с неколькими юзерами (т.е. через пробел).&lt;/p&gt;
&lt;h3 style="text-align: justify;"&gt;Создание файла с паролями&lt;/h3&gt;
&lt;p style="text-align: justify;"&gt;Всё это конечно хорошо, но как создать файл с паролями я так и не сказал. А создать его очень просто. Для этого в комплекте с &lt;strong&gt;Apache HTTP-server&lt;/strong&gt; есть программа &lt;em&gt;htpasswd&lt;/em&gt;, предназначенная как раз для этого. Порядок работы с ней таков:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;$ htpasswd /var/www/localhost/etc/.htpasswd alex&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Программа запросит пароль для пользователя &lt;em&gt;alex&lt;/em&gt;. Если файл ещё не существует, то нужно запускать программу с ключом &lt;em&gt;-c&lt;/em&gt;:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;$ htpasswd -c /var/www/localhost/etc/.htpasswd alex&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Если пользователя нужно удалить, то нужно использовать ключ &lt;em&gt;-D&lt;/em&gt;. Существует ещё пара-тройка ключей, позволяющих задать шифрование пароля, но об этом уже будьте любезны почитать ман.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Кстати пользоваться этой программой можно и на другом компе, а файл просто скопировать на сервер. Это может понадобится, когда к серверу нет доступа по &lt;strong&gt;ssh&lt;/strong&gt;.&lt;/p&gt;
&lt;h2 style="text-align: justify;"&gt;Дайджестная аутентификация через &lt;em&gt;mod_auth_digest&lt;/em&gt;&lt;/h2&gt;
&lt;p style="text-align: justify;"&gt;У базовой атентификации есть недостаток. Логин и пароль пользователя передаются в открытом виде. Это даёт возможность перехватить сетевой пакет и вытянуть с него логин и пароль. Для избежания этого применять базовую аутентификацию не рекомендуется, если есть возможность использовать дайджестную. Браузер в этом случае вместо логина и пароля передаёт дайджест от строки:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;login:realm:password&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Дайджест расшифровать невозможно, поэтому и достать из него что-то быстро тоже не получится (но метод перебора никто не отменял). Но использование дайджеста не рекомендуют в связи с тем, что якобы не всё браузеры его поддерживают. Это наглая дезинформация, на сегодня всеиспользуемые браузеры её поддерживают, а если какой-то &lt;strong&gt;Internet Explorer&lt;/strong&gt; что-то там не понимает, то это не наши проблемы. Более правдивым аргументом против дайджестной аутентификации есть немоддержка её сервером, тоесть отсутсвие модуля &lt;em&gt;mod_auth_digest&lt;/em&gt;. Чтобы всё было хорошо, его необходимо установить.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Так же как и для базовой, здесь тоже пароли можно содержать в файле. Простейшая настройка выглядит так:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;AuthType Digest &lt;em&gt;# указание использовать mod_auth_digest&lt;/em&gt;&lt;br /&gt;AuthName "Restricted Area" &lt;em&gt;# фраза, которая будет присутсвовать при запросе пароля&lt;/em&gt;&lt;br /&gt;AuthDigestProvider file &lt;em&gt;# указание использовать mod_authn_file&lt;/em&gt;&lt;br /&gt;AuthUserFile /var/www/localhost/etc/.htdigest &lt;em&gt;# путь к файлу с паролями&lt;/em&gt;&lt;br /&gt;Require valid-user &lt;em&gt;# указание впускать только любые правильные реквизиты&lt;/em&gt;&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Выгядит почти так же как и раньше. Таким же способом как и раньше можно указать каких конкретно пользователей нужно впускать. И точно так же можно разбить пользователей по группам.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Остаётся только рассказать как создать файл с паролями. Делается это посредством программы &lt;em&gt;htdigest&lt;/em&gt;, которая как ни странно тоже идёт в комплекте с &lt;strong&gt;Apache&lt;/strong&gt;. Использовать так:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;$ htdigest /var/www/localhost/etc/.htdigest "Restricted Area" alex&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Программа запросит пароль для пользователя &lt;em&gt;alex&lt;/em&gt;. То, что в командной строке написано перед логином пользователя называется &lt;em&gt;realm&lt;/em&gt;, и должно соосветсвовать значению директивы &lt;em&gt;AuthName&lt;/em&gt;. Таким образом можно в одном файле держать пароли для разных &lt;em&gt;realm&lt;/em&gt; и иметь для них разные пароли. Для создания нового файла с пароля предназначен ключ &lt;em&gt;-c&lt;/em&gt;, который как ни странно применяется так же как и для &lt;em&gt;htpasswd&lt;/em&gt;.&lt;/p&gt;
&lt;h2 style="text-align: justify;"&gt;Куда это прописать?&lt;/h2&gt;
&lt;p style="text-align: justify;"&gt;Ну и напоследок обязательно нужно упомнить куда это писать. Тут вариантов немного: конфиги &lt;strong&gt;httpd&lt;/strong&gt; или &lt;em&gt;.htaccess&lt;/em&gt;. В первом случае конфигурацию нужно заключить между парной директивы &lt;em&gt;Directory&lt;/em&gt; с указанием нужной папки, или же &lt;em&gt;Location&lt;/em&gt; с указаним нужного расположения. Вроде можно так же юзать &lt;em&gt;LocationMatch&lt;/em&gt; и &lt;em&gt;DirectoryMatch&lt;/em&gt;, но лично не проверял, не ручаюсь.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;В другом варианте нужно создать файл &lt;em&gt;.htaccess&lt;/em&gt; в той папке, которую хотим запаролить и записать конфигурацию туда. При этом нужно, чтобы сервер читал конфигурацию из этого файла. В конфигурации директории для этого нужно иметь как минимум:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;AllowOverride AuthConfig&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;или же вообще:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;AllowOverride All&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Вот впринципе и всё. Конечно эта статья не исчерпывает всех возможностей аутентификации средствами самого &lt;strong&gt;Apache&lt;/strong&gt;. Там ещё много и много интересного. Подробнее лучше консультироваться с оффициальной документацией.&lt;/p&gt;]]></fulltext>
<state>1</state>
<created><![CDATA[2012-09-22 12:59:25]]></created>
<created_by_alias></created_by_alias>
<modified><![CDATA[2012-09-23 12:08:10]]></modified>
<publish_up><![CDATA[2012-09-22 15:44:07]]></publish_up>
<publish_down><![CDATA[0000-00-00 00:00:00]]></publish_down>
<images><![CDATA[{"image_intro":"","float_intro":"","image_intro_alt":"","image_intro_caption":"","image_fulltext":"","float_fulltext":"","image_fulltext_alt":"","image_fulltext_caption":""}]]></images>
<urls><![CDATA[{"urla":null,"urlatext":"","targeta":"","urlb":null,"urlbtext":"","targetb":"","urlc":null,"urlctext":"","targetc":""}]]></urls>
<attribs><![CDATA[{"show_title":"","link_titles":"","show_intro":"","show_category":"","link_category":"","show_parent_category":"","link_parent_category":"","show_author":"","link_author":"","show_create_date":"","show_modify_date":"","show_publish_date":"","show_item_navigation":"","show_icons":"","show_print_icon":"","show_email_icon":"","show_vote":"","show_hits":"","show_noauth":"","urls_position":"","alternative_readmore":"","article_layout":"","show_publishing_options":"","show_article_options":"","show_urls_images_backend":"","show_urls_images_frontend":""}]]></attribs>
<version>21</version>
<ordering>6</ordering>
<metakey></metakey>
<metadesc></metadesc>
<access>1</access>
<hits>1132</hits>
<metadata><![CDATA[{"robots":"","author":"","rights":"","xreference":""}]]></metadata>
<language><![CDATA[*]]></language>
<xreference></xreference>
<catid><![CDATA[notes/admin]]></catid>
<created_by><![CDATA[root]]></created_by>
<modified_by><![CDATA[root]]></modified_by>
<featured>0</featured>
<rating_sum>0</rating_sum>
<rating_count>0</rating_count>
</content><content>
<id>60</id>
<title><![CDATA[Удаление устаревших бинарных логов MySQL]]></title>
<alias><![CDATA[mysql-binlog-removal]]></alias>
<introtext><![CDATA[&lt;p style="text-align: justify;"&gt;Тем, кто хоть раз имел дело с репликацией данных с одного MySQL сервера на другой по любом известно понятие бинарныз логов. Именно они передаются на SLAVE сервера для синхронизации данных. Но нужны они не только для этого. Они очень помогают при сбое сервера и внезапной его перезагрузке, тогда по бинарных логах MySQL может восстановить те данные, которые не успели попасть в харнилище. Не странно, что они включены по умолчанию везде, абсолютно везде. Но зачастую функция их автоматического удаления не настроена вообще. В результате при интенсивном юзании MySQL сервера вы можете столкунться с проблемой нехватки места на диске.&lt;/p&gt;
]]></introtext>
<fulltext><![CDATA[
&lt;p style="text-align: justify;"&gt;Логично, что очень древнющуе логи смыла хранить нет, так как по статистике они уже давно занесены в хранилище и переданы на SLAVE сервера для репликции. Поэтому есть смысл сказать MySQL серверу, что старые логи всё-таки надо пилить. З это отвечает конфигурационный параметр expire_logs_days в серкции [mysqld] конфигурационного файла my.cnf.&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;expire_logs_days = 14&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Теперь после перезапуска MySQL сервер уже будет знать какой древности логи уже стоить удалять (в приведённом примере период древности составляет 14 дней). Чтобы не ожидать когда он перезапустится можно просто подать запрос к серверу послредством &lt;em&gt;phpMyAdmin&lt;/em&gt; или консольной программы &lt;em&gt;mysql&lt;/em&gt;.&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;SET GLOBAL expire_logs_days=14;&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;На данные настройки MySQL может отреагировать не сразу. Поэтому если Вы куда-то спешите, можно произвести ручную зачистку логов до определённого времени используя такой запрос:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;PURGE BINARY LOGS BEFORE '2013-01-13 00:00:00';&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;В запросе указывается дата-врема (в формате datetime) до которого логи нужно выпилить. Если логов накопилось много, то и места можно освободить много (я себе освободил около 3 ГБ, что для раздела в 10 ГБ весьма существенно).&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;В завершение скажу, что не стоит увлекаться этим на production сервере, а то мало-ли. И вообще нужно ежедневно бэкапы делать :).&lt;/p&gt;]]></fulltext>
<state>1</state>
<created><![CDATA[2013-02-24 10:12:34]]></created>
<created_by_alias></created_by_alias>
<modified><![CDATA[2013-02-25 09:56:27]]></modified>
<publish_up><![CDATA[2013-02-24 10:20:34]]></publish_up>
<publish_down><![CDATA[0000-00-00 00:00:00]]></publish_down>
<images><![CDATA[{"image_intro":"","float_intro":"","image_intro_alt":"","image_intro_caption":"","image_fulltext":"","float_fulltext":"","image_fulltext_alt":"","image_fulltext_caption":""}]]></images>
<urls><![CDATA[{"urla":null,"urlatext":"","targeta":"","urlb":null,"urlbtext":"","targetb":"","urlc":null,"urlctext":"","targetc":""}]]></urls>
<attribs><![CDATA[{"show_title":"","link_titles":"","show_intro":"","show_category":"","link_category":"","show_parent_category":"","link_parent_category":"","show_author":"","link_author":"","show_create_date":"","show_modify_date":"","show_publish_date":"","show_item_navigation":"","show_icons":"","show_print_icon":"","show_email_icon":"","show_vote":"","show_hits":"","show_noauth":"","urls_position":"","alternative_readmore":"","article_layout":"","show_publishing_options":"","show_article_options":"","show_urls_images_backend":"","show_urls_images_frontend":""}]]></attribs>
<version>7</version>
<ordering>5</ordering>
<metakey></metakey>
<metadesc></metadesc>
<access>1</access>
<hits>310</hits>
<metadata><![CDATA[{"robots":"","author":"","rights":"","xreference":""}]]></metadata>
<language><![CDATA[*]]></language>
<xreference></xreference>
<catid><![CDATA[notes/admin]]></catid>
<created_by><![CDATA[root]]></created_by>
<modified_by><![CDATA[root]]></modified_by>
<featured>0</featured>
<rating_sum>0</rating_sum>
<rating_count>0</rating_count>
</content><content>
<id>63</id>
<title><![CDATA[Принудительная отправка deferred почты в Postfix]]></title>
<alias><![CDATA[postfix-resend-deferred]]></alias>
<introtext><![CDATA[&lt;p style="text-align: justify;"&gt;Может быть не часто, но случается, что почтовик (в этом случае &lt;strong&gt;postfix&lt;/strong&gt;) на сервере не может отправить исходящую почту. По идее он помещает всё это в очередь &lt;em&gt;deferred&lt;/em&gt; и когда нибудь он обязательно эту почту отправит. Но иногда когда возможность отправки восстанавливается нужно бы сразу отправить нокопившуюся почту.&lt;/p&gt;
]]></introtext>
<fulltext><![CDATA[
&lt;p style="text-align: justify;"&gt;Для этого нам поможет хитрая команда:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;postsuper -r ALL deferred&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Всё, теперь накопившаяся почта ушла получателям немедленно.&lt;/p&gt;]]></fulltext>
<state>1</state>
<created><![CDATA[2013-03-11 08:19:28]]></created>
<created_by_alias></created_by_alias>
<modified><![CDATA[2013-03-11 08:19:33]]></modified>
<publish_up><![CDATA[2013-03-11 08:19:28]]></publish_up>
<publish_down><![CDATA[0000-00-00 00:00:00]]></publish_down>
<images><![CDATA[{"image_intro":"","float_intro":"","image_intro_alt":"","image_intro_caption":"","image_fulltext":"","float_fulltext":"","image_fulltext_alt":"","image_fulltext_caption":""}]]></images>
<urls><![CDATA[{"urla":null,"urlatext":"","targeta":"","urlb":null,"urlbtext":"","targetb":"","urlc":null,"urlctext":"","targetc":""}]]></urls>
<attribs><![CDATA[{"show_title":"","link_titles":"","show_intro":"","show_category":"","link_category":"","show_parent_category":"","link_parent_category":"","show_author":"","link_author":"","show_create_date":"","show_modify_date":"","show_publish_date":"","show_item_navigation":"","show_icons":"","show_print_icon":"","show_email_icon":"","show_vote":"","show_hits":"","show_noauth":"","urls_position":"","alternative_readmore":"","article_layout":"","show_publishing_options":"","show_article_options":"","show_urls_images_backend":"","show_urls_images_frontend":""}]]></attribs>
<version>2</version>
<ordering>4</ordering>
<metakey></metakey>
<metadesc></metadesc>
<access>1</access>
<hits>310</hits>
<metadata><![CDATA[{"robots":"","author":"","rights":"","xreference":""}]]></metadata>
<language><![CDATA[*]]></language>
<xreference></xreference>
<catid><![CDATA[notes/admin]]></catid>
<created_by><![CDATA[root]]></created_by>
<modified_by><![CDATA[root]]></modified_by>
<featured>0</featured>
<rating_sum>0</rating_sum>
<rating_count>0</rating_count>
</content><content>
<id>64</id>
<title><![CDATA[Простой почтовый хостинг с хранилищем писем в БД MySQL. Часть 1. DBMail.]]></title>
<alias><![CDATA[mail-hosting-mysql-part1]]></alias>
<introtext><![CDATA[&lt;p style="text-align: justify;"&gt;Сразу начну с того, что данная конфигурация аж никак не претендует на професиональный хостинг почты с большим количеством пользователей. Зато сгодится на то, чтобы складировать на него системную почту сервера и забирать посредством &lt;em&gt;IMAP&lt;/em&gt; (хотя я лично бы не рекомендовал открывать порт &lt;em&gt;IMAP&lt;/em&gt; в инет, так как кто его знает) в локальной сети.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Первой частью есть установка &lt;strong&gt;DBMail&lt;/strong&gt; - программы, которая забирает почту и складирует её в базу данных. Данная операция виполняется на сервере с &lt;strong&gt;Gentoo Linux&lt;/strong&gt;, но инструкции, описанные здесь пойдут и на других дистрибутивах с незначительной адаптацией.&lt;/p&gt;
]]></introtext>
<fulltext><![CDATA[
&lt;p style="text-align: justify;"&gt;Для начала поставим нужные USE-флаги для пакетов. Так как нам надо хранить письма лишь в MySQL, то флаг &lt;strong&gt;sqlite&lt;/strong&gt; с пакета &lt;strong&gt;net-mail/dbmail&lt;/strong&gt; можем смело убирать. Для версии 3.0.2, я бы вообще всё убрал, но можно оставить &lt;strong&gt;ssl&lt;/strong&gt;, если будет желание настроить защищённые соединения с БД и MTA. Для пакета &lt;strong&gt;dev-db/libzdb&lt;/strong&gt; тоже можно оставить лишь &lt;strong&gt;mysql&lt;/strong&gt;, ну и &lt;strong&gt;ssl&lt;/strong&gt;, если очень надо. Остальное необязательно в рамках даной заметки, хотя если желаете запилить что-нибудь этакое, Вам никто не машает.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Итак после установки USE-флагов, устанавливаем &lt;strong&gt;dbmail&lt;/strong&gt;:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;# emerge -av dbmail&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Ждём, пока соберётся. Далее создаём на сервере MySQL базу данных, скажем с именем &lt;strong&gt;dbmail&lt;/strong&gt; (не оригинально, но всё же). Можно создать ей отдельного юзера, хотя необязательно, это лишь вопрос безопасности. В эту базу создаём таблицы для работы &lt;strong&gt;DBMail&lt;/strong&gt;. В комплекте есть sql-скрипт, который это всё может устроить, нужно просто скормить его консольному MySQL-клиенту.&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;$ bzcat /usr/share/doc/dbmail-3.0.2/sql/mysql/create_tables.mysql.bz2 | mysql -u&lt;em&gt;dbmail&lt;/em&gt; -p&lt;em&gt;пароль&lt;/em&gt; dbmail&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Напоминаю, что это для &lt;strong&gt;Gentoo&lt;/strong&gt;, в других дистрибутивов эти файлы могут лежать и в других местах, и даже могут быть не сжаты в &lt;em&gt;bzip2&lt;/em&gt;. Будьте бдительны.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Теперь создадим конфиг. За базу берём идущий в комплекте пример &lt;strong&gt;dbmail.conf.dist&lt;/strong&gt;:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;# cp /etc/dbmail/dbmail.conf{.dist,}&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Тоесть просто его копируем. Настраиваем под себя. Для нашего случая нужно изменить это.&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;[DBMAIL]&lt;br /&gt;driver = mysql&lt;br /&gt;authdriver = sql&lt;br /&gt;host = localhost&lt;br /&gt;sqlport = 3306&lt;br /&gt;sqlsocket = /var/run/mysqld/mysqld.sock&lt;br /&gt;user = &lt;em&gt;dbmail&lt;/em&gt;&lt;br /&gt;pass = &lt;em&gt;пароль&lt;/em&gt;&lt;br /&gt;db = dbmail&lt;br /&gt;table_prefix = dbmail_&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Я думаю тут и без комментариев ясно куда прописать свой логин и пароль к БД, а также имя самой БД и префикс таблиц в ней (последние 4 параметра). Можно подшаманить с параметрами &lt;em&gt;bindip&lt;/em&gt;, чтобы ограничить доступ, но для этого читаем ман и смотрим пример. Юзателям 64-битки нужно обратить внимание на параметр&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;library_directory = /usr/lib64/dbmail&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;который показывает где лежат модуля аутентификации и не всегда с коробки показывает правильно. Я написал путь который работает у меня, если у Вас не работает, проконсультируйтесь с &lt;strong&gt;equery&lt;/strong&gt; по поводу содержащихся в пакете файлов.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Так как файл содержит пароль к БД, не нужно чтобы все его видели, поэтому желательно сменить группу для этого файла на &lt;strong&gt;dbmail&lt;/strong&gt; и выставить права &lt;strong&gt;640&lt;/strong&gt;. Тогда файл будет видно только для &lt;em&gt;root&lt;/em&gt; и &lt;em&gt;dbmail&lt;/em&gt;.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Переходим к &lt;strong&gt;/etc/conf.d/dbmail&lt;/strong&gt;. Там есть хитрый массив со списком демонов, которые нужно запускать. Нам нужно лишь &lt;strong&gt;lmtpd&lt;/strong&gt; &lt;strong&gt;imapd&lt;/strong&gt;. Повторюсь: если хотите что-то ещё - не вопрос, экспериментируйте.&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;DAEMONS="lmtpd imapd"&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Далее просто запускаем его&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;# /etc/init.d/dbmail start&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;и если надо кидаем в автозапуск&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;# rc-update add dbmail default&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Если процессы &lt;strong&gt;dbmail&lt;/strong&gt; появились, значит всё хорошо (увы initscript не скажет, что что-то не работает, нужно на всякий случай проверть через &lt;em&gt;pgrep&lt;/em&gt;). В завершении настройки &lt;strong&gt;dbmail&lt;/strong&gt; нужно добавить пользователей, для которых можно будет доставлять почту.&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;$ dbmail-users -a user1 -w 12345 -p md5&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Данное действие создаст пользователя &lt;strong&gt;user1&lt;/strong&gt; с паролем &lt;strong&gt;12345&lt;/strong&gt; и поместит его в базу захешированным в &lt;strong&gt;md5&lt;/strong&gt;. А можно и такую вещь как &lt;strong&gt;whirlpool&lt;/strong&gt; заюзать. Запустите &lt;strong&gt;dbmail-users&lt;/strong&gt; без параметров, чтобы увидеть варанты хешей, а также прочие опции.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Также можно добавить каждому юзеру можно назначить один или несколько алиасов. Смысл алиаса в том, что почта напрвлена на адрес этого алиаса приходит указаному пользователю (очевидно).&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;$ dbmail-users -c user1 -s user1@ex.domain.com&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Добавляет алиас &lt;strong&gt;user1@ex.domain.com&lt;/strong&gt; к пользлователю &lt;strong&gt;user1&lt;/strong&gt;.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;На этом настройка &lt;strong&gt;dbmail&lt;/strong&gt; заканчиватеся. Далее нужно прикрутить к DBMail какой-нибудь MTA, &lt;a href="index.php?option=com_content&amp;amp;view=article&amp;amp;id=65:mail-hosting-mysql-part2&amp;amp;catid=11:admin&amp;amp;Itemid=105" target="_blank"&gt;например Postfix&lt;/a&gt;.&lt;/p&gt;]]></fulltext>
<state>1</state>
<created><![CDATA[2013-03-11 16:00:34]]></created>
<created_by_alias></created_by_alias>
<modified><![CDATA[2013-03-12 15:13:49]]></modified>
<publish_up><![CDATA[2013-03-12 15:13:49]]></publish_up>
<publish_down><![CDATA[0000-00-00 00:00:00]]></publish_down>
<images><![CDATA[{"image_intro":"","float_intro":"","image_intro_alt":"","image_intro_caption":"","image_fulltext":"","float_fulltext":"","image_fulltext_alt":"","image_fulltext_caption":""}]]></images>
<urls><![CDATA[{"urla":null,"urlatext":"","targeta":"","urlb":null,"urlbtext":"","targetb":"","urlc":null,"urlctext":"","targetc":""}]]></urls>
<attribs><![CDATA[{"show_title":"","link_titles":"","show_intro":"","show_category":"","link_category":"","show_parent_category":"","link_parent_category":"","show_author":"","link_author":"","show_create_date":"","show_modify_date":"","show_publish_date":"","show_item_navigation":"","show_icons":"","show_print_icon":"","show_email_icon":"","show_vote":"","show_hits":"","show_noauth":"","urls_position":"","alternative_readmore":"","article_layout":"","show_publishing_options":"","show_article_options":"","show_urls_images_backend":"","show_urls_images_frontend":""}]]></attribs>
<version>14</version>
<ordering>3</ordering>
<metakey></metakey>
<metadesc></metadesc>
<access>1</access>
<hits>406</hits>
<metadata><![CDATA[{"robots":"","author":"","rights":"","xreference":""}]]></metadata>
<language><![CDATA[*]]></language>
<xreference></xreference>
<catid><![CDATA[notes/admin]]></catid>
<created_by><![CDATA[root]]></created_by>
<modified_by><![CDATA[root]]></modified_by>
<featured>0</featured>
<rating_sum>0</rating_sum>
<rating_count>0</rating_count>
</content><content>
<id>65</id>
<title><![CDATA[Простой почтовый хостинг с хранилищем писем в БД MySQL. Часть 2. Прикрут к Postfix.]]></title>
<alias><![CDATA[mail-hosting-mysql-part2]]></alias>
<introtext><![CDATA[&lt;p style="text-align: justify;"&gt;&lt;a href="index.php?option=com_content&amp;amp;view=article&amp;amp;id=64:mail-hosting-mysql-part1&amp;amp;catid=11:admin&amp;amp;Itemid=105" target="_blank"&gt;Настроив dbmail&lt;/a&gt; нужно обеспечить доставку почты в его БД. Для этого нужно правильно сконфигурировать &lt;em&gt;MTA&lt;/em&gt;. Эта заметка о том как конфигурировать &lt;strong&gt;Postfix&lt;/strong&gt; для доставки почты в &lt;strong&gt;dbmail&lt;/strong&gt;. Прикручивается несложно, но нужно обязательно сначала установить &lt;strong&gt;Postfix&lt;/strong&gt;, а потом уже приступать к прикручиванию.&lt;/p&gt;
]]></introtext>
<fulltext><![CDATA[
&lt;p style="text-align: justify;"&gt;Для начала нужно указать &lt;strong&gt;Postfix&lt;/strong&gt;'у какие домены считать локальными, тоесть такими, для которых мы будем почту принимать. За это отвечает параметр &lt;strong&gt;mydestination&lt;/strong&gt; в конфиге &lt;strong&gt;/etc/postfix/main.cf&lt;/strong&gt;.&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;mydestination = $myhostname, localhost.$mydomain, localhost, $mydomain&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Тут указано что-то вроде базового значения. Этот список нужно дополнить обслуживаемыми доменами. К примеру&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;mydestination = $myhostname, localhost.$mydomain, localhost, $mydomain, adment.org.ua&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Вся почта, которая подпадает под эти критерии считается локальной и доставляется в &lt;strong&gt;mailbox&lt;/strong&gt;. Для возможности доставлять почту в &lt;strong&gt;dbmail&lt;/strong&gt; нужно соответствующий транспорт. Открываем файл &lt;strong&gt;/etc/postfix/master.cf&lt;/strong&gt; и добавляем в конец&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;dbmail-lmtpd&amp;nbsp;&amp;nbsp;&amp;nbsp; unix&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; -&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; -&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; n&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; -&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; -&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; lmtp&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Теперь почту можно доставлять как &lt;strong&gt;lmtp&lt;/strong&gt; и транспорт получил имя &lt;strong&gt;dbmail-lmtpd&lt;/strong&gt;. Перед тем как указывать нужный транспорт для &lt;strong&gt;mailbox&lt;/strong&gt; нужно обьявить новые списки получателей для &lt;strong&gt;Postfix&lt;/strong&gt;, тоесть нужно указать, что нужно доставлять почту именно тем юзерам, кто есть в БД &lt;strong&gt;dmail&lt;/strong&gt;.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Для этого нужно чтобы &lt;strong&gt;Postfix&lt;/strong&gt; был собран с поддержкой MySQL (чтобы был USE-флаг &lt;strong&gt;mysql&lt;/strong&gt;). Кстати говоря предположение что &lt;strong&gt;Postfix&lt;/strong&gt; должен быть собран с поддержкой базы, на которую посажен &lt;strong&gt;dbmail&lt;/strong&gt; вполне верное. Нужно создать два файла: &lt;strong&gt;/etc/postfix/dbmail-recipients.cf&lt;/strong&gt;&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;user = &lt;em&gt;dbmail&lt;/em&gt;&lt;br /&gt;password = &lt;em&gt;пароль&lt;/em&gt;&lt;br /&gt;hosts = localhost&lt;br /&gt;dbname = &lt;em&gt;dbmail&lt;/em&gt;&lt;br /&gt;table = dbmail_users&lt;br /&gt;select_field = userid&lt;br /&gt;where_field = userid&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;и &lt;strong&gt;/etc/postfix/dbmail-aliases.cf&lt;/strong&gt;&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;user = &lt;em&gt;dbmail&lt;/em&gt;&lt;br /&gt;password = &lt;em&gt;пароль&lt;/em&gt;&lt;br /&gt;hosts = localhost&lt;br /&gt;dbname = &lt;em&gt;dbmail&lt;/em&gt;&lt;br /&gt;table = dbmail_aliases&lt;br /&gt;select_field = alias&lt;br /&gt;where_field = alias&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Эти два файла кстати лучше все подряд не показывать, на Gentoo лучше установить для них группу &lt;strong&gt;postfix&lt;/strong&gt; и права &lt;strong&gt;640&lt;/strong&gt;, таким образом видеть єти конфиги будут только &lt;em&gt;root&lt;/em&gt; и &lt;em&gt;postfix&lt;/em&gt;. Указываем ссылки на эти файлы в параметре &lt;strong&gt;local_recipient_maps&lt;/strong&gt; конфига &lt;strong&gt;/etc/postfix/main.cf&lt;/strong&gt;&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;local_recipient_maps = mysql:/etc/postfix/dbmail-aliases.cf mysql:/etc/postfix/dbmail-recipients.cf $alias_maps&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Мы добавили &lt;strong&gt;$alias_maps&lt;/strong&gt;, чтобы оставить возможность прикручивать алиасы для системных аккаунтов в конфигах. Далее указываем правильный транспорт для &lt;strong&gt;mailbox&lt;/strong&gt;. Всё в том же конфиге /etc/postfix/main.cf правим параметр &lt;strong&gt;mailbox_transport&lt;/strong&gt;:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;mailbox_transport = dbmail-lmtpd:127.0.0.1:24&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Мы указали на раннее обьявленный транспорт &lt;strong&gt;dbmail-lmtpd&lt;/strong&gt;. Теперь остаётся правильно указать алиасы в системе, чтобы наш друг &lt;strong&gt;Postfix&lt;/strong&gt; ничего не напутал.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Далее неполохо бы сделать какую-нибудь &lt;a href="index.php?option=com_content&amp;amp;view=article&amp;amp;id=66:mail-hosting-mysql-part3&amp;amp;catid=11:admin&amp;amp;Itemid=105" rel="nofollow" target="_blank"&gt;Web-морду&lt;/a&gt;.&lt;/p&gt;]]></fulltext>
<state>1</state>
<created><![CDATA[2013-03-11 18:59:18]]></created>
<created_by_alias></created_by_alias>
<modified><![CDATA[2013-03-12 15:15:00]]></modified>
<publish_up><![CDATA[2013-03-12 15:15:00]]></publish_up>
<publish_down><![CDATA[0000-00-00 00:00:00]]></publish_down>
<images><![CDATA[{"image_intro":"","float_intro":"","image_intro_alt":"","image_intro_caption":"","image_fulltext":"","float_fulltext":"","image_fulltext_alt":"","image_fulltext_caption":""}]]></images>
<urls><![CDATA[{"urla":null,"urlatext":"","targeta":"","urlb":null,"urlbtext":"","targetb":"","urlc":null,"urlctext":"","targetc":""}]]></urls>
<attribs><![CDATA[{"show_title":"","link_titles":"","show_intro":"","show_category":"","link_category":"","show_parent_category":"","link_parent_category":"","show_author":"","link_author":"","show_create_date":"","show_modify_date":"","show_publish_date":"","show_item_navigation":"","show_icons":"","show_print_icon":"","show_email_icon":"","show_vote":"","show_hits":"","show_noauth":"","urls_position":"","alternative_readmore":"","article_layout":"","show_publishing_options":"","show_article_options":"","show_urls_images_backend":"","show_urls_images_frontend":""}]]></attribs>
<version>9</version>
<ordering>2</ordering>
<metakey></metakey>
<metadesc></metadesc>
<access>1</access>
<hits>305</hits>
<metadata><![CDATA[{"robots":"","author":"","rights":"","xreference":""}]]></metadata>
<language><![CDATA[*]]></language>
<xreference></xreference>
<catid><![CDATA[notes/admin]]></catid>
<created_by><![CDATA[root]]></created_by>
<modified_by><![CDATA[root]]></modified_by>
<featured>0</featured>
<rating_sum>0</rating_sum>
<rating_count>0</rating_count>
</content><content>
<id>66</id>
<title><![CDATA[Простой почтовый хостинг с хранилищем писем в БД MySQL. Часть 3. Roundcube webmail.]]></title>
<alias><![CDATA[mail-hosting-mysql-part3]]></alias>
<introtext><![CDATA[&lt;p style="text-align: justify;"&gt;Когда уже &lt;a href="index.php?option=com_content&amp;amp;view=article&amp;amp;id=65:mail-hosting-mysql-part2&amp;amp;catid=11:admin&amp;amp;Itemid=105" rel="nofollow" target="_blank"&gt;&lt;strong&gt;Postfix&lt;/strong&gt; передаёт почту на &lt;strong&gt;dbmail&lt;/strong&gt;&lt;/a&gt;, можна наслаждаться работой. Всё просто коннектимся почтовиком типа &lt;strong&gt;Thunderbird&lt;/strong&gt; или &lt;strong&gt;KMail&lt;/strong&gt; и может почту читать и отравлять. Но это не всегда удобно, ведь каждый знает, что почтовые хостинги предовтавляют доступ к WEB-интерфейсу почты. Что ж у нас такого пока нету, но мы можем это устроить.&lt;/p&gt;
]]></introtext>
<fulltext><![CDATA[
&lt;p style="text-align: justify;"&gt;В этом нам поможет &lt;a href="http://roundcube.net/" rel="nofollow" target="_blank"&gt;Roundcube&lt;/a&gt; - почтовый клиент, написанный на PHP. Это почти такой же клиент как и тот &lt;strong&gt;Thenderbird&lt;/strong&gt;, только он есть WEB-приложение и работает на сервере. Мы заходим в браузер и просто юзаем. Тут рассматриваем версию 0.8.5.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Итак нам потребуется создать БД и для него. Он умеет использовать &lt;em&gt;MySQL&lt;/em&gt;, &lt;em&gt;PostgreSQL&lt;/em&gt;, &lt;em&gt;SQLite&lt;/em&gt;, нужно только соответствующий модуль для PHP собрать. Мы будем использовать всё тот же MySQL, так как dbmail ставили на него, только создаём &lt;span style="text-decoration: underline;"&gt;отдельную базу&lt;/span&gt; и &lt;span style="text-decoration: underline;"&gt;отдельного пользователя&lt;/span&gt;.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Итак заходим на сайт и скачиваем свежую стабильну версию. Распаковываем её в каталог, доступный для обозревания WEB-сервером. Для начала пройдём по ссылке в папку installer. У меня например так:&lt;/p&gt;&lt;pre style="text-align: justify;"&gt;http://localhost/roundcube/installer/&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Следуем инструкциям установщика. Если права доступа позволят инсталлер сам запишет конфиги в нужную папку. В противном случае нужно это делать вручную. конфиги кладутся в подпапку &lt;strong&gt;config&lt;/strong&gt; в каталоге самого &lt;strong&gt;roundcube&lt;/strong&gt;. Теперь в конфиге &lt;strong&gt;main.inc.php&lt;/strong&gt; ищем параметр &lt;strong&gt;$rcmail_config['imap_auth_type']&lt;/strong&gt; и выставляем&lt;/p&gt;&lt;pre style="text-align: justify;"&gt;$rcmail_config['imap_auth_type'] = 'LOGIN';&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Это позолит аутентифицироваться на &lt;strong&gt;DBMail&lt;/strong&gt;. Если оставить &lt;strong&gt;null&lt;/strong&gt;, то оно пытается использовать &lt;strong&gt;CRAM-MD5&lt;/strong&gt; для аутентификации, а это требует от &lt;strong&gt;DBMail&lt;/strong&gt; не шифрованых паролей пользователей, что небезовасно. Так как у нас всё равно линк локальный, то опасность прослушать сеть отсутсвует.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Так как конфиг &lt;strong&gt;db.inc.php&lt;/strong&gt; содержит пароль к БД roubdcube, желательно скрыть его от посторонних. Главное обеспечить читабельность для этого файла тому юзеру, который выполняет скрипты.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;В завершение нужно удалить подпапку &lt;strong&gt;installer&lt;/strong&gt; с каталога &lt;strong&gt;roundcube&lt;/strong&gt;, во избежание.&lt;/p&gt;]]></fulltext>
<state>1</state>
<created><![CDATA[2013-03-11 20:54:02]]></created>
<created_by_alias></created_by_alias>
<modified><![CDATA[2013-03-12 15:16:03]]></modified>
<publish_up><![CDATA[2013-03-12 15:16:03]]></publish_up>
<publish_down><![CDATA[0000-00-00 00:00:00]]></publish_down>
<images><![CDATA[{"image_intro":"","float_intro":"","image_intro_alt":"","image_intro_caption":"","image_fulltext":"","float_fulltext":"","image_fulltext_alt":"","image_fulltext_caption":""}]]></images>
<urls><![CDATA[{"urla":null,"urlatext":"","targeta":"","urlb":null,"urlbtext":"","targetb":"","urlc":null,"urlctext":"","targetc":""}]]></urls>
<attribs><![CDATA[{"show_title":"","link_titles":"","show_intro":"","show_category":"","link_category":"","show_parent_category":"","link_parent_category":"","show_author":"","link_author":"","show_create_date":"","show_modify_date":"","show_publish_date":"","show_item_navigation":"","show_icons":"","show_print_icon":"","show_email_icon":"","show_vote":"","show_hits":"","show_noauth":"","urls_position":"","alternative_readmore":"","article_layout":"","show_publishing_options":"","show_article_options":"","show_urls_images_backend":"","show_urls_images_frontend":""}]]></attribs>
<version>8</version>
<ordering>1</ordering>
<metakey></metakey>
<metadesc></metadesc>
<access>1</access>
<hits>301</hits>
<metadata><![CDATA[{"robots":"","author":"","rights":"","xreference":""}]]></metadata>
<language><![CDATA[*]]></language>
<xreference></xreference>
<catid><![CDATA[notes/admin]]></catid>
<created_by><![CDATA[root]]></created_by>
<modified_by><![CDATA[root]]></modified_by>
<featured>0</featured>
<rating_sum>0</rating_sum>
<rating_count>0</rating_count>
</content><content>
<id>67</id>
<title><![CDATA[Перманентное удаление почты с DBMail]]></title>
<alias><![CDATA[dbmail-permanent-clean]]></alias>
<introtext><![CDATA[&lt;p style="text-align: justify;"&gt;При работе с &lt;strong&gt;DBMail&lt;/strong&gt; есть одна особенность. Если удалить сообщение через &lt;em&gt;IMAP&lt;/em&gt;, то на самом деле оно не удаляется, в а просто помечается как удалённое. Это вскоре может самую малость захламить БД. Поэтому в случае сильной захламлености БД нужно проводить очистку.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Очистку можно осуществить с консоли командой&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;$ dbmail-util -dpy&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Это пометит удалённые через &lt;em&gt;IMAP&lt;/em&gt; сообщения как готовые к удалению, а готовые к удалению - удалит. Команду лучше выполнить дважды - на всякий пожарный.&lt;/p&gt;]]></introtext>
<fulltext></fulltext>
<state>0</state>
<created><![CDATA[2013-03-11 22:55:42]]></created>
<created_by_alias></created_by_alias>
<modified><![CDATA[2013-03-11 22:55:58]]></modified>
<publish_up><![CDATA[0000-00-00 00:00:00]]></publish_up>
<publish_down><![CDATA[0000-00-00 00:00:00]]></publish_down>
<images><![CDATA[{"image_intro":"","float_intro":"","image_intro_alt":"","image_intro_caption":"","image_fulltext":"","float_fulltext":"","image_fulltext_alt":"","image_fulltext_caption":""}]]></images>
<urls><![CDATA[{"urla":null,"urlatext":"","targeta":"","urlb":null,"urlbtext":"","targetb":"","urlc":null,"urlctext":"","targetc":""}]]></urls>
<attribs><![CDATA[{"show_title":"","link_titles":"","show_intro":"","show_category":"","link_category":"","show_parent_category":"","link_parent_category":"","show_author":"","link_author":"","show_create_date":"","show_modify_date":"","show_publish_date":"","show_item_navigation":"","show_icons":"","show_print_icon":"","show_email_icon":"","show_vote":"","show_hits":"","show_noauth":"","urls_position":"","alternative_readmore":"","article_layout":"","show_publishing_options":"","show_article_options":"","show_urls_images_backend":"","show_urls_images_frontend":""}]]></attribs>
<version>3</version>
<ordering>0</ordering>
<metakey></metakey>
<metadesc></metadesc>
<access>1</access>
<hits>0</hits>
<metadata><![CDATA[{"robots":"","author":"","rights":"","xreference":""}]]></metadata>
<language><![CDATA[*]]></language>
<xreference></xreference>
<catid><![CDATA[notes/admin]]></catid>
<created_by><![CDATA[root]]></created_by>
<modified_by><![CDATA[root]]></modified_by>
<featured>0</featured>
<rating_sum>0</rating_sum>
<rating_count>0</rating_count>
</content><category>
<id>16</id>
<path><![CDATA[notes/internet]]></path>
<extension><![CDATA[com_content]]></extension>
<title><![CDATA[Интернеты]]></title>
<alias><![CDATA[internet]]></alias>
<note></note>
<description></description>
<published>1</published>
<access>1</access>
<params><![CDATA[{"category_layout":"","image":""}]]></params>
<metadesc></metadesc>
<metakey></metakey>
<metadata><![CDATA[{"author":"","robots":""}]]></metadata>
<created_time><![CDATA[2012-03-16 06:25:04]]></created_time>
<modified_time><![CDATA[2012-03-16 06:25:13]]></modified_time>
<hits>0</hits>
<language><![CDATA[*]]></language>
<created_user_id><![CDATA[root]]></created_user_id>
<modified_user_id><![CDATA[root]]></modified_user_id>
</category><content>
<id>14</id>
<title><![CDATA[Скачивание сайта через wget]]></title>
<alias><![CDATA[wget-mirror]]></alias>
<introtext><![CDATA[&lt;p style="text-align: justify;"&gt;Программа wget предназначена для того, чтобы без вашего особого участия скачивать большие количества файлов из интернета. Внизу предложены два варианта ее использования на данном сайте (хотя существуют еще десятки других): с помощью первого можно выкачать весь сайт; и с помощью второго можно выкачать избранную книгу из библиотеки. В последнем случае, укажите страницу оглавления выбранной вами книги. Выполнять эту команду надо из каталога на вашем компьютере, в который вы хотите выкачать сайт. По оканчании в файле wget.log будет находится информация о том, какие страницы были закачены, и какие ошибки возникли в процессе. Если эти варианты выкачки вас по каким-либо причинам не устраивают, то прочтите описание флагов и попробуйте самостоятельно придумать, как настроить работу этой программы под вашу задачу (предпочтительно) или пишите - разберемся вместе.&lt;/p&gt;
]]></introtext>
<fulltext><![CDATA[
&lt;p style="text-align: justify;"&gt;Для того, чтобы полностью скачать сайт, используйте следующую команду (здесь и далее, сайт будет скачан в каталог, из которого программа была запущена):&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;wget -c -p -r -l0 -np -N -k -nv &lt;a href="http://tm-sidhi.narod.ru/tm/index.html" rel="nofollow"&gt;http://tm-sidhi.narod.ru/tm/index.html&lt;/a&gt; 2&amp;gt;wget.log&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Если нужно скачать не весь сайт, а только какую-то его часть (в данном случае книгу "Дао Пуха"), то используйте такую команду:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;wget -c -p -r -l1 -np -N -k -nv &lt;a href="http://tm-sidhi.narod.ru/tm/library/pooh/index.html" rel="nofollow"&gt;http://tm-sidhi.narod.ru/tm/library/pooh/index.html&lt;/a&gt; 2&amp;gt;wget.log&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Если вы работаете с интернетом через прокси сервер или через FireWall, то к списку указанных опций (перед адресом страницы) надо добавить еще и такие:&lt;/p&gt;
&lt;pre style="text-align: justify;"&gt;--proxy-user=xxx --proxy-passwd=yyy --execute="http_proxy=server:port"&lt;/pre&gt;
&lt;p style="text-align: justify;"&gt;Где ххх - это логин (если нужен)&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;yyy - это пароль для данного логина (если нужен)&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;server - имя прокси сервера или FireWall-а (узнать у администратора)&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;port - порт, через который работает прокси сервер или FireWall (узнать у администратора)&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Страницы сайта будут выкачены с банерами. Если вы хотите от них избавиться, то из выкаченных файлов надо удалить все что стоит до строки "&amp;lt;!-- Начало страницы tm-sidhi.narod.ru --&amp;gt;" и все, что стоит после строки "&amp;lt;!-- Конец страницы tm-sidhi.narod.ru --&amp;gt;". Процесс удаления может быть автоматизирован (если вам позволяет это сделать ваш опыт), и здесь не рассматривается.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Информация для любознательных:&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;-c &amp;nbsp; &amp;nbsp; Дополучать частично полученные файлы (если был обрыв связи во время предудущей закачки).&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;-p&lt;span style="font-size: 12px; text-align: justify;"&gt;&amp;nbsp;&amp;nbsp; &amp;nbsp;&lt;/span&gt;Получить картинки, звуки и другие объекты для выкаченных страниц.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;-r&lt;span style="font-size: 12px; text-align: justify;"&gt;&amp;nbsp;&amp;nbsp; &amp;nbsp;&lt;/span&gt;Получать также страницы, на которые ссылаются выкаченные страницы (начиная от указанной).&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;-l0&lt;span style="font-size: 12px; text-align: justify;"&gt;&amp;nbsp;&amp;nbsp; &amp;nbsp;&lt;/span&gt;Получать все страницы в приделах сайта (при условии, что их можно получить идя по линкам начиная от указанной страницы).&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;-l1&lt;span style="font-size: 12px; text-align: justify;"&gt;&amp;nbsp;&amp;nbsp; &amp;nbsp;&lt;/span&gt;Получать только те и только те страницы, на которые ссылается указанная страница (указанная страница получается всегда).&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;-l2&lt;span style="font-size: 12px; text-align: justify;"&gt;&amp;nbsp;&amp;nbsp; &amp;nbsp;&lt;/span&gt;Получать только те, на которые ссылается указанная страница и страницы, на которые ссылаются эти страницы.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;-l3&lt;span style="font-size: 12px; text-align: justify;"&gt;&amp;nbsp;&amp;nbsp; &amp;nbsp;&lt;/span&gt;Получать страницы на 3 уровня вглубь и т.п.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;-np&lt;span style="font-size: 12px; text-align: justify;"&gt;&amp;nbsp;&amp;nbsp; &amp;nbsp;&lt;/span&gt;Фильтр. Получать только те файлы, которые находятся в каталоге первой страницы и его подкаталогах. Из-за этого флага будут закачены не все картинки, но если его убрать, то придется скачивать сразу весь сайт.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;-N&lt;span style="font-size: 12px; text-align: justify;"&gt;&amp;nbsp;&amp;nbsp; &amp;nbsp;&lt;/span&gt;Получать файлы только, если они позднее датой, чем уже имеющиеся. С помощью этого флага можно обновлять вашу локальную версию сайта. Выкачиваться будут только изменения с момента последней закачки (даже, если изменился только дизайн).&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;-k&lt;span style="font-size: 12px; text-align: justify;"&gt;&amp;nbsp;&amp;nbsp; &amp;nbsp;&lt;/span&gt;Сделать все абсолютные пути относительными (с помощью каталога ".." (перейти на уровень выше). Иначе будет нельзя воспользоваться меню внизу страницы.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;-nvВ&lt;span style="font-size: 12px; text-align: justify;"&gt;&amp;nbsp;&amp;nbsp; &amp;nbsp;&lt;/span&gt;журнал пишется краткая информация об обработанных страницах.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;-h&lt;span style="font-size: 12px; text-align: justify;"&gt;&amp;nbsp;&amp;nbsp; &amp;nbsp;&lt;/span&gt;Выдать список всех флагов с объяснением их назначения (пример сохранения в файл help.txt ==&amp;gt; wget -h &amp;gt;help.txt)&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Источник информации:&amp;nbsp;&lt;a href="http://tm-sidhi.narod.ru/tm/library/tech/wget.html" rel="nofollow" target="_blank"&gt;http://tm-sidhi.narod.ru/&lt;/a&gt;.&lt;/p&gt;]]></fulltext>
<state>1</state>
<created><![CDATA[2012-03-16 06:30:37]]></created>
<created_by_alias></created_by_alias>
<modified><![CDATA[2013-03-08 16:31:56]]></modified>
<publish_up><![CDATA[2012-03-16 06:30:37]]></publish_up>
<publish_down><![CDATA[0000-00-00 00:00:00]]></publish_down>
<images><![CDATA[{"image_intro":"","float_intro":"","image_intro_alt":"","image_intro_caption":"","image_fulltext":"","float_fulltext":"","image_fulltext_alt":"","image_fulltext_caption":""}]]></images>
<urls><![CDATA[{"urla":null,"urlatext":"","targeta":"","urlb":null,"urlbtext":"","targetb":"","urlc":null,"urlctext":"","targetc":""}]]></urls>
<attribs><![CDATA[{"show_title":"","link_titles":"","show_intro":"","show_category":"","link_category":"","show_parent_category":"","link_parent_category":"","show_author":"","link_author":"","show_create_date":"","show_modify_date":"","show_publish_date":"","show_item_navigation":"","show_icons":"","show_print_icon":"","show_email_icon":"","show_vote":"","show_hits":"","show_noauth":"","urls_position":"","alternative_readmore":"","article_layout":"","show_publishing_options":"","show_article_options":"","show_urls_images_backend":"","show_urls_images_frontend":""}]]></attribs>
<version>4</version>
<ordering>1</ordering>
<metakey></metakey>
<metadesc></metadesc>
<access>1</access>
<hits>2762</hits>
<metadata><![CDATA[{"robots":"","author":"","rights":"","xreference":""}]]></metadata>
<language><![CDATA[*]]></language>
<xreference></xreference>
<catid><![CDATA[notes/internet]]></catid>
<created_by><![CDATA[root]]></created_by>
<modified_by><![CDATA[root]]></modified_by>
<featured>0</featured>
<rating_sum>0</rating_sum>
<rating_count>0</rating_count>
</content><content>
<id>45</id>
<title><![CDATA[Корректное сохранение кода счётчика в Joomla]]></title>
<alias><![CDATA[joomla-counters]]></alias>
<introtext><![CDATA[&lt;p style="text-align: justify;"&gt;Создав какой-нибудь сайт чуть чаще чем всегда интересно как часто его посещают. Плюс к тому хочется, чтобы сайт где-то светился и участвовал в рейтингах. Для этого можно регистрировать сайт в каталоги, где выдают код счетчика посещений, который нужно разместить на всех страницах сайта, чтобы корректно вычислялась посещаемость и считался рейтинг.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;В Joomla очень просто. Нужно создать модуль с типом Cusom HTML и списать код счётчика туда. Но тут нужно быть внимательным, так как встроенный визуальный редактор может немного исказить код. Поэтому рекомендуется его отключать. Для этого прямо в режиме редактирования над редактором есть ссылка "[Toggle Editor]" или "[show/hide]". Но если отключение редактора не помогает, то стоить почитать эту заметку дальше.&lt;/p&gt;
]]></introtext>
<fulltext><![CDATA[
&lt;p style="text-align: justify;"&gt;В Joomla есть такая нехитрая штука как фильтр текста. Придумана она для того, чтобы можно было безопасно разделять сайт с другими пользователями и не боятся, что они будуть поубликовать на нём то, что не положено. Это может быть элементарый JavaScript, который кстати и есть базой для большинства счётчиков посещений. Так вот включённый фильтр может немного портить код. Для корректного сохранения счетчиков нужно его отключать. Для этого на админке заходим &lt;strong&gt;Site &amp;gt; Global Configuration &amp;gt; Text Filters&lt;/strong&gt;. Выбираем свою группу и ставим &lt;strong&gt;No Filtering&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img style="display: block; margin-left: auto; margin-right: auto;" src="images/pub/joomla-counters/config.jpg" alt="config" width="597" height="552" /&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Не рекомендуется ставить это для всех. Это нужно лишь для себя любимого админа, члена группы &lt;strong&gt;Super Users&lt;/strong&gt;. Кстати для этой группы из коробки фильтрация отключена. Включится она внезапно может лишь тогда, когда Вы делаете апгрейд от версии не поддерживающей этой штуки. Тогда приходится ставить всём дефолтное значение.&lt;/p&gt;]]></fulltext>
<state>1</state>
<created><![CDATA[2012-07-08 21:55:08]]></created>
<created_by_alias></created_by_alias>
<modified><![CDATA[2012-07-08 21:55:24]]></modified>
<publish_up><![CDATA[2012-07-08 21:55:24]]></publish_up>
<publish_down><![CDATA[0000-00-00 00:00:00]]></publish_down>
<images><![CDATA[{"image_intro":"","float_intro":"","image_intro_alt":"","image_intro_caption":"","image_fulltext":"","float_fulltext":"","image_fulltext_alt":"","image_fulltext_caption":""}]]></images>
<urls><![CDATA[{"urla":null,"urlatext":"","targeta":"","urlb":null,"urlbtext":"","targetb":"","urlc":null,"urlctext":"","targetc":""}]]></urls>
<attribs><![CDATA[{"show_title":"","link_titles":"","show_intro":"","show_category":"","link_category":"","show_parent_category":"","link_parent_category":"","show_author":"","link_author":"","show_create_date":"","show_modify_date":"","show_publish_date":"","show_item_navigation":"","show_icons":"","show_print_icon":"","show_email_icon":"","show_vote":"","show_hits":"","show_noauth":"","urls_position":"","alternative_readmore":"","article_layout":"","show_publishing_options":"","show_article_options":"","show_urls_images_backend":"","show_urls_images_frontend":""}]]></attribs>
<version>3</version>
<ordering>0</ordering>
<metakey></metakey>
<metadesc></metadesc>
<access>1</access>
<hits>302</hits>
<metadata><![CDATA[{"robots":"","author":"","rights":"","xreference":""}]]></metadata>
<language><![CDATA[*]]></language>
<xreference></xreference>
<catid><![CDATA[notes/internet]]></catid>
<created_by><![CDATA[root]]></created_by>
<modified_by><![CDATA[root]]></modified_by>
<featured>0</featured>
<rating_sum>0</rating_sum>
<rating_count>0</rating_count>
</content><category>
<id>18</id>
<path><![CDATA[notes/hardware]]></path>
<extension><![CDATA[com_content]]></extension>
<title><![CDATA[Железо]]></title>
<alias><![CDATA[hardware]]></alias>
<note></note>
<description></description>
<published>1</published>
<access>1</access>
<params><![CDATA[{"category_layout":"","image":""}]]></params>
<metadesc></metadesc>
<metakey></metakey>
<metadata><![CDATA[{"author":"","robots":""}]]></metadata>
<created_time><![CDATA[2012-05-23 17:20:38]]></created_time>
<modified_time><![CDATA[0000-00-00 00:00:00]]></modified_time>
<hits>0</hits>
<language><![CDATA[*]]></language>
<created_user_id><![CDATA[root]]></created_user_id>
</category><content>
<id>35</id>
<title><![CDATA[Отвалилась клавиша на ноутбуке]]></title>
<alias><![CDATA[nb-kbd]]></alias>
<introtext><![CDATA[&lt;p style="text-align: justify;"&gt;Чтобы сказать часто, то нельзя. Но бывает такое: отваливается кнопка на клавиатуре ноутбука. Не важно почему - можно и случайно зацепить при разборке, может и просто так (бывали случаи). Выглядит довольно таки забавно.&lt;/p&gt;
&lt;p&gt;&lt;img style="display: block; margin-left: auto; margin-right: auto;" src="images/pub/nb-kbd/pic1.jpg" alt="pic1" width="610" height="320" /&gt;&lt;/p&gt;
]]></introtext>
<fulltext><![CDATA[
&lt;p style="text-align: justify;"&gt;При этом вернуть её на место простым крепким нажатием не получается (ну а если получилось - слава верховному админу). Тогда приходится говорить о таких вещах как вывих кнопки. Стёб конечно, но очень похоже на вывих. В таком случае нам поможет острая игла. Конечно не обязательно, можно использовать что-то похожее.&lt;/p&gt;
&lt;p&gt;&lt;img style="display: block; margin-left: auto; margin-right: auto;" src="images/pub/nb-kbd/tool.jpg" alt="tool" width="300" height="282" /&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Итак при помощи выбранного инстумента акуратно выковыриваем кнопку из клавы. Смотреть нужно в приподнятую часть - там видно будет. Когда выковыряем, увидим что-то похожее на это.&lt;/p&gt;
&lt;p&gt;&lt;img style="display: block; margin-left: auto; margin-right: auto;" src="images/pub/nb-kbd/pic2.jpg" alt="pic2" width="300" height="282" /&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Тут колодки 1 не на своём месте. Геометрически они должны быть немного ниже и нам видны лишь частично. Так вправить их скорее всего не получится и надо делать "операцию". Для начала нужно немонтировать эту часть кнопки. Рекомендую начать в петель 2. Работаем при помощи инстумента. Освободив петли, винимаем полностью. Когда разберём кнопку - получим две составные части.&lt;/p&gt;
&lt;p&gt;&lt;img style="display: block; margin-left: auto; margin-right: auto;" src="images/pub/nb-kbd/pic3.jpg" alt="pic3" width="500" height="337" /&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Если внимательно посмотреть в торцы 1, то там увидим отверстия, в которые нужно вставить колодки 2. Нужно вставлять внимательно ибо придётся повторять. Получим что-то вроде.&lt;/p&gt;
&lt;p&gt;&lt;img style="display: block; margin-left: auto; margin-right: auto;" src="images/pub/nb-kbd/pic4.jpg" alt="pic4" width="600" height="279" /&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Тут нужно не спутать где верх ибо надеть это дело на место будет тредновато. Гарантировать, что на всех ноутах так же, как на этом скрине гарантировать не могу - не видел аж сколько. Возможно придётся попробовать разные варианты. Теперь нужно прикрепить это к клаве, юзая петли 1 и 2.&lt;/p&gt;
&lt;p&gt;&lt;img style="display: block; margin-left: auto; margin-right: auto;" src="images/pub/nb-kbd/pic5.jpg" alt="pic5" width="300" height="290" /&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Думаю тут ясно, что 1 нужно одевать на 1, а 2 на 2. Только начинать рекомендовал бы с 2, так точно будет легче и безопаснее. Когда закрепим эту часть на клаве, получим такую картину.&lt;/p&gt;
&lt;p&gt;&lt;img style="display: block; margin-left: auto; margin-right: auto;" src="images/pub/nb-kbd/pic6.jpg" alt="pic6" width="300" height="291" /&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;На этой форографии я показал уже и целевую клавишу, которую нужно будет закрепить (она сверху). Кнопку рекомендую цеплять петлями 4 за колодки 2 движением снизу вверх. Тогда петли 3 оденутся на колодки 1 простым нажатием. Вот когда всё готово - мы получаем желаемый результат.&lt;/p&gt;
&lt;p&gt;&lt;img style="display: block; margin-left: auto; margin-right: auto;" src="images/pub/nb-kbd/pic7.jpg" alt="pic7" width="300" height="291" /&gt;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Буду надеятся, что следуя этим инструкциям вы ни одной клавиши не поломаете. Взываю только к одному - проявите благоразумие по поводу прикладываемой силы.&lt;/p&gt;]]></fulltext>
<state>1</state>
<created><![CDATA[2012-05-23 17:46:58]]></created>
<created_by_alias></created_by_alias>
<modified><![CDATA[2012-05-23 17:50:08]]></modified>
<publish_up><![CDATA[2012-05-23 17:46:58]]></publish_up>
<publish_down><![CDATA[0000-00-00 00:00:00]]></publish_down>
<images><![CDATA[{"image_intro":"","float_intro":"","image_intro_alt":"","image_intro_caption":"","image_fulltext":"","float_fulltext":"","image_fulltext_alt":"","image_fulltext_caption":""}]]></images>
<urls><![CDATA[{"urla":null,"urlatext":"","targeta":"","urlb":null,"urlbtext":"","targetb":"","urlc":null,"urlctext":"","targetc":""}]]></urls>
<attribs><![CDATA[{"show_title":"","link_titles":"","show_intro":"","show_category":"","link_category":"","show_parent_category":"","link_parent_category":"","show_author":"","link_author":"","show_create_date":"","show_modify_date":"","show_publish_date":"","show_item_navigation":"","show_icons":"","show_print_icon":"","show_email_icon":"","show_vote":"","show_hits":"","show_noauth":"","urls_position":"","alternative_readmore":"","article_layout":"","show_publishing_options":"","show_article_options":"","show_urls_images_backend":"","show_urls_images_frontend":""}]]></attribs>
<version>4</version>
<ordering>1</ordering>
<metakey><![CDATA[ноутбук, клавиатура, ремонт кнопок, ремонт клавиш, ремонт клавиатуры]]></metakey>
<metadesc></metadesc>
<access>1</access>
<hits>5061</hits>
<metadata><![CDATA[{"robots":"","author":"","rights":"","xreference":""}]]></metadata>
<language><![CDATA[*]]></language>
<xreference></xreference>
<catid><![CDATA[notes/hardware]]></catid>
<created_by><![CDATA[root]]></created_by>
<modified_by><![CDATA[root]]></modified_by>
<featured>0</featured>
<rating_sum>0</rating_sum>
<rating_count>0</rating_count>
</content><content>
<id>59</id>
<title><![CDATA[Введение в эксплуатацию новой аккумуляторной батареи в UPS]]></title>
<alias><![CDATA[ups-battery-initialization]]></alias>
<introtext><![CDATA[&lt;p style="text-align: justify;"&gt;&lt;strong&gt;Источник бесперебойного питания&lt;/strong&gt; (ИБП, англ. UPS - Uninterruptible Power Supply) - это очень хорошая штука, которая всегда (ну или почти всегда) защтит Ваш комп от перебоев электропитания. Принцип работы прост: есть аккумулятор, который заряжается от сети и когда питание пропадает, он питает нагрузку энергией этого самого аккумулятора. Но что Вас точно ожидает даже когда сам UPS не загибается - это износ и выход из строя аккумуляторной батареи. В этом случае вы сделаете самое логичное - замените её.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Тут приведу пару моментов, которые нужно бы учесть, чтобы сделать это корректно. Речь пойдёт о свницово-кислотных аккумуляторах, о тех которыми мы часто и пользуемся в этих самых ИБП.&lt;/p&gt;
]]></introtext>
<fulltext><![CDATA[
&lt;h2 style="text-align: justify;"&gt;Момент 1. Извлечение старой батареи&lt;/h2&gt;
&lt;p style="text-align: justify;"&gt;Перед извлечением старой батареи удостоверьтесь, что нагрузка отключена и сам ИБП выключен. Для извлечение батареи может понадобиться разобрать сам ИБП, но этого не стоит пугаться, так как для этого нужна лишь отвёртка. В этом процессе лучше не прикасаться голой рукой к металлическим частям (в том числе и клемам), от груха подальше. Если при отсоединении батареи проскакивает искра - ничего страшного, если в воздухе нет легковоспламиняющихся газов. Нужно учитывать, что старая изношенная батарея может иметь повреждения на корпусе, поэтому нужно быть внимательным, чтобы не облить себя электролитом.&lt;/p&gt;
&lt;h2 style="text-align: justify;"&gt;Момент 2. Установка новой батареи&lt;/h2&gt;
&lt;p style="text-align: justify;"&gt;Установить новую очень просто, если предварительно извлечь старую. Логика подскажет как её установить обратно. Если нет, то читаем инструкцию или гуглим. Единого рецепта под всё UPS нету. При подключении батареи в UPS между клемами проскакивает искра, что значить в батареи есть начальный заряд. Всё нормально. Нужно включить бесперебойник, чтобы он её определил и сообщил, что всё норм (если он на Вас яростно не пищит, то всё нормально).&lt;/p&gt;
&lt;h2 style="text-align: justify;"&gt;Момент 3. Начальный цикл заряда-розряда&lt;/h2&gt;
&lt;p style="text-align: justify;"&gt;Теперь нужно зарядить батарею. Оставляем ИБП включённым, втыкаем его в сеть электропитания и уходим куда-то часов на 12 (может быть и больше), пока она полностью не зарядится. Если в ИБП есть порт для связи с копом или индикатор заряда можно сверятся с ним, но не стоит ему слишком доверять. Короче держим не менее 12 часов.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Когда зарядка завершится, подключаем к ИБП нагрузку (желательно статическую, чтобы потребляемая мощность не прыгала). Потреблять она должна гдето в районе 30% от мощности ИБП. Отключаем от сети электропитания и разряжаем пока не потухнет. Можно замерять время, чтобы прикинуть сколько держится заряд. За вермя разряда он может изрядно "выпищать" все уши, поэтому если на нём можно выключить звук, то лучше так и сделайте (но только не путём подключения к сети).&lt;/p&gt;
&lt;h2 style="text-align: justify;"&gt;Момент 4. Контрольный цикл заряда-разряда&lt;/h2&gt;
&lt;p style="text-align: justify;"&gt;Снова ставим на зарядку часов на 12. Заряжаем как и в предыдущем случае. Когда зарядится, снова разряжем той же нагрузкой. Если замеряете время можете заметить, что разрядилась батарея немного быстрее. Это ИБП откалибровался по батарею и выставил границы заряда и разряда. Также можно заметить, что о критеском состоянии он стал сигнализировать гораздо позже (уже ближе к полному разряду). Итак аккумулятор разряжен.&lt;/p&gt;
&lt;h2 style="text-align: justify;"&gt;Момент 5. Отправка в продакшн&lt;/h2&gt;
&lt;p style="text-align: justify;"&gt;Перед отправкой в продакшн нужно снова полностью зарядить батарею. Опять часов 12, не меньше. По завершении выключаем его, потом вынимаем с розетки. Ну а далее доставляем его на поле боя, подключаем в включаем. Всё, можно наслаждаться.&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;&amp;nbsp;&lt;/p&gt;
&lt;p style="text-align: justify;"&gt;Согласно таким рекомендациям была заменена батарея в ИБИ APC BK500-RS, отлично рабоает, держит нагрузку порядка 150 Ватт на протяжении 45 минут, при этом батарея у нас 12 В, емекость 9 Ампер-часов.&lt;/p&gt;]]></fulltext>
<state>1</state>
<created><![CDATA[2013-02-21 13:04:53]]></created>
<created_by_alias></created_by_alias>
<modified><![CDATA[2013-02-25 09:56:13]]></modified>
<publish_up><![CDATA[2013-02-21 13:33:50]]></publish_up>
<publish_down><![CDATA[0000-00-00 00:00:00]]></publish_down>
<images><![CDATA[{"image_intro":"","float_intro":"","image_intro_alt":"","image_intro_caption":"","image_fulltext":"","float_fulltext":"","image_fulltext_alt":"","image_fulltext_caption":""}]]></images>
<urls><![CDATA[{"urla":null,"urlatext":"","targeta":"","urlb":null,"urlbtext":"","targetb":"","urlc":null,"urlctext":"","targetc":""}]]></urls>
<attribs><![CDATA[{"show_title":"","link_titles":"","show_intro":"","show_category":"","link_category":"","show_parent_category":"","link_parent_category":"","show_author":"","link_author":"","show_create_date":"","show_modify_date":"","show_publish_date":"","show_item_navigation":"","show_icons":"","show_print_icon":"","show_email_icon":"","show_vote":"","show_hits":"","show_noauth":"","urls_position":"","alternative_readmore":"","article_layout":"","show_publishing_options":"","show_article_options":"","show_urls_images_backend":"","show_urls_images_frontend":""}]]></attribs>
<version>8</version>
<ordering>0</ordering>
<metakey></metakey>
<metadesc></metadesc>
<access>1</access>
<hits>567</hits>
<metadata><![CDATA[{"robots":"","author":"","rights":"","xreference":""}]]></metadata>
<language><![CDATA[*]]></language>
<xreference></xreference>
<catid><![CDATA[notes/hardware]]></catid>
<created_by><![CDATA[root]]></created_by>
<modified_by><![CDATA[root]]></modified_by>
<featured>0</featured>
<rating_sum>0</rating_sum>
<rating_count>0</rating_count>
</content></j2xml>